(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,15005,76950,44895,46018,52626,16203,16763,97556,t=>{"use strict";let e;var i=t.i(47760),r=t.i(40069),s=t.i(69553),a=t.i(32677);let n=new s.Bounds;function o(t,e,i){t.measurable=!0,(0,a.getGlobalBounds)(t,i,n),e.addBoundsMask(n),t.measurable=!1}t.s(["addMaskBounds",()=>o],76950);var l=t.i(92405),h=t.i(15111),u=t.i(85830);function d(t,e,i){let r=h.boundsPool.get();t.measurable=!0;let s=h.matrixPool.get().identity(),a=function t(e,i,r){return e?e!==i&&(t(e.parent,i,r),e.updateLocalTransform(),r.append(e.localTransform)):(0,u.warn)("Mask bounds, renderable is not inside the root container"),r}(t,i,s);(0,l.getLocalBounds)(t,r,a),t.measurable=!1,e.addBoundsMask(r),h.matrixPool.return(s),h.boundsPool.return(r)}t.s(["addMaskLocalBounds",()=>d],44895);class c{constructor(t){this.priority=0,this.inverse=!1,this.pipe="alphaMask",t?.mask&&this.init(t.mask)}init(t){this.mask=t,this.renderMaskToTexture=!(t instanceof r.Sprite),this.mask.renderable=this.renderMaskToTexture,this.mask.includeInBuild=!this.renderMaskToTexture,this.mask.measurable=!1}reset(){null!==this.mask&&(this.mask.measurable=!0,this.mask=null)}addBounds(t,e){this.inverse||o(this.mask,t,e)}addLocalBounds(t,e){d(this.mask,t,e)}containsPoint(t,e){return e(this.mask,t)}destroy(){this.reset()}static test(t){return t instanceof r.Sprite}}c.extension=i.ExtensionType.MaskEffect,t.s(["AlphaMask",()=>c],15005);class p{constructor(t){this.priority=0,this.pipe="colorMask",t?.mask&&this.init(t.mask)}init(t){this.mask=t}destroy(){}static test(t){return"number"==typeof t}}p.extension=i.ExtensionType.MaskEffect,t.s(["ColorMask",()=>p],46018);var f=t.i(50147);class x{constructor(t){this.priority=0,this.pipe="stencilMask",t?.mask&&this.init(t.mask)}init(t){this.mask=t,this.mask.includeInBuild=!1,this.mask.measurable=!1}reset(){null!==this.mask&&(this.mask.measurable=!0,this.mask.includeInBuild=!0,this.mask=null)}addBounds(t,e){o(this.mask,t,e)}addLocalBounds(t,e){d(this.mask,t,e)}containsPoint(t,e){return e(this.mask,t)}destroy(){this.reset()}static test(t){return t instanceof f.Container}}x.extension=i.ExtensionType.MaskEffect,t.s(["StencilMask",()=>x],52626);var g=t.i(95627);class m extends g.TextureSource{constructor(t){super(t),this.uploadMethodId="image",this.autoGarbageCollect=!0}static test(t){return globalThis.HTMLImageElement&&t instanceof HTMLImageElement||"undefined"!=typeof ImageBitmap&&t instanceof ImageBitmap||globalThis.VideoFrame&&t instanceof VideoFrame}}m.extension=i.ExtensionType.TextureSource,t.s(["ImageSource",()=>m],16203);var _=t.i(6972),y=t.i(27402);async function v(){return e??(e=(async()=>{let t=y.DOMAdapter.get().createCanvas(1,1).getContext("webgl");if(!t)return"premultiply-alpha-on-upload";let e=await new Promise(t=>{let e=document.createElement("video");e.onloadeddata=()=>t(e),e.onerror=()=>t(null),e.autoplay=!1,e.crossOrigin="anonymous",e.preload="auto",e.src="data:video/webm;base64,GkXfo59ChoEBQveBAULygQRC84EIQoKEd2VibUKHgQJChYECGFOAZwEAAAAAAAHTEU2bdLpNu4tTq4QVSalmU6yBoU27i1OrhBZUrmtTrIHGTbuMU6uEElTDZ1OsggEXTbuMU6uEHFO7a1OsggG97AEAAAAAAABZAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAVSalmoCrXsYMPQkBNgIRMYXZmV0GETGF2ZkSJiEBEAAAAAAAAFlSua8yuAQAAAAAAAEPXgQFzxYgAAAAAAAAAAZyBACK1nIN1bmSIgQCGhVZfVlA5g4EBI+ODhAJiWgDglLCBArqBApqBAlPAgQFVsIRVuYEBElTDZ9Vzc9JjwItjxYgAAAAAAAAAAWfInEWjh0VOQ09ERVJEh49MYXZjIGxpYnZweC12cDlnyKJFo4hEVVJBVElPTkSHlDAwOjAwOjAwLjA0MDAwMDAwMAAAH0O2dcfngQCgwqGggQAAAIJJg0IAABAAFgA4JBwYSgAAICAAEb///4r+AAB1oZ2mm+6BAaWWgkmDQgAAEAAWADgkHBhKAAAgIABIQBxTu2uRu4+zgQC3iveBAfGCAXHwgQM=",e.load()});if(!e)return"premultiply-alpha-on-upload";let i=t.createTexture();t.bindTexture(t.TEXTURE_2D,i);let r=t.createFramebuffer();t.bindFramebuffer(t.FRAMEBUFFER,r),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,i,0),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,t.NONE),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e);let s=new Uint8Array(4);return t.readPixels(0,0,1,1,t.RGBA,t.UNSIGNED_BYTE,s),t.deleteFramebuffer(r),t.deleteTexture(i),t.getExtension("WEBGL_lose_context")?.loseContext(),s[0]<=s[3]?"premultiplied-alpha":"premultiply-alpha-on-upload"})()),e}t.s(["detectVideoAlphaMode",()=>v],16763);var b=g;let T=class t extends b.TextureSource{constructor(e){super(e),this.isReady=!1,this.uploadMethodId="video",e={...t.defaultOptions,...e},this._autoUpdate=!0,this._isConnectedToTicker=!1,this._updateFPS=e.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=!1!==e.autoPlay,this.alphaMode=e.alphaMode??"premultiply-alpha-on-upload",this._videoFrameRequestCallback=this._videoFrameRequestCallback.bind(this),this._videoFrameRequestCallbackHandle=null,this._load=null,this._resolve=null,this._reject=null,this._onCanPlay=this._onCanPlay.bind(this),this._onCanPlayThrough=this._onCanPlayThrough.bind(this),this._onError=this._onError.bind(this),this._onPlayStart=this._onPlayStart.bind(this),this._onPlayStop=this._onPlayStop.bind(this),this._onSeeked=this._onSeeked.bind(this),!1!==e.autoLoad&&this.load()}updateFrame(){if(!this.destroyed){if(this._updateFPS){let t=_.Ticker.shared.elapsedMS*this.resource.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-t)}(!this._updateFPS||this._msToNextUpdate<=0)&&(this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0),this.isValid&&this.update()}}_videoFrameRequestCallback(){this.updateFrame(),this.destroyed?this._videoFrameRequestCallbackHandle=null:this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback)}get isValid(){return!!this.resource.videoWidth&&!!this.resource.videoHeight}async load(){if(this._load)return this._load;let t=this.resource,e=this.options;return(t.readyState===t.HAVE_ENOUGH_DATA||t.readyState===t.HAVE_FUTURE_DATA)&&t.width&&t.height&&(t.complete=!0),t.addEventListener("play",this._onPlayStart),t.addEventListener("pause",this._onPlayStop),t.addEventListener("seeked",this._onSeeked),this._isSourceReady()?this._mediaReady():(e.preload||t.addEventListener("canplay",this._onCanPlay),t.addEventListener("canplaythrough",this._onCanPlayThrough),t.addEventListener("error",this._onError,!0)),this.alphaMode=await v(),this._load=new Promise((i,r)=>{this.isValid?i(this):(this._resolve=i,this._reject=r,void 0!==e.preloadTimeoutMs&&(this._preloadTimeout=setTimeout(()=>{this._onError(new ErrorEvent(`Preload exceeded timeout of ${e.preloadTimeoutMs}ms`))})),t.load())}),this._load}_onError(t){this.resource.removeEventListener("error",this._onError,!0),this.emit("error",t),this._reject&&(this._reject(t),this._reject=null,this._resolve=null)}_isSourcePlaying(){let t=this.resource;return!t.paused&&!t.ended}_isSourceReady(){return this.resource.readyState>2}_onPlayStart(){this.isValid||this._mediaReady(),this._configureAutoUpdate()}_onPlayStop(){this._configureAutoUpdate()}_onSeeked(){this._autoUpdate&&!this._isSourcePlaying()&&(this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0)}_onCanPlay(){this.resource.removeEventListener("canplay",this._onCanPlay),this._mediaReady()}_onCanPlayThrough(){this.resource.removeEventListener("canplaythrough",this._onCanPlay),this._preloadTimeout&&(clearTimeout(this._preloadTimeout),this._preloadTimeout=void 0),this._mediaReady()}_mediaReady(){let t=this.resource;this.isValid&&(this.isReady=!0,this.resize(t.videoWidth,t.videoHeight)),this._msToNextUpdate=0,this.updateFrame(),this._msToNextUpdate=0,this._resolve&&(this._resolve(this),this._resolve=null,this._reject=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&this.resource.play()}destroy(){this._configureAutoUpdate();let t=this.resource;t&&(t.removeEventListener("play",this._onPlayStart),t.removeEventListener("pause",this._onPlayStop),t.removeEventListener("seeked",this._onSeeked),t.removeEventListener("canplay",this._onCanPlay),t.removeEventListener("canplaythrough",this._onCanPlayThrough),t.removeEventListener("error",this._onError,!0),t.pause(),t.src="",t.load()),super.destroy()}get autoUpdate(){return this._autoUpdate}set autoUpdate(t){t!==this._autoUpdate&&(this._autoUpdate=t,this._configureAutoUpdate())}get updateFPS(){return this._updateFPS}set updateFPS(t){t!==this._updateFPS&&(this._updateFPS=t,this._configureAutoUpdate())}_configureAutoUpdate(){this._autoUpdate&&this._isSourcePlaying()?!this._updateFPS&&this.resource.requestVideoFrameCallback?(this._isConnectedToTicker&&(_.Ticker.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0),null===this._videoFrameRequestCallbackHandle&&(this._videoFrameRequestCallbackHandle=this.resource.requestVideoFrameCallback(this._videoFrameRequestCallback))):(null!==this._videoFrameRequestCallbackHandle&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker||(_.Ticker.shared.add(this.updateFrame,this),this._isConnectedToTicker=!0,this._msToNextUpdate=0)):(null!==this._videoFrameRequestCallbackHandle&&(this.resource.cancelVideoFrameCallback(this._videoFrameRequestCallbackHandle),this._videoFrameRequestCallbackHandle=null),this._isConnectedToTicker&&(_.Ticker.shared.remove(this.updateFrame,this),this._isConnectedToTicker=!1,this._msToNextUpdate=0))}static test(t){return globalThis.HTMLVideoElement&&t instanceof HTMLVideoElement}};T.extension=i.ExtensionType.TextureSource,T.defaultOptions={...b.TextureSource.defaultOptions,autoLoad:!0,autoPlay:!0,updateFPS:0,crossorigin:!0,loop:!1,muted:!0,playsinline:!0,preload:!1},T.MIME_TYPES={ogv:"video/ogg",mov:"video/quicktime",m4v:"video/mp4"},t.s(["VideoSource",()=>T],97556)},89698,t=>{"use strict";let e=(t,e,i=!1)=>(Array.isArray(t)||(t=[t]),e)?t.map(t=>"string"==typeof t||i?e(t):t):t;t.s(["convertToList",()=>e])},10463,92206,58035,t=>{"use strict";var e=t.i(47760),i=t.i(15005),r=t.i(46018),s=t.i(52626),a=t.i(75324),n=t.i(70220),o=t.i(16203),l=t.i(97556),h=t.i(85830),u=t.i(89698);let d=new class{constructor(){this._parsers=[],this._cache=new Map,this._cacheMap=new Map}reset(){this._cacheMap.clear(),this._cache.clear()}has(t){return this._cache.has(t)}get(t){let e=this._cache.get(t);return e||(0,h.warn)(`[Assets] Asset id ${t} was not found in the Cache`),e}set(t,e){let i,r=(0,u.convertToList)(t);for(let t=0;t<this.parsers.length;t++){let s=this.parsers[t];if(s.test(e)){i=s.getCacheableAssets(r,e);break}}let s=new Map(Object.entries(i||{}));i||r.forEach(t=>{s.set(t,e)});let a=[...s.keys()],n={cacheKeys:a,keys:r};r.forEach(t=>{this._cacheMap.set(t,n)}),a.forEach(t=>{let r=i?i[t]:e;this._cache.has(t)&&this._cache.get(t)!==r&&(0,h.warn)("[Cache] already has key:",t),this._cache.set(t,s.get(t))})}remove(t){if(!this._cacheMap.has(t))return void(0,h.warn)(`[Assets] Asset id ${t} was not found in the Cache`);let e=this._cacheMap.get(t);e.cacheKeys.forEach(t=>{this._cache.delete(t)}),e.keys.forEach(t=>{this._cacheMap.delete(t)})}get parsers(){return this._parsers}};t.s(["Cache",()=>d],92206);var c=t.i(95627),p=t.i(31320);let f=[];function x(t={}){return g(t)}function g(t={}){let e=t&&t.resource,i=e?t.resource:t,r=e?t:{resource:t};for(let t=0;t<f.length;t++){let e=f[t];if(e.test(i))return new e(r)}throw Error(`Could not find a source type for resource: ${r.resource}`)}function m(t={},e=!1){let i=t&&t.resource,r=i?t.resource:t,s=i?t:{resource:t};if(!e&&d.has(r))return d.get(r);let a=new p.Texture({source:g(s)});return a.on("destroy",()=>{d.has(r)&&d.remove(r)}),e||d.set(r,a),a}function _(t,e=!1){return"string"==typeof t?d.get(t):t instanceof c.TextureSource?new p.Texture({source:t}):m(t,e)}e.extensions.handleByList(e.ExtensionType.TextureSource,f),p.Texture.from=_,c.TextureSource.from=g,t.s(["autoDetectSource",()=>x,"resourceToTexture",()=>m,"textureFrom",()=>_],58035),e.extensions.add(i.AlphaMask,r.ColorMask,s.StencilMask,l.VideoSource,o.ImageSource,n.CanvasSource,a.BufferImageSource),t.s([],10463)},81324,30774,t=>{"use strict";var e,i=((e=i||{})[e.Low=0]="Low",e[e.Normal=1]="Normal",e[e.High=2]="High",e);t.s(["LoaderParserPriority",()=>i],81324);var r=t.i(27402);function s(t){if("string"!=typeof t)throw TypeError(`Path must be a string. Received ${JSON.stringify(t)}`)}function a(t){return t.split("?")[0].split("#")[0]}let n={toPosix:t=>{var e,i;return e=0,i=0,t.replace(RegExp("\\".replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),"g"),"/")},isUrl(t){return/^https?:/.test(this.toPosix(t))},isDataUrl:t=>/^data:([a-z]+\/[a-z0-9-+.]+(;[a-z0-9-.!#$%*+.{}|~`]+=[a-z0-9-.!#$%*+.{}()_|~`]+)*)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s<>]*?)$/i.test(t),isBlobUrl:t=>t.startsWith("blob:"),hasProtocol(t){return/^[^/:]+:/.test(this.toPosix(t))},getProtocol(t){s(t),t=this.toPosix(t);let e=/^file:\/\/\//.exec(t);if(e)return e[0];let i=/^[^/:]+:\/{0,2}/.exec(t);return i?i[0]:""},toAbsolute(t,e,i){if(s(t),this.isDataUrl(t)||this.isBlobUrl(t))return t;let o=a(this.toPosix(e??r.DOMAdapter.get().getBaseUrl())),l=a(this.toPosix(i??this.rootname(o)));return(t=this.toPosix(t)).startsWith("/")?n.join(l,t.slice(1)):this.isAbsolute(t)?t:this.join(o,t)},normalize(t){if(s(t),0===t.length)return".";if(this.isDataUrl(t)||this.isBlobUrl(t))return t;t=this.toPosix(t);let e="",i=t.startsWith("/");this.hasProtocol(t)&&(e=this.rootname(t),t=t.slice(e.length));let r=t.endsWith("/");return((t=function(t,e){let i="",r=0,s=-1,a=0,n=-1;for(let o=0;o<=t.length;++o){if(o<t.length)n=t.charCodeAt(o);else if(47===n)break;else n=47;if(47===n){if(s===o-1||1===a);else if(s!==o-1&&2===a){if(i.length<2||2!==r||46!==i.charCodeAt(i.length-1)||46!==i.charCodeAt(i.length-2)){if(i.length>2){let t=i.lastIndexOf("/");if(t!==i.length-1){-1===t?(i="",r=0):r=(i=i.slice(0,t)).length-1-i.lastIndexOf("/"),s=o,a=0;continue}}else if(2===i.length||1===i.length){i="",r=0,s=o,a=0;continue}}e&&(i.length>0?i+="/..":i="..",r=2)}else i.length>0?i+=`/${t.slice(s+1,o)}`:i=t.slice(s+1,o),r=o-s-1;s=o,a=0}else 46===n&&-1!==a?++a:a=-1}return i}(t,!1)).length>0&&r&&(t+="/"),i)?`/${t}`:e+t},isAbsolute(t){return s(t),t=this.toPosix(t),!!this.hasProtocol(t)||t.startsWith("/")},join(...t){let e;if(0===t.length)return".";for(let i=0;i<t.length;++i){let r=t[i];if(s(r),r.length>0)if(void 0===e)e=r;else{let s=t[i-1]??"";this.joinExtensions.includes(this.extname(s).toLowerCase())?e+=`/../${r}`:e+=`/${r}`}}return void 0===e?".":this.normalize(e)},dirname(t){if(s(t),0===t.length)return".";let e=(t=this.toPosix(t)).charCodeAt(0),i=47===e,r=-1,a=!0,n=this.getProtocol(t),o=t;t=t.slice(n.length);for(let i=t.length-1;i>=1;--i)if(47===(e=t.charCodeAt(i))){if(!a){r=i;break}}else a=!1;return -1===r?i?"/":this.isUrl(o)?n+t:n:i&&1===r?"//":n+t.slice(0,r)},rootname(t){s(t);let e="";if(e=(t=this.toPosix(t)).startsWith("/")?"/":this.getProtocol(t),this.isUrl(t)){let i=t.indexOf("/",e.length);(e=-1!==i?t.slice(0,i):t).endsWith("/")||(e+="/")}return e},basename(t,e){let i;s(t),e&&s(e),t=a(this.toPosix(t));let r=0,n=-1,o=!0;if(void 0!==e&&e.length>0&&e.length<=t.length){if(e.length===t.length&&e===t)return"";let s=e.length-1,a=-1;for(i=t.length-1;i>=0;--i){let l=t.charCodeAt(i);if(47===l){if(!o){r=i+1;break}}else -1===a&&(o=!1,a=i+1),s>=0&&(l===e.charCodeAt(s)?-1==--s&&(n=i):(s=-1,n=a))}return r===n?n=a:-1===n&&(n=t.length),t.slice(r,n)}for(i=t.length-1;i>=0;--i)if(47===t.charCodeAt(i)){if(!o){r=i+1;break}}else -1===n&&(o=!1,n=i+1);return -1===n?"":t.slice(r,n)},extname(t){s(t),t=a(this.toPosix(t));let e=-1,i=0,r=-1,n=!0,o=0;for(let s=t.length-1;s>=0;--s){let a=t.charCodeAt(s);if(47===a){if(!n){i=s+1;break}continue}-1===r&&(n=!1,r=s+1),46===a?-1===e?e=s:1!==o&&(o=1):-1!==e&&(o=-1)}return -1===e||-1===r||0===o||1===o&&e===r-1&&e===i+1?"":t.slice(e,r)},parse(t){let e;s(t);let i={root:"",dir:"",base:"",ext:"",name:""};if(0===t.length)return i;let r=(t=a(this.toPosix(t))).charCodeAt(0),n=this.isAbsolute(t);i.root=this.rootname(t),e=n||this.hasProtocol(t)?1:0;let o=-1,l=0,h=-1,u=!0,d=t.length-1,c=0;for(;d>=e;--d){if(47===(r=t.charCodeAt(d))){if(!u){l=d+1;break}continue}-1===h&&(u=!1,h=d+1),46===r?-1===o?o=d:1!==c&&(c=1):-1!==o&&(c=-1)}return -1===o||-1===h||0===c||1===c&&o===h-1&&o===l+1?-1!==h&&(0===l&&n?i.base=i.name=t.slice(1,h):i.base=i.name=t.slice(l,h)):(0===l&&n?(i.name=t.slice(1,o),i.base=t.slice(1,h)):(i.name=t.slice(l,o),i.base=t.slice(l,h)),i.ext=t.slice(o,h)),i.dir=this.dirname(t),i},sep:"/",delimiter:":",joinExtensions:[".html"]};t.s(["path",()=>n],30774)},99650,12713,24103,39260,72116,91018,73051,t=>{"use strict";var e=t.i(47760),i=t.i(81324),r=t.i(85830),s=t.i(30774),a=t.i(89698);function n(t){let e=t.match(/\{(.*?)\}/g),i=[];if(e){let r=[];e.forEach(t=>{let e=t.substring(1,t.length-1).split(",");r.push(e)}),function t(e,i,r,s,a){let n=i[r];for(let o=0;o<n.length;o++){let l=n[o];r<i.length-1?t(e.replace(s[r],l),i,r+1,s,a):a.push(e.replace(s[r],l))}}(t,r,0,e,i)}else i.push(t);return i}t.s(["createStringVariations",()=>n],12713);let o=t=>!Array.isArray(t);t.s(["isSingleItem",()=>o],24103);class l{constructor(){this._defaultBundleIdentifierOptions={connector:"-",createBundleAssetId:(t,e)=>`${t}${this._bundleIdConnector}${e}`,extractAssetIdFromBundle:(t,e)=>e.replace(`${t}${this._bundleIdConnector}`,"")},this._bundleIdConnector=this._defaultBundleIdentifierOptions.connector,this._createBundleAssetId=this._defaultBundleIdentifierOptions.createBundleAssetId,this._extractAssetIdFromBundle=this._defaultBundleIdentifierOptions.extractAssetIdFromBundle,this._assetMap={},this._preferredOrder=[],this._parsers=[],this._resolverHash={},this._bundles={}}setBundleIdentifier(t){if(this._bundleIdConnector=t.connector??this._bundleIdConnector,this._createBundleAssetId=t.createBundleAssetId??this._createBundleAssetId,this._extractAssetIdFromBundle=t.extractAssetIdFromBundle??this._extractAssetIdFromBundle,"bar"!==this._extractAssetIdFromBundle("foo",this._createBundleAssetId("foo","bar")))throw Error("[Resolver] GenerateBundleAssetId are not working correctly")}prefer(...t){t.forEach(t=>{this._preferredOrder.push(t),t.priority||(t.priority=Object.keys(t.params))}),this._resolverHash={}}set basePath(t){this._basePath=t}get basePath(){return this._basePath}set rootPath(t){this._rootPath=t}get rootPath(){return this._rootPath}get parsers(){return this._parsers}reset(){this.setBundleIdentifier(this._defaultBundleIdentifierOptions),this._assetMap={},this._preferredOrder=[],this._resolverHash={},this._rootPath=null,this._basePath=null,this._manifest=null,this._bundles={},this._defaultSearchParams=null}setDefaultSearchParams(t){"string"==typeof t?this._defaultSearchParams=t:this._defaultSearchParams=Object.keys(t).map(e=>`${encodeURIComponent(e)}=${encodeURIComponent(t[e])}`).join("&")}getAlias(t){let{alias:e,src:i}=t;return(0,a.convertToList)(e||i,t=>"string"==typeof t?t:Array.isArray(t)?t.map(t=>t?.src??t):t?.src?t.src:t,!0)}addManifest(t){this._manifest&&(0,r.warn)("[Resolver] Manifest already exists, this will be overwritten"),this._manifest=t,t.bundles.forEach(t=>{this.addBundle(t.name,t.assets)})}addBundle(t,e){let i=[],r=e;Array.isArray(e)||(r=Object.entries(e).map(([t,e])=>"string"==typeof e||Array.isArray(e)?{alias:t,src:e}:{alias:t,...e})),r.forEach(e=>{let r,s=e.src,a=e.alias;if("string"==typeof a){let e=this._createBundleAssetId(t,a);i.push(e),r=[a,e]}else{let e=a.map(e=>this._createBundleAssetId(t,e));i.push(...e),r=[...a,...e]}this.add({...e,alias:r,src:s})}),this._bundles[t]=i}add(t){let e,i=[];Array.isArray(t)?i.push(...t):i.push(t),e=t=>{this.hasKey(t)&&(0,r.warn)(`[Resolver] already has key: ${t} overwriting`)},(0,a.convertToList)(i).forEach(t=>{let{src:i}=t,{data:r,format:s,loadParser:o,parser:l}=t,h=(0,a.convertToList)(i).map(t=>"string"==typeof t?n(t):Array.isArray(t)?t:[t]),u=this.getAlias(t);Array.isArray(u)?u.forEach(e):e(u);let d=[],c=t=>{let e=this._parsers.find(e=>e.test(t));return{...e?.parse(t),src:t}};h.forEach(e=>{e.forEach(e=>{let i={};if("object"!=typeof e?i=c(e):(r=e.data??r,s=e.format??s,(e.loadParser||e.parser)&&(o=e.loadParser??o,l=e.parser??l),i={...c(e.src),...e}),!u)throw Error(`[Resolver] alias is undefined for this asset: ${i.src}`);i=this._buildResolvedAsset(i,{aliases:u,data:r,format:s,loadParser:o,parser:l,progressSize:t.progressSize}),d.push(i)})}),u.forEach(t=>{this._assetMap[t]=d})})}resolveBundle(t){let e=o(t);t=(0,a.convertToList)(t);let i={};return t.forEach(t=>{let e=this._bundles[t];if(e){let r=this.resolve(e),s={};for(let e in r){let i=r[e];s[this._extractAssetIdFromBundle(t,e)]=i}i[t]=s}}),e?i[t[0]]:i}resolveUrl(t){let e=this.resolve(t);if("string"!=typeof t){let t={};for(let i in e)t[i]=e[i].src;return t}return e.src}resolve(t){let e=o(t);t=(0,a.convertToList)(t);let i={};return t.forEach(t=>{if(!this._resolverHash[t])if(this._assetMap[t]){let e=this._assetMap[t],i=this._getPreferredOrder(e);i?.priority.forEach(t=>{i.params[t].forEach(i=>{let r=e.filter(e=>!!e[t]&&e[t]===i);r.length&&(e=r)})}),this._resolverHash[t]=e[0]}else this._resolverHash[t]=this._buildResolvedAsset({alias:[t],src:t},{});i[t]=this._resolverHash[t]}),e?i[t[0]]:i}hasKey(t){return!!this._assetMap[t]}hasBundle(t){return!!this._bundles[t]}_getPreferredOrder(t){for(let e=0;e<t.length;e++){let i=t[e],r=this._preferredOrder.find(t=>t.params.format.includes(i.format));if(r)return r}return this._preferredOrder[0]}_appendDefaultSearchParams(t){if(!this._defaultSearchParams)return t;let e=/\?/.test(t)?"&":"?";return`${t}${e}${this._defaultSearchParams}`}_buildResolvedAsset(t,e){let{aliases:i,data:r,loadParser:a,parser:n,format:o,progressSize:l}=e;return(this._basePath||this._rootPath)&&(t.src=s.path.toAbsolute(t.src,this._basePath,this._rootPath)),t.alias=i??t.alias??[t.src],t.src=this._appendDefaultSearchParams(t.src),t.data={...r||{},...t.data},t.loadParser=a??t.loadParser,t.parser=n??t.parser,t.format=o??t.format??h(t.src),void 0!==l&&(t.progressSize=l),t}}function h(t){return t.split(".").pop().split("?").shift().split("#").shift()}l.RETINA_PREFIX=/@([0-9\.]+)x/,t.s(["Resolver",()=>l,"getUrlExtension",()=>h],39260);let u=(t,e)=>{let i=e.split("?")[1];return i&&(t+=`?${i}`),t};t.s(["copySearchParams",()=>u],72116);var d=t.i(31320),c=t.i(63646),p=t.i(95627);let f=class t{constructor(t,e){this.linkedSheets=[];let i=t;t?.source instanceof p.TextureSource&&(i={texture:t,data:e});const{texture:r,data:s,cachePrefix:a=""}=i;this.cachePrefix=a,this._texture=r instanceof d.Texture?r:null,this.textureSource=r.source,this.textures={},this.animations={},this.data=s;const n=parseFloat(s.meta.scale);n?(this.resolution=n,r.source.resolution=this.resolution):this.resolution=r.source._resolution,this._frames=this.data.frames,this._frameKeys=Object.keys(this._frames),this._batchIndex=0,this._callback=null}parse(){return new Promise(e=>{this._callback=e,this._batchIndex=0,this._frameKeys.length<=t.BATCH_SIZE?(this._processFrames(0),this._processAnimations(),this._parseComplete()):this._nextBatch()})}_processFrames(e){let i=e,r=t.BATCH_SIZE;for(;i-e<r&&i<this._frameKeys.length;){let t=this._frameKeys[i],e=this._frames[t],r=e.frame;if(r){let i=null,s=null,a=!1!==e.trimmed&&e.sourceSize?e.sourceSize:e.frame,n=new c.Rectangle(0,0,Math.floor(a.w)/this.resolution,Math.floor(a.h)/this.resolution);i=e.rotated?new c.Rectangle(Math.floor(r.x)/this.resolution,Math.floor(r.y)/this.resolution,Math.floor(r.h)/this.resolution,Math.floor(r.w)/this.resolution):new c.Rectangle(Math.floor(r.x)/this.resolution,Math.floor(r.y)/this.resolution,Math.floor(r.w)/this.resolution,Math.floor(r.h)/this.resolution),!1!==e.trimmed&&e.spriteSourceSize&&(s=new c.Rectangle(Math.floor(e.spriteSourceSize.x)/this.resolution,Math.floor(e.spriteSourceSize.y)/this.resolution,Math.floor(r.w)/this.resolution,Math.floor(r.h)/this.resolution)),this.textures[t]=new d.Texture({source:this.textureSource,frame:i,orig:n,trim:s,rotate:2*!!e.rotated,defaultAnchor:e.anchor,defaultBorders:e.borders,label:t.toString()})}i++}}_processAnimations(){let t=this.data.animations||{};for(let e in t){this.animations[e]=[];for(let i=0;i<t[e].length;i++){let r=t[e][i];this.animations[e].push(this.textures[r])}}}_parseComplete(){let t=this._callback;this._callback=null,this._batchIndex=0,t.call(this,this.textures)}_nextBatch(){this._processFrames(this._batchIndex*t.BATCH_SIZE),this._batchIndex++,setTimeout(()=>{this._batchIndex*t.BATCH_SIZE<this._frameKeys.length?this._nextBatch():(this._processAnimations(),this._parseComplete())},0)}destroy(t=!1){for(let t in this.textures)this.textures[t].destroy();this._frames=null,this._frameKeys=null,this.data=null,this.textures=null,t&&(this._texture?.destroy(),this.textureSource.destroy()),this._texture=null,this.textureSource=null,this.linkedSheets=[]}};f.BATCH_SIZE=1e3,t.s(["Spritesheet",()=>f],91018);let x=["jpg","png","jpeg","avif","webp","basis","etc2","bc7","bc6h","bc5","bc4","bc3","bc2","bc1","eac","astc"],g={extension:e.ExtensionType.Asset,cache:{test:t=>t instanceof f,getCacheableAssets:(t,e)=>(function t(e,i,r){let a={};if(e.forEach(t=>{a[t]=i}),Object.keys(i.textures).forEach(t=>{a[`${i.cachePrefix}${t}`]=i.textures[t]}),!r){let r=s.path.dirname(e[0]);i.linkedSheets.forEach((e,s)=>{Object.assign(a,t([`${r}/${i.data.meta.related_multi_packs[s]}`],e,!0))})}return a})(t,e,!1)},resolver:{extension:{type:e.ExtensionType.ResolveParser,name:"resolveSpritesheet"},test:t=>{let e=t.split("?")[0].split("."),i=e.pop(),r=e.pop();return"json"===i&&x.includes(r)},parse:t=>{let e=t.split(".");return{resolution:parseFloat(l.RETINA_PREFIX.exec(t)?.[1]??"1"),format:e[e.length-2],src:t}}},loader:{name:"spritesheetLoader",id:"spritesheet",extension:{type:e.ExtensionType.LoadParser,priority:i.LoaderParserPriority.Normal,name:"spritesheetLoader"},testParse:async(t,e)=>".json"===s.path.extname(e.src).toLowerCase()&&!!t.frames,async parse(t,e,i){let r,{texture:a,imageFilename:n,textureOptions:o,cachePrefix:l}=e?.data??{},h=s.path.dirname(e.src);if(h&&h.lastIndexOf("/")!==h.length-1&&(h+="/"),a instanceof d.Texture)r=a;else{let s=u(h+(n??t.meta.image),e.src);r=(await i.load([{src:s,data:o}]))[s]}let c=new f({texture:r.source,data:t,cachePrefix:l});await c.parse();let p=t?.meta?.related_multi_packs;if(Array.isArray(p)){let t=[];for(let r of p){if("string"!=typeof r)continue;let s=h+r;e.data?.ignoreMultiPack||(s=u(s,e.src),t.push(i.load({src:s,data:{textureOptions:o,ignoreMultiPack:!0}})))}let r=await Promise.all(t);c.linkedSheets=r,r.forEach(t=>{t.linkedSheets=[c].concat(c.linkedSheets.filter(e=>e!==t))})}return c},async unload(t,e,i){await i.unload(t.textureSource._sourceOrigin),t.destroy(!1)}}};t.s(["spritesheetAsset",()=>g],73051),e.extensions.add(g),t.s([],99650)},31504,84997,t=>{"use strict";var e=t.i(47760);class i{static init(t){Object.defineProperty(this,"resizeTo",{configurable:!0,set(t){globalThis.removeEventListener("resize",this.queueResize),this._resizeTo=t,t&&(globalThis.addEventListener("resize",this.queueResize),this.resize())},get(){return this._resizeTo}}),this.queueResize=()=>{this._resizeTo&&(this._cancelResize(),this._resizeId=requestAnimationFrame(()=>this.resize()))},this._cancelResize=()=>{this._resizeId&&(cancelAnimationFrame(this._resizeId),this._resizeId=null)},this.resize=()=>{let t,e;if(this._resizeTo){if(this._cancelResize(),this._resizeTo===globalThis.window)t=globalThis.innerWidth,e=globalThis.innerHeight;else{let{clientWidth:i,clientHeight:r}=this._resizeTo;t=i,e=r}this.renderer.resize(t,e),this.render()}},this._resizeId=null,this._resizeTo=null,this.resizeTo=t.resizeTo||null}static destroy(){globalThis.removeEventListener("resize",this.queueResize),this._cancelResize(),this._cancelResize=null,this.queueResize=null,this.resizeTo=null,this.resize=null}}i.extension=e.ExtensionType.Application,t.s(["ResizePlugin",()=>i],31504);var r=t.i(59750),s=t.i(6972);class a{static init(t){t=Object.assign({autoStart:!0,sharedTicker:!1},t),Object.defineProperty(this,"ticker",{configurable:!0,set(t){this._ticker&&this._ticker.remove(this.render,this),this._ticker=t,t&&t.add(this.render,this,r.UPDATE_PRIORITY.LOW)},get(){return this._ticker}}),this.stop=()=>{this._ticker.stop()},this.start=()=>{this._ticker.start()},this._ticker=null,this.ticker=t.sharedTicker?s.Ticker.shared:new s.Ticker,t.autoStart&&this.start()}static destroy(){if(this._ticker){let t=this._ticker;this.ticker=null,t.destroy()}}}a.extension=e.ExtensionType.Application,t.s(["TickerPlugin",()=>a],84997)},30524,t=>{"use strict";var e=t.i(95932),i=t.i(49864);class r extends e.default{constructor(){super(...arguments),this.chars=Object.create(null),this.lineHeight=0,this.fontFamily="",this.fontMetrics={fontSize:0,ascent:0,descent:0},this.baseLineOffset=0,this.distanceField={type:"none",range:0},this.pages=[],this.applyFillAsTint=!0,this.baseMeasurementFontSize=100,this.baseRenderedFontSize=100}get font(){return(0,i.deprecation)(i.v8_0_0,"BitmapFont.font is deprecated, please use BitmapFont.fontFamily instead."),this.fontFamily}get pageTextures(){return(0,i.deprecation)(i.v8_0_0,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}get size(){return(0,i.deprecation)(i.v8_0_0,"BitmapFont.size is deprecated, please use BitmapFont.fontMetrics.fontSize instead."),this.fontMetrics.fontSize}get distanceFieldRange(){return(0,i.deprecation)(i.v8_0_0,"BitmapFont.distanceFieldRange is deprecated, please use BitmapFont.distanceField.range instead."),this.distanceField.range}get distanceFieldType(){return(0,i.deprecation)(i.v8_0_0,"BitmapFont.distanceFieldType is deprecated, please use BitmapFont.distanceField.type instead."),this.distanceField.type}destroy(t=!1){for(let t in this.emit("destroy",this),this.removeAllListeners(),this.chars)this.chars[t].texture?.destroy();this.chars=null,t&&(this.pages.forEach(t=>t.texture.destroy(!0)),this.pages=null)}}t.s(["AbstractBitmapFont",()=>r])},78266,93005,264,t=>{"use strict";class e{constructor(t=0,e=0,i=!1){this.first=null,this.items=Object.create(null),this.last=null,this.max=t,this.resetTtl=i,this.size=0,this.ttl=e}clear(){return this.first=null,this.items=Object.create(null),this.last=null,this.size=0,this}delete(t){if(this.has(t)){let e=this.items[t];delete this.items[t],this.size--,null!==e.prev&&(e.prev.next=e.next),null!==e.next&&(e.next.prev=e.prev),this.first===e&&(this.first=e.next),this.last===e&&(this.last=e.prev)}return this}entries(t=this.keys()){return t.map(t=>[t,this.get(t)])}evict(t=!1){if(t||this.size>0){let t=this.first;delete this.items[t.key],0==--this.size?(this.first=null,this.last=null):(this.first=t.next,this.first.prev=null)}return this}expiresAt(t){let e;return this.has(t)&&(e=this.items[t].expiry),e}get(t){let e=this.items[t];if(void 0!==e)return this.ttl>0&&e.expiry<=Date.now()?void this.delete(t):(this.moveToEnd(e),e.value)}has(t){return t in this.items}moveToEnd(t){this.last!==t&&(null!==t.prev&&(t.prev.next=t.next),null!==t.next&&(t.next.prev=t.prev),this.first===t&&(this.first=t.next),t.prev=this.last,t.next=null,null!==this.last&&(this.last.next=t),this.last=t,null===this.first&&(this.first=t))}keys(){let t=[],e=this.first;for(;null!==e;)t.push(e.key),e=e.next;return t}setWithEvicted(t,e,i=this.resetTtl){let r=null;if(this.has(t))this.set(t,e,!0,i);else{this.max>0&&this.size===this.max&&(r={...this.first},this.evict(!0));let i=this.items[t]={expiry:this.ttl>0?Date.now()+this.ttl:this.ttl,key:t,prev:this.last,next:null,value:e};1==++this.size?this.first=i:this.last.next=i,this.last=i}return r}set(t,e,i=!1,r=this.resetTtl){let s=this.items[t];return i||void 0!==s?(s.value=e,!1===i&&r&&(s.expiry=this.ttl>0?Date.now()+this.ttl:this.ttl),this.moveToEnd(s)):(this.max>0&&this.size===this.max&&this.evict(!0),s=this.items[t]={expiry:this.ttl>0?Date.now()+this.ttl:this.ttl,key:t,prev:this.last,next:null,value:e},1==++this.size?this.first=s:this.last.next=s,this.last=s),this}values(t=this.keys()){return t.map(t=>this.get(t))}}function i(t=1e3,r=0,s=!1){if(isNaN(t)||t<0)throw TypeError("Invalid max value");if(isNaN(r)||r<0)throw TypeError("Invalid ttl value");if("boolean"!=typeof s)throw TypeError("Invalid resetTtl value");return new e(t,r,s)}t.s(["lru",()=>i],93005);var r=t.i(27402);let s=["serif","sans-serif","monospace","cursive","fantasy","system-ui"];function a(t){let e="number"==typeof t.fontSize?`${t.fontSize}px`:t.fontSize,i=t.fontFamily;Array.isArray(t.fontFamily)||(i=t.fontFamily.split(","));for(let t=i.length-1;t>=0;t--){let e=i[t].trim();/([\"\'])[^\'\"]+\1/.test(e)||s.includes(e)||(e=`"${e}"`),i[t]=e}return`${t.fontStyle} ${t.fontVariant} ${t.fontWeight} ${e} ${i.join(",")}`}t.s(["fontStringFromTextStyle",()=>a],264);let n={willReadFrequently:!0},o=class t{static get experimentalLetterSpacingSupported(){let e=t._experimentalLetterSpacingSupported;if(void 0===e){let i=r.DOMAdapter.get().getCanvasRenderingContext2D().prototype;e=t._experimentalLetterSpacingSupported="letterSpacing"in i||"textLetterSpacing"in i}return e}constructor(t,e,i,r,s,a,n,o,l){this.text=t,this.style=e,this.width=i,this.height=r,this.lines=s,this.lineWidths=a,this.lineHeight=n,this.maxLineWidth=o,this.fontProperties=l}static measureText(e=" ",i,r=t._canvas,s=i.wordWrap){let n=`${e}-${i.styleKey}-wordWrap-${s}`;if(t._measurementCache.has(n))return t._measurementCache.get(n);let o=a(i),l=t.measureFont(o);0===l.fontSize&&(l.fontSize=i.fontSize,l.ascent=i.fontSize);let h=t.__context;h.font=o;let u=(s?t._wordWrap(e,i,r):e).split(/(?:\r\n|\r|\n)/),d=Array(u.length),c=0;for(let e=0;e<u.length;e++){let r=t._measureText(u[e],i.letterSpacing,h);d[e]=r,c=Math.max(c,r)}let p=i._stroke?.width||0,f=c+p;i.dropShadow&&(f+=i.dropShadow.distance);let x=i.lineHeight||l.fontSize,g=Math.max(x,l.fontSize+p)+(u.length-1)*(x+i.leading);i.dropShadow&&(g+=i.dropShadow.distance);let m=new t(e,i,f,g,u,d,x+i.leading,c,l);return t._measurementCache.set(n,m),m}static _measureText(e,i,r){let s=!1;t.experimentalLetterSpacingSupported&&(t.experimentalLetterSpacing?(r.letterSpacing=`${i}px`,r.textLetterSpacing=`${i}px`,s=!0):(r.letterSpacing="0px",r.textLetterSpacing="0px"));let a=r.measureText(e),n=a.width,o=-a.actualBoundingBoxLeft,l=a.actualBoundingBoxRight-o;if(n>0)if(s)n-=i,l-=i;else{let r=(t.graphemeSegmenter(e).length-1)*i;n+=r,l+=r}return Math.max(n,l)}static _wordWrap(e,i,r=t._canvas){let s=r.getContext("2d",n),a=0,o="",l="",h=Object.create(null),{letterSpacing:u,whiteSpace:d}=i,c=t._collapseSpaces(d),p=t._collapseNewlines(d),f=!c,x=i.wordWrapWidth+u,g=t._tokenize(e);for(let e=0;e<g.length;e++){let r=g[e];if(t._isNewline(r)){if(!p){l+=t._addLine(o),f=!c,o="",a=0;continue}r=" "}if(c){let e=t.isBreakingSpace(r),i=t.isBreakingSpace(o[o.length-1]);if(e&&i)continue}let n=t._getFromCache(r,u,h,s);if(n>x)if(""!==o&&(l+=t._addLine(o),o="",a=0),t.canBreakWords(r,i.breakWords)){let e=t.wordWrapSplit(r);for(let n=0;n<e.length;n++){let d=e[n],c=d,p=1;for(;e[n+p];){let s=e[n+p];if(t.canBreakChars(c,s,r,n,i.breakWords))break;d+=s,c=s,p++}n+=p-1;let g=t._getFromCache(d,u,h,s);g+a>x&&(l+=t._addLine(o),f=!1,o="",a=0),o+=d,a+=g}}else{o.length>0&&(l+=t._addLine(o),o="",a=0);let i=e===g.length-1;l+=t._addLine(r,!i),f=!1,o="",a=0}else n+a>x&&(f=!1,l+=t._addLine(o),o="",a=0),(o.length>0||!t.isBreakingSpace(r)||f)&&(o+=r,a+=n)}return l+t._addLine(o,!1)}static _addLine(e,i=!0){return e=t._trimRight(e),e=i?`${e}
`:e}static _getFromCache(e,i,r,s){let a=r[e];return"number"!=typeof a&&(a=t._measureText(e,i,s)+i,r[e]=a),a}static _collapseSpaces(t){return"normal"===t||"pre-line"===t}static _collapseNewlines(t){return"normal"===t}static _trimRight(e){if("string"!=typeof e)return"";for(let i=e.length-1;i>=0;i--){let r=e[i];if(!t.isBreakingSpace(r))break;e=e.slice(0,-1)}return e}static _isNewline(e){return"string"==typeof e&&t._newlines.includes(e.charCodeAt(0))}static isBreakingSpace(e,i){return"string"==typeof e&&t._breakingSpaces.includes(e.charCodeAt(0))}static _tokenize(e){let i=[],r="";if("string"!=typeof e)return i;for(let s=0;s<e.length;s++){let a=e[s],n=e[s+1];if(t.isBreakingSpace(a,n)||t._isNewline(a)){""!==r&&(i.push(r),r=""),"\r"===a&&"\n"===n?(i.push("\r\n"),s++):i.push(a);continue}r+=a}return""!==r&&i.push(r),i}static canBreakWords(t,e){return e}static canBreakChars(t,e,i,r,s){return!0}static wordWrapSplit(e){return t.graphemeSegmenter(e)}static measureFont(e){if(t._fonts[e])return t._fonts[e];let i=t._context;i.font=e;let r=i.measureText(t.METRICS_STRING+t.BASELINE_SYMBOL),s={ascent:r.actualBoundingBoxAscent,descent:r.actualBoundingBoxDescent,fontSize:r.actualBoundingBoxAscent+r.actualBoundingBoxDescent};return t._fonts[e]=s,s}static clearMetrics(e=""){e?delete t._fonts[e]:t._fonts={}}static get _canvas(){if(!t.__canvas){let e;try{let i=new OffscreenCanvas(0,0),s=i.getContext("2d",n);if(s?.measureText)return t.__canvas=i,i;e=r.DOMAdapter.get().createCanvas()}catch(t){e=r.DOMAdapter.get().createCanvas()}e.width=e.height=10,t.__canvas=e}return t.__canvas}static get _context(){return t.__context||(t.__context=t._canvas.getContext("2d",n)),t.__context}};o.METRICS_STRING="|ÉqÅ",o.BASELINE_SYMBOL="M",o.BASELINE_MULTIPLIER=1.4,o.HEIGHT_MULTIPLIER=2,o.graphemeSegmenter=(()=>{if("function"==typeof Intl?.Segmenter){let t=new Intl.Segmenter;return e=>{let i=t.segment(e),r=[],s=0;for(let t of i)r[s++]=t.segment;return r}}return t=>[...t]})(),o.experimentalLetterSpacing=!1,o._fonts={},o._newlines=[10,13],o._breakingSpaces=[9,32,8192,8193,8194,8195,8196,8197,8198,8200,8201,8202,8287,12288],o._measurementCache=i(1e3),t.s(["CanvasTextMetrics",()=>o],78266)},81541,t=>{"use strict";var e=t.i(57471),i=t.i(27402),r=t.i(28959),s=t.i(16203),a=t.i(31320),n=t.i(24314),o=t.i(49864),l=t.i(40373);let h=[{offset:0,color:"white"},{offset:1,color:"black"}],u=class t{constructor(...e){this.uid=(0,n.uid)("fillGradient"),this._tick=0,this.type="linear",this.colorStops=[];let i=function(t){let e=t[0]??{};return("number"==typeof e||t[1])&&((0,o.deprecation)("8.5.2","use options object instead"),e={type:"linear",start:{x:t[0],y:t[1]},end:{x:t[2],y:t[3]},textureSpace:t[4],textureSize:t[5]??u.defaultLinearOptions.textureSize}),e}(e);i={..."radial"===i.type?t.defaultRadialOptions:t.defaultLinearOptions,...(0,l.definedProps)(i)},this._textureSize=i.textureSize,this._wrapMode=i.wrapMode,"radial"===i.type?(this.center=i.center,this.outerCenter=i.outerCenter??this.center,this.innerRadius=i.innerRadius,this.outerRadius=i.outerRadius,this.scale=i.scale,this.rotation=i.rotation):(this.start=i.start,this.end=i.end),this.textureSpace=i.textureSpace,this.type=i.type,i.colorStops.forEach(t=>{this.addColorStop(t.offset,t.color)})}addColorStop(t,i){return this.colorStops.push({offset:t,color:e.Color.shared.setValue(i).toHexa()}),this}buildLinearGradient(){if(this.texture)return;let{x:t,y:e}=this.start,{x:i,y:n}=this.end,o=i-t,l=n-e,u=o<0||l<0;if("clamp-to-edge"===this._wrapMode){if(o<0){let e=t;t=i,i=e,o*=-1}if(l<0){let t=e;e=n,n=t,l*=-1}}let p=this.colorStops.length?this.colorStops:h,f=this._textureSize,{canvas:x,context:g}=c(f,1),m=u?g.createLinearGradient(this._textureSize,0,0,0):g.createLinearGradient(0,0,this._textureSize,0);d(m,p),g.fillStyle=m,g.fillRect(0,0,f,1),this.texture=new a.Texture({source:new s.ImageSource({resource:x,addressMode:this._wrapMode})});let _=Math.sqrt(o*o+l*l),y=Math.atan2(l,o),v=new r.Matrix;v.scale(_/f,1),v.rotate(y),v.translate(t,e),"local"===this.textureSpace&&v.scale(f,f),this.transform=v}buildGradient(){!this.texture&&this._tick++,"linear"===this.type?this.buildLinearGradient():this.buildRadialGradient()}buildRadialGradient(){if(this.texture)return;let t=this.colorStops.length?this.colorStops:h,e=this._textureSize,{canvas:i,context:n}=c(e,e),{x:o,y:l}=this.center,{x:u,y:p}=this.outerCenter,f=this.innerRadius,x=this.outerRadius,g=u-x,m=p-x,_=e/(2*x),y=(o-g)*_,v=(l-m)*_,b=n.createRadialGradient(y,v,f*_,(u-g)*_,(p-m)*_,x*_);d(b,t),n.fillStyle=t[t.length-1].color,n.fillRect(0,0,e,e),n.fillStyle=b,n.translate(y,v),n.rotate(this.rotation),n.scale(1,this.scale),n.translate(-y,-v),n.fillRect(0,0,e,e),this.texture=new a.Texture({source:new s.ImageSource({resource:i,addressMode:this._wrapMode})});let T=new r.Matrix;T.scale(1/_,1/_),T.translate(g,m),"local"===this.textureSpace&&T.scale(e,e),this.transform=T}destroy(){this.texture?.destroy(!0),this.texture=null,this.transform=null,this.colorStops=[],this.start=null,this.end=null,this.center=null,this.outerCenter=null}get styleKey(){return`fill-gradient-${this.uid}-${this._tick}`}};function d(t,e){for(let i=0;i<e.length;i++){let r=e[i];t.addColorStop(r.offset,r.color)}}function c(t,e){let r=i.DOMAdapter.get().createCanvas(t,e),s=r.getContext("2d");return{canvas:r,context:s}}u.defaultLinearOptions={start:{x:0,y:0},end:{x:0,y:1},colorStops:[],textureSpace:"local",type:"linear",textureSize:256,wrapMode:"clamp-to-edge"},u.defaultRadialOptions={center:{x:.5,y:.5},innerRadius:0,outerRadius:.5,colorStops:[],scale:1,textureSpace:"local",type:"radial",textureSize:256,wrapMode:"clamp-to-edge"},t.s(["FillGradient",()=>u])},3936,(t,e,i)=>{e.exports=function(t){var e=[];return t.replace(s,function(t,i,s){var n,o=i.toLowerCase();for(s=(n=s.match(a))?n.map(Number):[],"m"==o&&s.length>2&&(e.push([i].concat(s.splice(0,2))),o="l",i="m"==i?"l":"L");;){if(s.length==r[o])return s.unshift(i),e.push(s);if(s.length<r[o])throw Error("malformed path data");e.push([i].concat(s.splice(0,r[o])))}}),e};var r={a:7,c:6,h:1,l:2,m:2,q:4,s:4,t:2,v:1,z:0},s=/([astvzqmhlc])([^astvzqmhlc]*)/ig,a=/-?[0-9]*\.?[0-9]+(?:e[-+]?\d+)?/ig},37836,65767,19258,6290,33900,60295,84332,t=>{"use strict";let e,i;var r=t.i(28959),s=t.i(24314);let a={repeat:{addressModeU:"repeat",addressModeV:"repeat"},"repeat-x":{addressModeU:"repeat",addressModeV:"clamp-to-edge"},"repeat-y":{addressModeU:"clamp-to-edge",addressModeV:"repeat"},"no-repeat":{addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"}};class n{constructor(t,e){this.uid=(0,s.uid)("fillPattern"),this._tick=0,this.transform=new r.Matrix,this.texture=t,this.transform.scale(1/t.frame.width,1/t.frame.height),e&&(t.source.style.addressModeU=a[e].addressModeU,t.source.style.addressModeV=a[e].addressModeV)}setTransform(t){let e=this.texture;this.transform.copyFrom(t),this.transform.invert(),this.transform.scale(1/e.frame.width,1/e.frame.height),this._tick++}get texture(){return this._texture}set texture(t){this._texture!==t&&(this._texture=t,this._tick++)}get styleKey(){return`fill-pattern-${this.uid}-${this._tick}`}destroy(){this.texture.destroy(!0),this.texture=null}}t.s(["FillPattern",()=>n],37836);var o=t.i(3936),l=t.i(85830);function h(t,e){let i=(0,o.default)(t),r=[],s=null,a=0,n=0;for(let t=0;t<i.length;t++){let o=i[t],h=o[0];switch(h){case"M":a=o[1],n=o[2],e.moveTo(a,n);break;case"m":a+=o[1],n+=o[2],e.moveTo(a,n);break;case"H":a=o[1],e.lineTo(a,n);break;case"h":a+=o[1],e.lineTo(a,n);break;case"V":n=o[1],e.lineTo(a,n);break;case"v":n+=o[1],e.lineTo(a,n);break;case"L":a=o[1],n=o[2],e.lineTo(a,n);break;case"l":a+=o[1],n+=o[2],e.lineTo(a,n);break;case"C":a=o[5],n=o[6],e.bezierCurveTo(o[1],o[2],o[3],o[4],a,n);break;case"c":e.bezierCurveTo(a+o[1],n+o[2],a+o[3],n+o[4],a+o[5],n+o[6]),a+=o[5],n+=o[6];break;case"S":a=o[3],n=o[4],e.bezierCurveToShort(o[1],o[2],a,n);break;case"s":e.bezierCurveToShort(a+o[1],n+o[2],a+o[3],n+o[4]),a+=o[3],n+=o[4];break;case"Q":a=o[3],n=o[4],e.quadraticCurveTo(o[1],o[2],a,n);break;case"q":e.quadraticCurveTo(a+o[1],n+o[2],a+o[3],n+o[4]),a+=o[3],n+=o[4];break;case"T":a=o[1],n=o[2],e.quadraticCurveToShort(a,n);break;case"t":a+=o[1],n+=o[2],e.quadraticCurveToShort(a,n);break;case"A":a=o[6],n=o[7],e.arcToSvg(o[1],o[2],o[3],o[4],o[5],a,n);break;case"a":a+=o[6],n+=o[7],e.arcToSvg(o[1],o[2],o[3],o[4],o[5],a,n);break;case"Z":case"z":e.closePath(),r.length>0&&((s=r.pop())?(a=s.startX,n=s.startY):(a=0,n=0)),s=null;break;default:(0,l.warn)(`Unknown SVG path command: ${h}`)}"Z"!==h&&"z"!==h&&null===s&&(s={startX:a,startY:n},r.push(s))}return e}t.s(["parseSVGPath",()=>h],65767);var u=t.i(63646);class d{constructor(t=0,e=0,i=0){this.type="circle",this.x=t,this.y=e,this.radius=i}clone(){return new d(this.x,this.y,this.radius)}contains(t,e){if(this.radius<=0)return!1;let i=this.radius*this.radius,r=this.x-t,s=this.y-e;return r*=r,s*=s,r+s<=i}strokeContains(t,e,i,r=.5){if(0===this.radius)return!1;let s=this.x-t,a=this.y-e,n=this.radius,o=(1-r)*i,l=Math.sqrt(s*s+a*a);return l<=n+o&&l>n-(i-o)}getBounds(t){return t||(t=new u.Rectangle),t.x=this.x-this.radius,t.y=this.y-this.radius,t.width=2*this.radius,t.height=2*this.radius,t}copyFrom(t){return this.x=t.x,this.y=t.y,this.radius=t.radius,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:Circle x=${this.x} y=${this.y} radius=${this.radius}]`}}t.s(["Circle",()=>d],19258);class c{constructor(t=0,e=0,i=0,r=0){this.type="ellipse",this.x=t,this.y=e,this.halfWidth=i,this.halfHeight=r}clone(){return new c(this.x,this.y,this.halfWidth,this.halfHeight)}contains(t,e){if(this.halfWidth<=0||this.halfHeight<=0)return!1;let i=(t-this.x)/this.halfWidth,r=(e-this.y)/this.halfHeight;return i*=i,r*=r,i+r<=1}strokeContains(t,e,i,r=.5){let{halfWidth:s,halfHeight:a}=this;if(s<=0||a<=0)return!1;let n=i*(1-r),o=i-n,l=s-o,h=a-o,u=s+n,d=a+n,c=t-this.x,p=e-this.y;return c*c/(l*l)+p*p/(h*h)>1&&c*c/(u*u)+p*p/(d*d)<=1}getBounds(t){return t||(t=new u.Rectangle),t.x=this.x-this.halfWidth,t.y=this.y-this.halfHeight,t.width=2*this.halfWidth,t.height=2*this.halfHeight,t}copyFrom(t){return this.x=t.x,this.y=t.y,this.halfWidth=t.halfWidth,this.halfHeight=t.halfHeight,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:Ellipse x=${this.x} y=${this.y} halfWidth=${this.halfWidth} halfHeight=${this.halfHeight}]`}}t.s(["Ellipse",()=>c],6290);var p=t.i(49864);function f(t,e,i,r,s,a){let n,o,l=s-i,h=a-r,u=l*l+h*h,d=-1;0!==u&&(d=((t-i)*l+(e-r)*h)/u),d<0?(n=i,o=r):d>1?(n=s,o=a):(n=i+d*l,o=r+d*h);let c=t-n,p=e-o;return c*c+p*p}t.s(["squaredDistanceToLineSegment",()=>f],33900);class x{constructor(...t){this.type="polygon";let e=Array.isArray(t[0])?t[0]:t;if("number"!=typeof e[0]){const t=[];for(let i=0,r=e.length;i<r;i++)t.push(e[i].x,e[i].y);e=t}this.points=e,this.closePath=!0}isClockwise(){let t=0,e=this.points,i=e.length;for(let r=0;r<i;r+=2){let s=e[r],a=e[r+1];t+=(e[(r+2)%i]-s)*(e[(r+3)%i]+a)}return t<0}containsPolygon(t){let r=this.getBounds(e),s=t.getBounds(i);if(!r.containsRect(s))return!1;let a=t.points;for(let t=0;t<a.length;t+=2){let e=a[t],i=a[t+1];if(!this.contains(e,i))return!1}return!0}clone(){let t=new x(this.points.slice());return t.closePath=this.closePath,t}contains(t,e){let i=!1,r=this.points.length/2;for(let s=0,a=r-1;s<r;a=s++){let r=this.points[2*s],n=this.points[2*s+1],o=this.points[2*a],l=this.points[2*a+1];n>e!=l>e&&t<(e-n)/(l-n)*(o-r)+r&&(i=!i)}return i}strokeContains(t,e,i,r=.5){let s=i*i,a=s*(1-r),n=s-a,{points:o}=this,l=o.length-2*!this.closePath;for(let i=0;i<l;i+=2){let r=o[i],s=o[i+1],l=o[(i+2)%o.length],h=o[(i+3)%o.length];if(f(t,e,r,s,l,h)<=(0>Math.sign((l-r)*(e-s)-(h-s)*(t-r))?n:a))return!0}return!1}getBounds(t){t||(t=new u.Rectangle);let e=this.points,i=1/0,r=-1/0,s=1/0,a=-1/0;for(let t=0,n=e.length;t<n;t+=2){let n=e[t],o=e[t+1];i=n<i?n:i,r=n>r?n:r,s=o<s?o:s,a=o>a?o:a}return t.x=i,t.width=r-i,t.y=s,t.height=a-s,t}copyFrom(t){return this.points=t.points.slice(),this.closePath=t.closePath,this}copyTo(t){return t.copyFrom(this),t}toString(){return`[pixi.js/math:PolygoncloseStroke=${this.closePath}points=${this.points.reduce((t,e)=>`${t}, ${e}`,"")}]`}get lastX(){return this.points[this.points.length-2]}get lastY(){return this.points[this.points.length-1]}get x(){return(0,p.deprecation)("8.11.0","Polygon.lastX is deprecated, please use Polygon.lastX instead."),this.points[this.points.length-2]}get y(){return(0,p.deprecation)("8.11.0","Polygon.y is deprecated, please use Polygon.lastY instead."),this.points[this.points.length-1]}get startX(){return this.points[0]}get startY(){return this.points[1]}}t.s(["Polygon",()=>x],60295);let g=(t,e,i,r,s,a,n)=>{let o=t-i,l=e-r,h=Math.sqrt(o*o+l*l);return h>=s-a&&h<=s+n};class m{constructor(t=0,e=0,i=0,r=0,s=20){this.type="roundedRectangle",this.x=t,this.y=e,this.width=i,this.height=r,this.radius=s}getBounds(t){return t||(t=new u.Rectangle),t.x=this.x,t.y=this.y,t.width=this.width,t.height=this.height,t}clone(){return new m(this.x,this.y,this.width,this.height,this.radius)}copyFrom(t){return this.x=t.x,this.y=t.y,this.width=t.width,this.height=t.height,this}copyTo(t){return t.copyFrom(this),t}contains(t,e){if(this.width<=0||this.height<=0)return!1;if(t>=this.x&&t<=this.x+this.width&&e>=this.y&&e<=this.y+this.height){let i=Math.max(0,Math.min(this.radius,Math.min(this.width,this.height)/2));if(e>=this.y+i&&e<=this.y+this.height-i||t>=this.x+i&&t<=this.x+this.width-i)return!0;let r=t-(this.x+i),s=e-(this.y+i),a=i*i;if(r*r+s*s<=a||(r=t-(this.x+this.width-i))*r+s*s<=a||r*r+(s=e-(this.y+this.height-i))*s<=a||(r=t-(this.x+i))*r+s*s<=a)return!0}return!1}strokeContains(t,e,i,r=.5){let{x:s,y:a,width:n,height:o,radius:l}=this,h=i*(1-r),u=i-h,d=s+l,c=a+l,p=n-2*l,f=o-2*l,x=s+n,m=a+o;return(t>=s-h&&t<=s+u||t>=x-u&&t<=x+h)&&e>=c&&e<=c+f||(e>=a-h&&e<=a+u||e>=m-u&&e<=m+h)&&t>=d&&t<=d+p||t<d&&e<c&&g(t,e,d,c,l,u,h)||t>x-l&&e<c&&g(t,e,x-l,c,l,u,h)||t>x-l&&e>m-l&&g(t,e,x-l,m-l,l,u,h)||t<d&&e>m-l&&g(t,e,d,m-l,l,u,h)}toString(){return`[pixi.js/math:RoundedRectangle x=${this.x} y=${this.y}width=${this.width} height=${this.height} radius=${this.radius}]`}}t.s(["RoundedRectangle",()=>m],84332)},97695,84018,1187,54568,35239,26465,56192,67642,70826,25472,8388,94183,19356,t=>{"use strict";function e(t,i,r,s,a,n,o,l=null){let h=0;r*=i,a*=n;let u=l.a,d=l.b,c=l.c,p=l.d,f=l.tx,x=l.ty;for(;h<o;){let e=t[r],o=t[r+1];s[a]=u*e+c*o+f,s[a+1]=d*e+p*o+x,a+=n,r+=i,h++}}function i(t,e,i,r){let s=0;for(e*=i;s<r;)t[e]=0,t[e+1]=0,e+=i,s++}function r(t,e,i,r,s){let a=e.a,n=e.b,o=e.c,l=e.d,h=e.tx,u=e.ty;i||(i=0),r||(r=2),s||(s=t.length/r-i);let d=i*r;for(let e=0;e<s;e++){let e=t[d],i=t[d+1];t[d]=a*e+o*i+h,t[d+1]=n*e+l*i+u,d+=r}}t.s(["buildSimpleUvs",()=>i,"buildUvs",()=>e],97695),t.s(["transformVertices",()=>r],84018);var s=t.i(28959),a=t.i(79276);let n=new s.Matrix;class o{constructor(){this.packAsQuad=!1,this.batcherName="default",this.topology="triangle-list",this.applyTransform=!0,this.roundPixels=0,this._batcher=null,this._batch=null}get uvs(){return this.geometryData.uvs}get positions(){return this.geometryData.vertices}get indices(){return this.geometryData.indices}get blendMode(){return this.renderable&&this.applyTransform?this.renderable.groupBlendMode:"normal"}get color(){let t=this.baseColor,e=t>>16|65280&t|(255&t)<<16,i=this.renderable;return i?(0,a.multiplyHexColors)(e,i.groupColor)+(this.alpha*i.groupAlpha*255<<24):e+(255*this.alpha<<24)}get transform(){return this.renderable?.groupTransform||n}copyTo(t){t.indexOffset=this.indexOffset,t.indexSize=this.indexSize,t.attributeOffset=this.attributeOffset,t.attributeSize=this.attributeSize,t.baseColor=this.baseColor,t.alpha=this.alpha,t.texture=this.texture,t.geometryData=this.geometryData,t.topology=this.topology}reset(){this.applyTransform=!0,this.renderable=null,this.topology="triangle-list"}destroy(){this.renderable=null,this.texture=null,this.geometryData=null,this._batcher=null,this._batch=null}}t.s(["BatchableGraphics",()=>o],1187);var l=t.i(47760);let h={extension:{type:l.ExtensionType.ShapeBuilder,name:"circle"},build(t,e){let i,r,s,a,n,o;if("circle"===t.type){if((n=o=t.radius)<=0)return!1;i=t.x,r=t.y,s=a=0}else if("ellipse"===t.type){if(n=t.halfWidth,o=t.halfHeight,n<=0||o<=0)return!1;i=t.x,r=t.y,s=a=0}else{let e=t.width/2,l=t.height/2;i=t.x+e,r=t.y+l,n=o=Math.max(0,Math.min(t.radius,Math.min(e,l))),s=e-n,a=l-o}if(s<0||a<0)return!1;let l=Math.ceil(2.3*Math.sqrt(n+o)),h=8*l+4*!!s+4*!!a;if(0===h)return!1;if(0===l)return e[0]=e[6]=i+s,e[1]=e[3]=r+a,e[2]=e[4]=i-s,e[5]=e[7]=r-a,!0;let u=0,d=4*l+2*!!s+2,c=d,p=h,f=s+n,x=a,g=i+f,m=i-f,_=r+x;if(e[u++]=g,e[u++]=_,e[--d]=_,e[--d]=m,a){let t=r-x;e[c++]=m,e[c++]=t,e[--p]=t,e[--p]=g}for(let t=1;t<l;t++){let h=Math.PI/2*(t/l),f=s+Math.cos(h)*n,x=a+Math.sin(h)*o,g=i+f,m=i-f,_=r+x,y=r-x;e[u++]=g,e[u++]=_,e[--d]=_,e[--d]=m,e[c++]=m,e[c++]=y,e[--p]=y,e[--p]=g}f=s,x=a+o,g=i+f,m=i-f,_=r+x;let y=r-x;return e[u++]=g,e[u++]=_,e[--p]=y,e[--p]=g,s&&(e[u++]=m,e[u++]=_,e[--p]=y,e[--p]=m),!0},triangulate(t,e,i,r,s,a){if(0===t.length)return;let n=0,o=0;for(let e=0;e<t.length;e+=2)n+=t[e],o+=t[e+1];n/=t.length/2,o/=t.length/2;let l=r;e[l*i]=n,e[l*i+1]=o;let h=l++;for(let r=0;r<t.length;r+=2)e[l*i]=t[r],e[l*i+1]=t[r+1],r>0&&(s[a++]=l,s[a++]=h,s[a++]=l-1),l++;s[a++]=h+1,s[a++]=h,s[a++]=l-1}},u={...h,extension:{...h.extension,name:"ellipse"}},d={...h,extension:{...h.extension,name:"roundedRectangle"}};t.s(["buildCircle",()=>h,"buildEllipse",()=>u,"buildRoundedRectangle",()=>d],54568);var c=t.i(26963);function p(t){let e=t.length;if(e<6)return 1;let i=0;for(let r=0,s=t[e-2],a=t[e-1];r<e;r+=2){let e=t[r],n=t[r+1];i+=(e-s)*(n+a),s=e,a=n}return i<0?-1:1}function f(t,e,i,r,s,a,n,o){let l,h;n?(l=r,h=-i):(l=-r,h=i);let u=t-i*s+l,d=e-r*s+h,c=t+i*a+l,p=e+r*a+h;return o.push(u,d),o.push(c,p),2}function x(t,e,i,r,s,a,n,o){let l=i-t,h=r-e,u=Math.atan2(l,h),d=Math.atan2(s-t,a-e);o&&u<d?u+=2*Math.PI:!o&&u>d&&(d+=2*Math.PI);let c=u,p=d-u,f=Math.sqrt(l*l+h*h),x=(15*Math.abs(p)*Math.sqrt(f)/Math.PI|0)+1,g=p/x;if(c+=g,o){n.push(t,e),n.push(i,r);for(let i=1,r=c;i<x;i++,r+=g)n.push(t,e),n.push(t+Math.sin(r)*f,e+Math.cos(r)*f);n.push(t,e),n.push(s,a)}else{n.push(i,r),n.push(t,e);for(let i=1,r=c;i<x;i++,r+=g)n.push(t+Math.sin(r)*f,e+Math.cos(r)*f),n.push(t,e);n.push(s,a),n.push(t,e)}return 2*x}function g(t,e,i,r,s,a){if(0===t.length)return;let n=e.alignment;if(.5!==e.alignment){let e=p(t);i&&(e*=-1),n=(n-.5)*e+.5}let o=new c.Point(t[0],t[1]),l=new c.Point(t[t.length-2],t[t.length-1]),h=1e-4>Math.abs(o.x-l.x)&&1e-4>Math.abs(o.y-l.y);if(r){t=t.slice(),h&&(t.pop(),t.pop(),l.set(t[t.length-2],t[t.length-1]));let e=(o.x+l.x)*.5,i=(l.y+o.y)*.5;t.unshift(e,i),t.push(e,i)}let u=t.length/2,d=t.length,g=s.length/2,m=e.width/2,_=m*m,y=e.miterLimit*e.miterLimit,v=t[0],b=t[1],T=t[2],S=t[3],P=0,w=0,C=-(b-S),M=v-T,A=0,k=0,B=Math.sqrt(C*C+M*M);C/=B,M/=B,C*=m,M*=m;let F=n,R=(1-F)*2,U=2*F;r||("round"===e.cap?d+=x(v-C*(R-U)*.5,b-M*(R-U)*.5,v-C*R,b-M*R,v+C*U,b+M*U,s,!0)+2:"square"===e.cap&&(d+=f(v,b,C,M,R,U,!0,s))),s.push(v-C*R,b-M*R),s.push(v+C*U,b+M*U);for(let i=1;i<u-1;++i){v=t[(i-1)*2],b=t[(i-1)*2+1],T=t[2*i],S=t[2*i+1],P=t[(i+1)*2],w=t[(i+1)*2+1],B=Math.sqrt((C=-(b-S))*C+(M=v-T)*M),C/=B,M/=B,C*=m,M*=m,B=Math.sqrt((A=-(S-w))*A+(k=T-P)*k),A/=B,k/=B,A*=m,k*=m;let r=T-v,a=b-S,n=T-P,o=w-S,l=r*n+a*o,h=a*n-o*r,u=h<0;if(Math.abs(h)<.001*Math.abs(l)){s.push(T-C*R,S-M*R),s.push(T+C*U,S+M*U),l>=0&&("round"===e.join?d+=x(T,S,T-C*R,S-M*R,T-A*R,S-k*R,s,!1)+4:d+=2,s.push(T-A*U,S-k*U),s.push(T+A*R,S+k*R));continue}let c=(-C+v)*(-M+S)-(-C+T)*(-M+b),p=(-A+P)*(-k+S)-(-A+T)*(-k+w),f=(r*p-n*c)/h,g=(o*c-a*p)/h,F=(f-T)*(f-T)+(g-S)*(g-S),G=T+(f-T)*R,E=S+(g-S)*R,z=T-(f-T)*U,I=S-(g-S)*U,D=u?R:U;F<=Math.min(r*r+a*a,n*n+o*o)+D*D*_?"bevel"===e.join||F/_>y?(u?(s.push(G,E),s.push(T+C*U,S+M*U),s.push(G,E),s.push(T+A*U,S+k*U)):(s.push(T-C*R,S-M*R),s.push(z,I),s.push(T-A*R,S-k*R),s.push(z,I)),d+=2):"round"===e.join?u?(s.push(G,E),s.push(T+C*U,S+M*U),d+=x(T,S,T+C*U,S+M*U,T+A*U,S+k*U,s,!0)+4,s.push(G,E),s.push(T+A*U,S+k*U)):(s.push(T-C*R,S-M*R),s.push(z,I),d+=x(T,S,T-C*R,S-M*R,T-A*R,S-k*R,s,!1)+4,s.push(T-A*R,S-k*R),s.push(z,I)):(s.push(G,E),s.push(z,I)):(s.push(T-C*R,S-M*R),s.push(T+C*U,S+M*U),"round"===e.join?u?d+=x(T,S,T+C*U,S+M*U,T+A*U,S+k*U,s,!0)+2:d+=x(T,S,T-C*R,S-M*R,T-A*R,S-k*R,s,!1)+2:"miter"===e.join&&F/_<=y&&(u?(s.push(z,I),s.push(z,I)):(s.push(G,E),s.push(G,E)),d+=2),s.push(T-A*R,S-k*R),s.push(T+A*U,S+k*U),d+=2)}v=t[(u-2)*2],b=t[(u-2)*2+1],T=t[(u-1)*2],B=Math.sqrt((C=-(b-(S=t[(u-1)*2+1])))*C+(M=v-T)*M),C/=B,M/=B,C*=m,M*=m,s.push(T-C*R,S-M*R),s.push(T+C*U,S+M*U),r||("round"===e.cap?d+=x(T-C*(R-U)*.5,S-M*(R-U)*.5,T-C*R,S-M*R,T+C*U,S+M*U,s,!1)+2:"square"===e.cap&&(d+=f(T,S,C,M,R,U,!1,s)));let G=1e-4*1e-4;for(let t=g;t<d+g-2;++t)v=s[2*t],b=s[2*t+1],T=s[(t+1)*2],S=s[(t+1)*2+1],P=s[(t+2)*2],Math.abs(v*(S-(w=s[(t+2)*2+1]))+T*(w-b)+P*(b-S))<G||a.push(t,t+1,t+2)}function m(t,e,i,r){if(0===t.length)return;let s=t[0],a=t[1],n=t[t.length-2],o=t[t.length-1],l=e||1e-4>Math.abs(s-n)&&1e-4>Math.abs(a-o),h=t.length/2,u=i.length/2;for(let e=0;e<h;e++)i.push(t[2*e]),i.push(t[2*e+1]);for(let t=0;t<h-1;t++)r.push(u+t,u+t+1);l&&r.push(u+h-1,u)}function _(t,e,i=2){let r,s,a,n=e&&e.length,o=n?e[0]*i:t.length,l=y(t,0,o,i,!0),h=[];if(!l||l.next===l.prev)return h;if(n&&(l=function(t,e,i,r){let s=[];for(let i=0,a=e.length;i<a;i++){let n=e[i]*r,o=i<a-1?e[i+1]*r:t.length,l=y(t,n,o,r,!1);l===l.next&&(l.steiner=!0),s.push(function(t){let e=t,i=t;do(e.x<i.x||e.x===i.x&&e.y<i.y)&&(i=e),e=e.next;while(e!==t)return i}(l))}s.sort(b);for(let t=0;t<s.length;t++)i=function(t,e){let i=function(t,e){let i,r=e,s=t.x,a=t.y,n=-1/0;if(C(t,r))return r;do{if(C(t,r.next))return r.next;if(a<=r.y&&a>=r.next.y&&r.next.y!==r.y){let t=r.x+(a-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(t<=s&&t>n&&(n=t,i=r.x<r.next.x?r:r.next,t===s))return i}r=r.next}while(r!==e)if(!i)return null;let o=i,l=i.x,h=i.y,u=1/0;r=i;do{if(s>=r.x&&r.x>=l&&s!==r.x&&S(a<h?s:n,a,l,h,a<h?n:s,a,r.x,r.y)){var d,c;let e=Math.abs(a-r.y)/(s-r.x);B(r,t)&&(e<u||e===u&&(r.x>i.x||r.x===i.x&&(d=i,c=r,0>w(d.prev,d,c.prev)&&0>w(c.next,d,d.next))))&&(i=r,u=e)}r=r.next}while(r!==o)return i}(t,e);if(!i)return e;let r=F(i,t);return v(r,r.next),v(i,i.next)}(s[t],i);return i}(t,e,l,i)),t.length>80*i){r=t[0],s=t[1];let e=r,n=s;for(let a=i;a<o;a+=i){let i=t[a],o=t[a+1];i<r&&(r=i),o<s&&(s=o),i>e&&(e=i),o>n&&(n=o)}a=0!==(a=Math.max(e-r,n-s))?32767/a:0}return function t(e,i,r,s,a,n,o){if(!e)return;!o&&n&&function(t,e,i,r){let s=t;do 0===s.z&&(s.z=T(s.x,s.y,e,i,r)),s.prevZ=s.prev,s.nextZ=s.next,s=s.next;while(s!==t)s.prevZ.nextZ=null,s.prevZ=null,function(t){let e,i=1;do{let r,s=t;t=null;let a=null;for(e=0;s;){e++;let n=s,o=0;for(let t=0;t<i&&(o++,n=n.nextZ);t++);let l=i;for(;o>0||l>0&&n;)0!==o&&(0===l||!n||s.z<=n.z)?(r=s,s=s.nextZ,o--):(r=n,n=n.nextZ,l--),a?a.nextZ=r:t=r,r.prevZ=a,a=r;s=n}a.nextZ=null,i*=2}while(e>1)}(s)}(e,s,a,n);let l=e;for(;e.prev!==e.next;){let h=e.prev,u=e.next;if(n?function(t,e,i,r){let s=t.prev,a=t.next;if(w(s,t,a)>=0)return!1;let n=s.x,o=t.x,l=a.x,h=s.y,u=t.y,d=a.y,c=Math.min(n,o,l),p=Math.min(h,u,d),f=Math.max(n,o,l),x=Math.max(h,u,d),g=T(c,p,e,i,r),m=T(f,x,e,i,r),_=t.prevZ,y=t.nextZ;for(;_&&_.z>=g&&y&&y.z<=m;){if(_.x>=c&&_.x<=f&&_.y>=p&&_.y<=x&&_!==s&&_!==a&&P(n,h,o,u,l,d,_.x,_.y)&&w(_.prev,_,_.next)>=0||(_=_.prevZ,y.x>=c&&y.x<=f&&y.y>=p&&y.y<=x&&y!==s&&y!==a&&P(n,h,o,u,l,d,y.x,y.y)&&w(y.prev,y,y.next)>=0))return!1;y=y.nextZ}for(;_&&_.z>=g;){if(_.x>=c&&_.x<=f&&_.y>=p&&_.y<=x&&_!==s&&_!==a&&P(n,h,o,u,l,d,_.x,_.y)&&w(_.prev,_,_.next)>=0)return!1;_=_.prevZ}for(;y&&y.z<=m;){if(y.x>=c&&y.x<=f&&y.y>=p&&y.y<=x&&y!==s&&y!==a&&P(n,h,o,u,l,d,y.x,y.y)&&w(y.prev,y,y.next)>=0)return!1;y=y.nextZ}return!0}(e,s,a,n):function(t){let e=t.prev,i=t.next;if(w(e,t,i)>=0)return!1;let r=e.x,s=t.x,a=i.x,n=e.y,o=t.y,l=i.y,h=Math.min(r,s,a),u=Math.min(n,o,l),d=Math.max(r,s,a),c=Math.max(n,o,l),p=i.next;for(;p!==e;){if(p.x>=h&&p.x<=d&&p.y>=u&&p.y<=c&&P(r,n,s,o,a,l,p.x,p.y)&&w(p.prev,p,p.next)>=0)return!1;p=p.next}return!0}(e)){i.push(h.i,e.i,u.i),U(e),e=u.next,l=u.next;continue}if((e=u)===l){o?1===o?t(e=function(t,e){let i=t;do{let r=i.prev,s=i.next.next;!C(r,s)&&M(r,i,i.next,s)&&B(r,s)&&B(s,r)&&(e.push(r.i,i.i,s.i),U(i),U(i.next),i=t=s),i=i.next}while(i!==t)return v(i)}(v(e),i),i,r,s,a,n,2):2===o&&function(e,i,r,s,a,n){let o=e;do{let e=o.next.next;for(;e!==o.prev;){var l,h;if(o.i!==e.i&&(l=o,h=e,l.next.i!==h.i&&l.prev.i!==h.i&&!function(t,e){let i=t;do{if(i.i!==t.i&&i.next.i!==t.i&&i.i!==e.i&&i.next.i!==e.i&&M(i,i.next,t,e))return!0;i=i.next}while(i!==t)return!1}(l,h)&&(B(l,h)&&B(h,l)&&function(t,e){let i=t,r=!1,s=(t.x+e.x)/2,a=(t.y+e.y)/2;do i.y>a!=i.next.y>a&&i.next.y!==i.y&&s<(i.next.x-i.x)*(a-i.y)/(i.next.y-i.y)+i.x&&(r=!r),i=i.next;while(i!==t)return r}(l,h)&&(w(l.prev,l,h.prev)||w(l,h.prev,h))||C(l,h)&&w(l.prev,l,l.next)>0&&w(h.prev,h,h.next)>0))){let l=F(o,e);o=v(o,o.next),l=v(l,l.next),t(o,i,r,s,a,n,0),t(l,i,r,s,a,n,0);return}e=e.next}o=o.next}while(o!==e)}(e,i,r,s,a,n):t(v(e),i,r,s,a,n,1);break}}}(l,h,i,r,s,a,0),h}function y(t,e,i,r,s){let a;if(s===function(t,e,i,r){let s=0;for(let a=e,n=i-r;a<i;a+=r)s+=(t[n]-t[a])*(t[a+1]+t[n+1]),n=a;return s}(t,e,i,r)>0)for(let s=e;s<i;s+=r)a=R(s/r|0,t[s],t[s+1],a);else for(let s=i-r;s>=e;s-=r)a=R(s/r|0,t[s],t[s+1],a);return a&&C(a,a.next)&&(U(a),a=a.next),a}function v(t,e){if(!t)return t;e||(e=t);let i=t,r;do if(r=!1,!i.steiner&&(C(i,i.next)||0===w(i.prev,i,i.next))){if(U(i),(i=e=i.prev)===i.next)break;r=!0}else i=i.next;while(r||i!==e)return e}t.s(["closePointEps",()=>1e-4,"curveEps",()=>1e-4],35239),t.s(["getOrientationOfPoints",()=>p],26465),t.s(["buildLine",()=>g],56192),t.s(["buildPixelLine",()=>m],67642);function b(t,e){let i=t.x-e.x;return 0===i&&0==(i=t.y-e.y)&&(i=(t.next.y-t.y)/(t.next.x-t.x)-(e.next.y-e.y)/(e.next.x-e.x)),i}function T(t,e,i,r,s){return(t=((t=((t=((t=((t=(t-i)*s|0)|t<<8)&0xff00ff)|t<<4)&0xf0f0f0f)|t<<2)&0x33333333)|t<<1)&0x55555555)|(e=((e=((e=((e=((e=(e-r)*s|0)|e<<8)&0xff00ff)|e<<4)&0xf0f0f0f)|e<<2)&0x33333333)|e<<1)&0x55555555)<<1}function S(t,e,i,r,s,a,n,o){return(s-n)*(e-o)>=(t-n)*(a-o)&&(t-n)*(r-o)>=(i-n)*(e-o)&&(i-n)*(a-o)>=(s-n)*(r-o)}function P(t,e,i,r,s,a,n,o){return(t!==n||e!==o)&&S(t,e,i,r,s,a,n,o)}function w(t,e,i){return(e.y-t.y)*(i.x-e.x)-(e.x-t.x)*(i.y-e.y)}function C(t,e){return t.x===e.x&&t.y===e.y}function M(t,e,i,r){let s=k(w(t,e,i)),a=k(w(t,e,r)),n=k(w(i,r,t)),o=k(w(i,r,e));return!!(s!==a&&n!==o||0===s&&A(t,i,e)||0===a&&A(t,r,e)||0===n&&A(i,t,r)||0===o&&A(i,e,r))}function A(t,e,i){return e.x<=Math.max(t.x,i.x)&&e.x>=Math.min(t.x,i.x)&&e.y<=Math.max(t.y,i.y)&&e.y>=Math.min(t.y,i.y)}function k(t){return t>0?1:t<0?-1:0}function B(t,e){return 0>w(t.prev,t,t.next)?w(t,e,t.next)>=0&&w(t,t.prev,e)>=0:0>w(t,e,t.prev)||0>w(t,t.next,e)}function F(t,e){let i=G(t.i,t.x,t.y),r=G(e.i,e.x,e.y),s=t.next,a=e.prev;return t.next=e,e.prev=t,i.next=s,s.prev=i,r.next=i,i.prev=r,a.next=r,r.prev=a,r}function R(t,e,i,r){let s=G(t,e,i);return r?(s.next=r.next,s.prev=r,r.next.prev=s,r.next=s):(s.prev=s,s.next=s),s}function U(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function G(t,e,i){return{i:t,x:e,y:i,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}t.i(95932);let E=_.default||_;function z(t,e,i,r,s,a,n){let o=E(t,e,2);if(!o)return;for(let t=0;t<o.length;t+=3)a[n++]=o[t]+s,a[n++]=o[t+1]+s,a[n++]=o[t+2]+s;let l=s*r;for(let e=0;e<t.length;e+=2)i[l]=t[e],i[l+1]=t[e+1],l+=r}t.s(["earcut",()=>E],70826),t.s(["triangulateWithHoles",()=>z],25472);let I=[],D={extension:{type:l.ExtensionType.ShapeBuilder,name:"polygon"},build(t,e){for(let i=0;i<t.points.length;i++)e[i]=t.points[i];return!0},triangulate(t,e,i,r,s,a){z(t,I,e,i,r,s,a)}};t.s(["buildPolygon",()=>D],8388);let O={extension:{type:l.ExtensionType.ShapeBuilder,name:"rectangle"},build(t,e){let i=t.x,r=t.y,s=t.width,a=t.height;return!!(s>0&&a>0)&&(e[0]=i,e[1]=r,e[2]=i+s,e[3]=r,e[4]=i+s,e[5]=r+a,e[6]=i,e[7]=r+a,!0)},triangulate(t,e,i,r,s,a){let n=0;e[(r*=i)+n]=t[0],e[r+n+1]=t[1],n+=i,e[r+n]=t[2],e[r+n+1]=t[3],n+=i,e[r+n]=t[6],e[r+n+1]=t[7],n+=i,e[r+n]=t[4],e[r+n+1]=t[5],n+=i;let o=r/i;s[a++]=o,s[a++]=o+1,s[a++]=o+2,s[a++]=o+1,s[a++]=o+3,s[a++]=o+2}};t.s(["buildRectangle",()=>O],94183);let L={extension:{type:l.ExtensionType.ShapeBuilder,name:"triangle"},build:(t,e)=>(e[0]=t.x,e[1]=t.y,e[2]=t.x2,e[3]=t.y2,e[4]=t.x3,e[5]=t.y3,!0),triangulate(t,e,i,r,s,a){let n=0;e[(r*=i)+n]=t[0],e[r+n+1]=t[1],n+=i,e[r+n]=t[2],e[r+n+1]=t[3],n+=i,e[r+n]=t[4],e[r+n+1]=t[5];let o=r/i;s[a++]=o,s[a++]=o+1,s[a++]=o+2}};t.s(["buildTriangle",()=>L],19356)},99166,12114,85457,t=>{"use strict";var e=t.i(47760),i=t.i(68750),r=t.i(97828),s=t.i(30725),a=t.i(33219),n=t.i(49864),o=t.i(74179),l=t.i(28959),h=t.i(63646),u=t.i(97695),d=t.i(84018),c=t.i(31320),p=t.i(1187),f=t.i(54568),x=t.i(56192),g=t.i(67642),m=t.i(8388),_=t.i(94183),y=t.i(19356),v=t.i(81541);let b=new l.Matrix,T=new h.Rectangle;function S(t,e,i,r){let s=e.matrix?t.copyFrom(e.matrix).invert():t.identity();if("local"===e.textureSpace){let t=i.getBounds(T);e.width&&t.pad(e.width);let{x:r,y:a}=t,n=1/t.width,o=1/t.height,l=-r*n,h=-a*o,u=s.a,d=s.b,c=s.c,p=s.d;s.a*=n,s.b*=n,s.c*=o,s.d*=o,s.tx=l*u+h*c+s.tx,s.ty=l*d+h*p+s.ty}else s.translate(e.texture.frame.x,e.texture.frame.y),s.scale(1/e.texture.source.width,1/e.texture.source.height);let a=e.texture.source.style;return e.fill instanceof v.FillGradient||"clamp-to-edge"!==a.addressMode||(a.addressMode="repeat",a.update()),r&&s.append(b.copyFrom(r).invert()),s}t.s(["generateTextureMatrix",()=>S],12114);var P=t.i(25472);let w={};e.extensions.handleByMap(e.ExtensionType.ShapeBuilder,w),e.extensions.add(_.buildRectangle,m.buildPolygon,y.buildTriangle,f.buildCircle,f.buildEllipse,f.buildRoundedRectangle);let C=new h.Rectangle,M=new l.Matrix;function A(t,e){let{geometryData:i,batches:r}=e;r.length=0,i.indices.length=0,i.vertices.length=0,i.uvs.length=0;for(let e=0;e<t.instructions.length;e++){let s=t.instructions[e];if("texture"===s.action)!function(t,e,i){let r=[],s=w.rectangle;C.x=t.dx,C.y=t.dy,C.width=t.dw,C.height=t.dh;let a=t.transform;if(!s.build(C,r))return;let{vertices:n,uvs:l,indices:h}=i,u=h.length,c=n.length/2;a&&(0,d.transformVertices)(r,a),s.triangulate(r,n,2,c,h,u);let f=t.image,x=f.uvs;l.push(x.x0,x.y0,x.x1,x.y1,x.x3,x.y3,x.x2,x.y2);let g=o.BigPool.get(p.BatchableGraphics);g.indexOffset=u,g.indexSize=h.length-u,g.attributeOffset=c,g.attributeSize=n.length/2-c,g.baseColor=t.style,g.alpha=t.alpha,g.texture=f,g.geometryData=i,e.push(g)}(s.data,r,i);else if("fill"===s.action||"stroke"===s.action){let t="stroke"===s.action,e=s.data.path.shapePath,a=s.data.style,n=s.data.hole;t&&n&&k(n.shapePath,a,!0,r,i),n&&(e.shapePrimitives[e.shapePrimitives.length-1].holes=n.shapePath.shapePrimitives),k(e,a,t,r,i)}}}function k(t,e,i,r,s){let{vertices:a,uvs:n,indices:l}=s;t.shapePrimitives.forEach(({shape:t,transform:h,holes:f})=>{let m=[],_=w[t.type];if(!_.build(t,m))return;let y=l.length,v=a.length/2,b="triangle-list";if(h&&(0,d.transformVertices)(m,h),i){let i=t.closePath??!0;e.pixelLine?((0,g.buildPixelLine)(m,i,a,l),b="line-list"):(0,x.buildLine)(m,e,!1,i,a,l)}else if(f){let t=[],e=m.slice();(function(t){let e=[];for(let i=0;i<t.length;i++){let r=t[i].shape,s=[];w[r.type].build(r,s)&&e.push(s)}return e})(f).forEach(i=>{t.push(e.length/2),e.push(...i)}),(0,P.triangulateWithHoles)(e,t,a,2,v,l,y)}else _.triangulate(m,a,2,v,l,y);let T=n.length/2,C=e.texture;if(C!==c.Texture.WHITE){let i=S(M,e,t,h);(0,u.buildUvs)(a,2,v,n,T,2,a.length/2-v,i)}else(0,u.buildSimpleUvs)(n,T,2,a.length/2-v);let A=o.BigPool.get(p.BatchableGraphics);A.indexOffset=y,A.indexSize=l.length-y,A.attributeOffset=v,A.attributeSize=a.length/2-v,A.baseColor=e.color,A.alpha=e.alpha,A.texture=C,A.geometryData=s,A.topology=b,r.push(A)})}t.s(["buildContextBatches",()=>A,"shapeBuilders",()=>w],85457);class B{constructor(){this.batches=[],this.geometryData={vertices:[],uvs:[],indices:[]}}reset(){this.batches&&this.batches.forEach(t=>{o.BigPool.return(t)}),this.graphicsData&&o.BigPool.return(this.graphicsData),this.isBatchable=!1,this.context=null,this.batches.length=0,this.geometryData.indices.length=0,this.geometryData.vertices.length=0,this.geometryData.uvs.length=0,this.graphicsData=null}destroy(){this.reset(),this.batches=null,this.geometryData=null}}class F{constructor(){this.instructions=new s.InstructionSet}init(t){let e=t.maxTextures;this.batcher?this.batcher._updateMaxTextures(e):this.batcher=new r.DefaultBatcher({maxTextures:e}),this.instructions.reset()}get geometry(){return(0,n.deprecation)(n.v8_3_4,"GraphicsContextRenderData#geometry is deprecated, please use batcher.geometry instead."),this.batcher.geometry}destroy(){this.batcher.destroy(),this.instructions.destroy(),this.batcher=null,this.instructions=null}}let R=class t{constructor(t){this._renderer=t,this._managedContexts=new a.GCManagedHash({renderer:t,type:"resource",name:"graphicsContext"})}init(e){t.defaultOptions.bezierSmoothness=e?.bezierSmoothness??t.defaultOptions.bezierSmoothness}getContextRenderData(t){return t._gpuData[this._renderer.uid].graphicsData||this._initContextRenderData(t)}updateGpuContext(t){let e=!!t._gpuData[this._renderer.uid],i=t._gpuData[this._renderer.uid]||this._initContext(t);if(t.dirty||!e){e&&i.reset(),A(t,i);let r=t.batchMode;t.customShader||"no-batch"===r?i.isBatchable=!1:"auto"===r?i.isBatchable=i.geometryData.vertices.length<400:i.isBatchable=!0,t.dirty=!1}return i}getGpuContext(t){return t._gpuData[this._renderer.uid]||this._initContext(t)}_initContextRenderData(t){let e=o.BigPool.get(F,{maxTextures:this._renderer.limits.maxBatchableTextures}),r=t._gpuData[this._renderer.uid],{batches:s,geometryData:a}=r;r.graphicsData=e;let n=a.vertices.length,l=a.indices.length;for(let t=0;t<s.length;t++)s[t].applyTransform=!1;let h=e.batcher;h.ensureAttributeBuffer(n),h.ensureIndexBuffer(l),h.begin();for(let t=0;t<s.length;t++){let e=s[t];h.add(e)}h.finish(e.instructions);let u=h.geometry;u.indexBuffer.setDataWithSize(h.indexBuffer,h.indexSize,!0),u.buffers[0].setDataWithSize(h.attributeBuffer.float32View,h.attributeSize,!0);let d=h.batches;for(let t=0;t<d.length;t++){let e=d[t];e.bindGroup=(0,i.getTextureBatchBindGroup)(e.textures.textures,e.textures.count,this._renderer.limits.maxBatchableTextures)}return e}_initContext(t){let e=new B;return e.context=t,t._gpuData[this._renderer.uid]=e,this._managedContexts.add(t),e}destroy(){this._managedContexts.destroy(),this._renderer=null}};R.extension={type:[e.ExtensionType.WebGLSystem,e.ExtensionType.WebGPUSystem,e.ExtensionType.CanvasSystem],name:"graphicsContext"},R.defaultOptions={bezierSmoothness:.5},t.s(["GpuGraphicsContext",()=>B,"GraphicsContextRenderData",()=>F,"GraphicsContextSystem",()=>R],99166)},73239,19773,85066,97894,80097,23940,16053,18626,44252,87371,77755,74184,86159,67452,93326,91166,86230,20446,t=>{"use strict";var e=t.i(95932),i=t.i(57471),r=t.i(24314),s=t.i(49864),a=t.i(85830),n=t.i(81541),o=t.i(37836),l=e,h=t.i(28959),u=t.i(26963),d=t.i(31320),c=t.i(69553),p=t.i(65767),f=t.i(19258),x=t.i(6290),g=t.i(60295),m=t.i(63646),_=t.i(84332),y=t.i(99166);function v(t,e,i,r,s,a,n,o,l,h){var u,d,c;let p=(1-Math.min(.99,Math.max(0,h??y.GraphicsContextSystem.defaultOptions.bezierSmoothness)))/1;return p*=p,function t(e,i,r,s,a,n,o,l,h,u,d){if(d>8)return;let c=(e+r)/2,p=(i+s)/2,f=(r+a)/2,x=(s+n)/2,g=(a+o)/2,m=(n+l)/2,_=(c+f)/2,y=(p+x)/2,v=(f+g)/2,b=(x+m)/2,T=(_+v)/2,S=(y+b)/2;if(d>0){let t=o-e,d=l-i,c=Math.abs((r-o)*d-(s-l)*t),p=Math.abs((a-o)*d-(n-l)*t);if(c>11920929e-14&&p>11920929e-14){if((c+p)*(c+p)<=u*(t*t+d*d))return void h.push(T,S)}else if(c>11920929e-14){if(c*c<=u*(t*t+d*d))return void h.push(T,S)}else if(p>11920929e-14){if(p*p<=u*(t*t+d*d))return void h.push(T,S)}else if((t=T-(e+o)/2)*t+(d=S-(i+l)/2)*d<=u)return void h.push(T,S)}t(e,i,c,p,_,y,T,S,h,u,d+1),t(T,S,v,b,g,m,o,l,h,u,d+1)}(e,i,r,s,a,n,u=o,d=l,c=t,p,0),c.push(u,d),t}function b(t,e,i,r,s,a,n,o){var l,h,u,d,c,p,f;let x=(1-Math.min(.99,Math.max(0,o??y.GraphicsContextSystem.defaultOptions.bezierSmoothness)))/1;return x*=x,l=e,h=i,u=r,d=s,c=a,p=n,function t(e,i,r,s,a,n,o,l,h){if(h>8)return;let u=(i+s)/2,d=(r+a)/2,c=(s+n)/2,p=(a+o)/2,f=(u+c)/2,x=(d+p)/2,g=n-i,m=o-r,_=Math.abs((s-n)*m-(a-o)*g);if(_>11920929e-14){if(_*_<=l*(g*g+m*m))return void e.push(f,x)}else if((g=f-(i+n)/2)*g+(m=x-(r+o)/2)*m<=l)return void e.push(f,x);t(e,i,r,u,d,f,x,l,h+1),t(e,f,x,c,p,n,o,l,h+1)}(f=t,l,h,u,d,c,p,x,0),f.push(c,p),t}function T(t,e,i,r,s,a,n,o){let l=Math.abs(s-a);!n&&s>a?l=2*Math.PI-l:n&&a>s&&(l=2*Math.PI-l),o||(o=Math.max(6,Math.floor(6*Math.pow(r,1/3)*(l/Math.PI))));let h=l/(o=Math.max(o,3)),u=s;h*=n?-1:1;for(let s=0;s<o+1;s++){let s=e+Math.cos(u)*r,a=i+Math.sin(u)*r;t.push(s,a),u+=h}}function S(t,e,i,r,s,a){let n=t[t.length-2],o=t[t.length-1]-i,l=n-e,h=s-i,u=r-e,d=Math.abs(o*u-l*h);if(d<1e-8||0===a){(t[t.length-2]!==e||t[t.length-1]!==i)&&t.push(e,i);return}let c=o*o+l*l,p=h*h+u*u,f=o*h+l*u,x=a*Math.sqrt(c)/d,g=a*Math.sqrt(p)/d,m=x*f/c,_=g*f/p,y=x*u+g*l,v=x*h+g*o,b=Math.atan2(o*(g+m)-v,l*(g+m)-y),S=Math.atan2(h*(x+_)-v,u*(x+_)-y);T(t,y+e,v+i,a,b,S,l*h>u*o)}t.s(["buildAdaptiveBezier",()=>v],19773),t.s(["buildAdaptiveQuadratic",()=>b],85066),t.s(["buildArc",()=>T],97894),t.s(["buildArcTo",()=>S],80097);let P=2*Math.PI,w={centerX:0,centerY:0,ang1:0,ang2:0},C=({x:t,y:e},i,r,s,a,n,o,l)=>{let h=s*(t*=i)-a*(e*=r),u=a*t+s*e;return l.x=h+n,l.y=u+o,l},M=(t,e,i,r)=>{let s=t*i+e*r;return s>1&&(s=1),s<-1&&(s=-1),(t*r-e*i<0?-1:1)*Math.acos(s)};function A(t,e,i,r,s,a,n,o=0,l=0,h=0){var u,d;let c,p,f,x,g,m,_,y,b,T,S;if(0===a||0===n)return;let k=Math.sin(o*P/360),B=Math.cos(o*P/360),F=B*(e-r)/2+k*(i-s)/2,R=-k*(e-r)/2+B*(i-s)/2;if(0===F&&0===R)return;let U=Math.pow(F,2)/Math.pow(a=Math.abs(a),2)+Math.pow(R,2)/Math.pow(n=Math.abs(n),2);U>1&&(a*=Math.sqrt(U),n*=Math.sqrt(U)),u=a,d=n,c=Math.pow(u,2),p=Math.pow(d,2),f=Math.pow(F,2),(g=c*p-c*(x=Math.pow(R,2))-p*f)<0&&(g=0),g/=c*x+p*f,m=(g=Math.sqrt(g)*(l===h?-1:1))*u/d*R,_=-(g*d)/u*F,T=M(1,0,y=(F-m)/u,b=(R-_)/d),S=M(y,b,(-F-m)/u,(-R-_)/d),0===h&&S>0&&(S-=P),1===h&&S<0&&(S+=P),w.centerX=B*m-k*_+(e+r)/2,w.centerY=k*m+B*_+(i+s)/2,w.ang1=T,w.ang2=S;let{ang1:G,ang2:E}=w,{centerX:z,centerY:I}=w,D=Math.abs(E)/(P/4);1e-7>Math.abs(1-D)&&(D=1);let O=Math.max(Math.ceil(D),1);E/=O;let L=t[t.length-2],W=t[t.length-1],V={x:0,y:0};for(let e=0;e<O;e++){let e=function(t,e){let i=-1.5707963267948966===e?-.551915024494:4/3*Math.tan(e/4),r=1.5707963267948966===e?.551915024494:i,s=Math.cos(t),a=Math.sin(t),n=Math.cos(t+e),o=Math.sin(t+e);return[{x:s-a*r,y:a+s*r},{x:n+o*r,y:o-n*r},{x:n,y:o}]}(G,E),{x:i,y:r}=C(e[0],a,n,B,k,z,I,V),{x:s,y:o}=C(e[1],a,n,B,k,z,I,V),{x:l,y:h}=C(e[2],a,n,B,k,z,I,V);v(t,L,W,i,r,s,o,l,h),L=l,W=h,G+=E}}function k(t,e,i){let r=(t,e)=>{let i=e.x-t.x,r=e.y-t.y,s=Math.sqrt(i*i+r*r);return{len:s,nx:i/s,ny:r/s}},s=(e,i)=>{0===e?t.moveTo(i.x,i.y):t.lineTo(i.x,i.y)},a=e[e.length-1];for(let n=0;n<e.length;n++){let o,l=e[n%e.length],h=l.radius??i;if(h<=0){s(n,l),a=l;continue}let u=e[(n+1)%e.length],d=r(l,a),c=r(l,u);if(d.len<1e-4||c.len<1e-4){s(n,l),a=l;continue}let p=Math.asin(d.nx*c.ny-d.ny*c.nx),f=1,x=!1;d.nx*c.nx- -(d.ny*c.ny)<0?p<0?p=Math.PI+p:(p=Math.PI-p,f=-1,x=!0):p>0&&(f=-1,x=!0);let g=p/2,m=Math.abs(Math.cos(g)*h/Math.sin(g));o=m>Math.min(d.len/2,c.len/2)?Math.abs((m=Math.min(d.len/2,c.len/2))*Math.sin(g)/Math.cos(g)):h;let _=l.x+c.nx*m+-c.ny*o*f,y=l.y+c.ny*m+c.nx*o*f,v=Math.atan2(d.ny,d.nx)+Math.PI/2*f,b=Math.atan2(c.ny,c.nx)-Math.PI/2*f;0===n&&t.moveTo(_+Math.cos(v)*o,y+Math.sin(v)*o),t.arc(_,y,o,v,b,x),a=l}}function B(t,e,i,r){let s=(t,e)=>Math.sqrt((t.x-e.x)**2+(t.y-e.y)**2),a=(t,e,i)=>({x:t.x+(e.x-t.x)*i,y:t.y+(e.y-t.y)*i}),n=e.length;for(let o=0;o<n;o++){let l,h,u=e[(o+1)%n],d=u.radius??i;if(d<=0){0===o?t.moveTo(u.x,u.y):t.lineTo(u.x,u.y);continue}let c=e[o],p=e[(o+2)%n],f=s(c,u);l=f<1e-4?u:a(u,c,Math.min(f/2,d)/f);let x=s(p,u);h=x<1e-4?u:a(u,p,Math.min(x/2,d)/x),0===o?t.moveTo(l.x,l.y):t.lineTo(l.x,l.y),t.quadraticCurveTo(u.x,u.y,h.x,h.y,r)}}t.s(["buildArcToSvg",()=>A],23940),t.s(["roundedShapeArc",()=>k,"roundedShapeQuadraticCurve",()=>B],16053);let F=new m.Rectangle;class R{constructor(t){this.shapePrimitives=[],this._currentPoly=null,this._bounds=new c.Bounds,this._graphicsPath2D=t,this.signed=t.checkForHoles}moveTo(t,e){return this.startPoly(t,e),this}lineTo(t,e){this._ensurePoly();let i=this._currentPoly.points,r=i[i.length-2],s=i[i.length-1];return(r!==t||s!==e)&&i.push(t,e),this}arc(t,e,i,r,s,a){return this._ensurePoly(!1),T(this._currentPoly.points,t,e,i,r,s,a),this}arcTo(t,e,i,r,s){return this._ensurePoly(),S(this._currentPoly.points,t,e,i,r,s),this}arcToSvg(t,e,i,r,s,a,n){return A(this._currentPoly.points,this._currentPoly.lastX,this._currentPoly.lastY,a,n,t,e,i,r,s),this}bezierCurveTo(t,e,i,r,s,a,n){this._ensurePoly();let o=this._currentPoly;return v(this._currentPoly.points,o.lastX,o.lastY,t,e,i,r,s,a,n),this}quadraticCurveTo(t,e,i,r,s){this._ensurePoly();let a=this._currentPoly;return b(this._currentPoly.points,a.lastX,a.lastY,t,e,i,r,s),this}closePath(){return this.endPoly(!0),this}addPath(t,e){this.endPoly(),e&&!e.isIdentity()&&(t=t.clone(!0)).transform(e);let i=this.shapePrimitives,r=i.length;for(let e=0;e<t.instructions.length;e++){let i=t.instructions[e];this[i.action](...i.data)}if(t.checkForHoles&&i.length-r>1){let t=null;for(let e=r;e<i.length;e++){let r=i[e];if("polygon"===r.shape.type){let s=r.shape,a=t?.shape;a&&a.containsPolygon(s)?(t.holes||(t.holes=[]),t.holes.push(r),i.copyWithin(e,e+1),i.length--,e--):t=r}}}return this}finish(t=!1){this.endPoly(t)}rect(t,e,i,r,s){return this.drawShape(new m.Rectangle(t,e,i,r),s),this}circle(t,e,i,r){return this.drawShape(new f.Circle(t,e,i),r),this}poly(t,e,i){let r=new g.Polygon(t);return r.closePath=e,this.drawShape(r,i),this}regularPoly(t,e,i,r,s=0,a){let n=-1*Math.PI/2+s,o=2*Math.PI/(r=Math.max(0|r,3)),l=[];for(let s=0;s<r;s++){let r=n-s*o;l.push(t+i*Math.cos(r),e+i*Math.sin(r))}return this.poly(l,!0,a),this}roundPoly(t,e,i,r,s,a=0,n){if(r=Math.max(0|r,3),s<=0)return this.regularPoly(t,e,i,r,a);s=Math.min(s,i*Math.sin(Math.PI/r)-.001);let o=-1*Math.PI/2+a,l=2*Math.PI/r,h=(r-2)*Math.PI/r/2;for(let a=0;a<r;a++){let r=a*l+o,u=t+i*Math.cos(r),d=e+i*Math.sin(r),c=r+Math.PI+h,p=r-Math.PI-h,f=u+s*Math.cos(c),x=d+s*Math.sin(c),g=u+s*Math.cos(p),m=d+s*Math.sin(p);0===a?this.moveTo(f,x):this.lineTo(f,x),this.quadraticCurveTo(u,d,g,m,n)}return this.closePath()}roundShape(t,e,i=!1,r){return t.length<3?this:(i?B(this,t,e,r):k(this,t,e),this.closePath())}filletRect(t,e,i,r,s){if(0===s)return this.rect(t,e,i,r);let a=Math.min(i,r)/2,n=Math.min(a,Math.max(-a,s)),o=t+i,l=e+r,h=n<0?-n:0,u=Math.abs(n);return this.moveTo(t,e+u).arcTo(t+h,e+h,t+u,e,u).lineTo(o-u,e).arcTo(o-h,e+h,o,e+u,u).lineTo(o,l-u).arcTo(o-h,l-h,t+i-u,l,u).lineTo(t+u,l).arcTo(t+h,l-h,t,l-u,u).closePath()}chamferRect(t,e,i,r,s,a){if(s<=0)return this.rect(t,e,i,r);let n=Math.min(s,Math.min(i,r)/2),o=t+i,l=e+r,h=[t+n,e,o-n,e,o,e+n,o,l-n,o-n,l,t+n,l,t,l-n,t,e+n];for(let t=h.length-1;t>=2;t-=2)h[t]===h[t-2]&&h[t-1]===h[t-3]&&h.splice(t-1,2);return this.poly(h,!0,a)}ellipse(t,e,i,r,s){return this.drawShape(new x.Ellipse(t,e,i,r),s),this}roundRect(t,e,i,r,s,a){return this.drawShape(new _.RoundedRectangle(t,e,i,r,s),a),this}drawShape(t,e){return this.endPoly(),this.shapePrimitives.push({shape:t,transform:e}),this}startPoly(t,e){let i=this._currentPoly;return i&&this.endPoly(),(i=new g.Polygon).points.push(t,e),this._currentPoly=i,this}endPoly(t=!1){let e=this._currentPoly;return e&&e.points.length>2&&(e.closePath=t,this.shapePrimitives.push({shape:e})),this._currentPoly=null,this}_ensurePoly(t=!0){if(!this._currentPoly&&(this._currentPoly=new g.Polygon,t)){let t=this.shapePrimitives[this.shapePrimitives.length-1];if(t){let e=t.shape.x,i=t.shape.y;if(t.transform&&!t.transform.isIdentity()){let r=t.transform,s=e;e=r.a*e+r.c*i+r.tx,i=r.b*s+r.d*i+r.ty}this._currentPoly.points.push(e,i)}else this._currentPoly.points.push(0,0)}}buildPath(){let t=this._graphicsPath2D;this.shapePrimitives.length=0,this._currentPoly=null;for(let e=0;e<t.instructions.length;e++){let i=t.instructions[e];this[i.action](...i.data)}this.finish()}get bounds(){let t=this._bounds;t.clear();let e=this.shapePrimitives;for(let i=0;i<e.length;i++){let r=e[i],s=r.shape.getBounds(F);r.transform?t.addRect(s,r.transform):t.addRect(s)}return t}}t.s(["ShapePath",()=>R],18626);class U{constructor(t,e=!1){this.instructions=[],this.uid=(0,r.uid)("graphicsPath"),this._dirty=!0,this.checkForHoles=e,"string"==typeof t?(0,p.parseSVGPath)(t,this):this.instructions=t?.slice()??[]}get shapePath(){return this._shapePath||(this._shapePath=new R(this)),this._dirty&&(this._dirty=!1,this._shapePath.buildPath()),this._shapePath}addPath(t,e){return t=t.clone(),this.instructions.push({action:"addPath",data:[t,e]}),this._dirty=!0,this}arc(...t){return this.instructions.push({action:"arc",data:t}),this._dirty=!0,this}arcTo(...t){return this.instructions.push({action:"arcTo",data:t}),this._dirty=!0,this}arcToSvg(...t){return this.instructions.push({action:"arcToSvg",data:t}),this._dirty=!0,this}bezierCurveTo(...t){return this.instructions.push({action:"bezierCurveTo",data:t}),this._dirty=!0,this}bezierCurveToShort(t,e,i,r,s){let a=this.instructions[this.instructions.length-1],n=this.getLastPoint(u.Point.shared),o=0,l=0;if(a&&"bezierCurveTo"===a.action){o=a.data[2],l=a.data[3];let t=n.x,e=n.y;o=t+(t-o),l=e+(e-l)}else o=n.x,l=n.y;return this.instructions.push({action:"bezierCurveTo",data:[o,l,t,e,i,r,s]}),this._dirty=!0,this}closePath(){return this.instructions.push({action:"closePath",data:[]}),this._dirty=!0,this}ellipse(...t){return this.instructions.push({action:"ellipse",data:t}),this._dirty=!0,this}lineTo(...t){return this.instructions.push({action:"lineTo",data:t}),this._dirty=!0,this}moveTo(...t){return this.instructions.push({action:"moveTo",data:t}),this}quadraticCurveTo(...t){return this.instructions.push({action:"quadraticCurveTo",data:t}),this._dirty=!0,this}quadraticCurveToShort(t,e,i){let r=this.instructions[this.instructions.length-1],s=this.getLastPoint(u.Point.shared),a=0,n=0;if(r&&"quadraticCurveTo"===r.action){a=r.data[0],n=r.data[1];let t=s.x,e=s.y;a=t+(t-a),n=e+(e-n)}else a=s.x,n=s.y;return this.instructions.push({action:"quadraticCurveTo",data:[a,n,t,e,i]}),this._dirty=!0,this}rect(t,e,i,r,s){return this.instructions.push({action:"rect",data:[t,e,i,r,s]}),this._dirty=!0,this}circle(t,e,i,r){return this.instructions.push({action:"circle",data:[t,e,i,r]}),this._dirty=!0,this}roundRect(...t){return this.instructions.push({action:"roundRect",data:t}),this._dirty=!0,this}poly(...t){return this.instructions.push({action:"poly",data:t}),this._dirty=!0,this}regularPoly(...t){return this.instructions.push({action:"regularPoly",data:t}),this._dirty=!0,this}roundPoly(...t){return this.instructions.push({action:"roundPoly",data:t}),this._dirty=!0,this}roundShape(...t){return this.instructions.push({action:"roundShape",data:t}),this._dirty=!0,this}filletRect(...t){return this.instructions.push({action:"filletRect",data:t}),this._dirty=!0,this}chamferRect(...t){return this.instructions.push({action:"chamferRect",data:t}),this._dirty=!0,this}star(t,e,i,r,s,a,n){s||(s=r/2);let o=-1*Math.PI/2+a,l=2*i,h=2*Math.PI/l,u=[];for(let i=0;i<l;i++){let a=i%2?s:r,n=i*h+o;u.push(t+a*Math.cos(n),e+a*Math.sin(n))}return this.poly(u,!0,n),this}clone(t=!1){let e=new U;if(e.checkForHoles=this.checkForHoles,t)for(let t=0;t<this.instructions.length;t++){let i=this.instructions[t];e.instructions.push({action:i.action,data:i.data.slice()})}else e.instructions=this.instructions.slice();return e}clear(){return this.instructions.length=0,this._dirty=!0,this}transform(t){if(t.isIdentity())return this;let e=t.a,i=t.b,r=t.c,s=t.d,n=t.tx,o=t.ty,l=0,h=0,u=0,d=0,c=0,p=0,f=0,x=0;for(let g=0;g<this.instructions.length;g++){let m=this.instructions[g],_=m.data;switch(m.action){case"moveTo":case"lineTo":l=_[0],h=_[1],_[0]=e*l+r*h+n,_[1]=i*l+s*h+o;break;case"bezierCurveTo":u=_[0],d=_[1],c=_[2],p=_[3],l=_[4],h=_[5],_[0]=e*u+r*d+n,_[1]=i*u+s*d+o,_[2]=e*c+r*p+n,_[3]=i*c+s*p+o,_[4]=e*l+r*h+n,_[5]=i*l+s*h+o;break;case"quadraticCurveTo":u=_[0],d=_[1],l=_[2],h=_[3],_[0]=e*u+r*d+n,_[1]=i*u+s*d+o,_[2]=e*l+r*h+n,_[3]=i*l+s*h+o;break;case"arcToSvg":l=_[5],h=_[6],f=_[0],x=_[1],_[0]=e*f+r*x,_[1]=i*f+s*x,_[5]=e*l+r*h+n,_[6]=i*l+s*h+o;break;case"circle":_[4]=G(_[3],t);break;case"rect":_[4]=G(_[4],t);break;case"ellipse":_[8]=G(_[8],t);break;case"roundRect":_[5]=G(_[5],t);break;case"addPath":_[0].transform(t);break;case"poly":_[2]=G(_[2],t);break;default:(0,a.warn)("unknown transform action",m.action)}}return this._dirty=!0,this}get bounds(){return this.shapePath.bounds}getLastPoint(t){let e=this.instructions.length-1,i=this.instructions[e];if(!i)return t.x=0,t.y=0,t;for(;"closePath"===i.action;){if(--e<0)return t.x=0,t.y=0,t;i=this.instructions[e]}switch(i.action){case"moveTo":case"lineTo":t.x=i.data[0],t.y=i.data[1];break;case"quadraticCurveTo":t.x=i.data[2],t.y=i.data[3];break;case"bezierCurveTo":t.x=i.data[4],t.y=i.data[5];break;case"arc":case"arcToSvg":t.x=i.data[5],t.y=i.data[6];break;case"addPath":i.data[0].getLastPoint(t)}return t}}function G(t,e){return t?t.prepend(e):e.clone()}function E(t,e,i){let r=t.getAttribute(e);return r?Number(r):i}function z(t,e){let r=t.querySelectorAll("defs");for(let t=0;t<r.length;t++){let s=r[t];for(let t=0;t<s.children.length;t++){let r=s.children[t];switch(r.nodeName.toLowerCase()){case"lineargradient":e.defs[r.id]=function(t){let e=E(t,"x1",0),r=E(t,"y1",0),s=E(t,"x2",1),a=E(t,"y2",0),o=t.getAttribute("gradientUnits")||"objectBoundingBox",l=new n.FillGradient(e,r,s,a,"objectBoundingBox"===o?"local":"global");for(let e=0;e<t.children.length;e++){let r=t.children[e],s=E(r,"offset",0),a=i.Color.shared.setValue(r.getAttribute("stop-color")).toNumber();l.addColorStop(s,a)}return l}(r);break;case"radialgradient":e.defs[r.id]=((0,a.warn)("[SVG Parser] Radial gradients are not yet supported"),new n.FillGradient(0,0,1,0))}}}}function I(t){let e=t.match(/url\s*\(\s*['"]?\s*#([^'"\s)]+)\s*['"]?\s*\)/i);return e?e[1]:""}t.s(["GraphicsPath",()=>U],44252),t.s(["parseSVGFloatAttribute",()=>E],87371),t.s(["parseSVGDefinitions",()=>z],77755),t.s(["extractSvgUrlId",()=>I],74184);let D={fill:{type:"paint",default:0},"fill-opacity":{type:"number",default:1},stroke:{type:"paint",default:0},"stroke-width":{type:"number",default:1},"stroke-opacity":{type:"number",default:1},"stroke-linecap":{type:"string",default:"butt"},"stroke-linejoin":{type:"string",default:"miter"},"stroke-miterlimit":{type:"number",default:10},"stroke-dasharray":{type:"string",default:"none"},"stroke-dashoffset":{type:"number",default:0},opacity:{type:"number",default:1}};function O(t,e){let i=t.getAttribute("style"),r={},s={},a={strokeStyle:r,fillStyle:s,useFill:!1,useStroke:!1};for(let i in D){let r=t.getAttribute(i);r&&L(e,a,i,r.trim())}if(i){let t=i.split(";");for(let i=0;i<t.length;i++){let[r,s]=t[i].trim().split(":");D[r]&&L(e,a,r,s.trim())}}return{strokeStyle:a.useStroke?r:null,fillStyle:a.useFill?s:null,useFill:a.useFill,useStroke:a.useStroke}}function L(t,e,r,s){switch(r){case"stroke":if("none"!==s){if(s.startsWith("url(")){let i=I(s);e.strokeStyle.fill=t.defs[i]}else e.strokeStyle.color=i.Color.shared.setValue(s).toNumber();e.useStroke=!0}break;case"stroke-width":e.strokeStyle.width=Number(s);break;case"fill":if("none"!==s){if(s.startsWith("url(")){let i=I(s);e.fillStyle.fill=t.defs[i]}else e.fillStyle.color=i.Color.shared.setValue(s).toNumber();e.useFill=!0}break;case"fill-opacity":e.fillStyle.alpha=Number(s);break;case"stroke-opacity":e.strokeStyle.alpha=Number(s);break;case"opacity":e.fillStyle.alpha=Number(s),e.strokeStyle.alpha=Number(s)}}function W(t){if(t.length<=2)return!0;let e=t.map(t=>t.area).sort((t,e)=>e-t),[i,r]=e,s=e[e.length-1];return!(i/r>3)||!(r/s<2)}function V(t,e=0){let i=t.instructions[e];if(!i||"fill"!==i.action)throw Error(`Expected fill instruction at index ${e}, got ${i?.action||"undefined"}`);return i.data}function H(t){return t.split(/(?=[Mm])/).filter(t=>t.trim().length>0)}function $(t){let e=t.match(/[-+]?[0-9]*\.?[0-9]+/g);if(!e||e.length<4)return 0;let i=e.map(Number),r=[],s=[];for(let t=0;t<i.length;t+=2)t+1<i.length&&(r.push(i[t]),s.push(i[t+1]));if(0===r.length||0===s.length)return 0;let a=Math.min(...r),n=Math.min(...s);return(Math.max(...r)-a)*(Math.max(...s)-n)}function N(t,e){for(let i of new U(t,!1).instructions)e.instructions.push(i)}function q(t,e){if("string"==typeof t){let e=document.createElement("div");e.innerHTML=t.trim(),t=e.querySelector("svg")}let i={context:e,defs:{},path:new U};z(t,i);let r=t.children,{fillStyle:s,strokeStyle:n}=O(t,i);for(let t=0;t<r.length;t++){let e=r[t];"defs"!==e.nodeName.toLowerCase()&&function t(e,i,r,s){let n,o,l,h,u,d,c,p,f,x,g,m,_,y,v,b,T=e.children,{fillStyle:S,strokeStyle:P}=O(e,i);S&&r?r={...r,...S}:S&&(r=S),P&&s?s={...s,...P}:P&&(s=P);let w=!r&&!s;switch(w&&(r={color:0}),e.nodeName.toLowerCase()){case"path":{_=e.getAttribute("d");let t=e.getAttribute("fill-rule"),a=H(_),n=a.length>1;if("evenodd"===t&&n){let t=a.map(t=>({path:t,area:$(t)}));if(t.sort((t,e)=>e.area-t.area),a.length>3||!W(t))for(let e=0;e<t.length;e++){let a=t[e],n=0===e;i.context.beginPath();let o=new U(void 0,!0);N(a.path,o),i.context.path(o),n?(r&&i.context.fill(r),s&&i.context.stroke(s)):i.context.cut()}else for(let e=0;e<t.length;e++){let a=t[e],n=e%2==1;i.context.beginPath();let o=new U(void 0,!0);N(a.path,o),i.context.path(o),n?i.context.cut():(r&&i.context.fill(r),s&&i.context.stroke(s))}}else y=new U(_,!t||"evenodd"===t),i.context.path(y),r&&i.context.fill(r),s&&i.context.stroke(s);break}case"circle":c=E(e,"cx",0),p=E(e,"cy",0),f=E(e,"r",0),i.context.ellipse(c,p,f,f),r&&i.context.fill(r),s&&i.context.stroke(s);break;case"rect":n=E(e,"x",0),o=E(e,"y",0),v=E(e,"width",0),b=E(e,"height",0),x=E(e,"rx",0),g=E(e,"ry",0),x||g?i.context.roundRect(n,o,v,b,x||g):i.context.rect(n,o,v,b),r&&i.context.fill(r),s&&i.context.stroke(s);break;case"ellipse":c=E(e,"cx",0),p=E(e,"cy",0),x=E(e,"rx",0),g=E(e,"ry",0),i.context.beginPath(),i.context.ellipse(c,p,x,g),r&&i.context.fill(r),s&&i.context.stroke(s);break;case"line":l=E(e,"x1",0),h=E(e,"y1",0),u=E(e,"x2",0),d=E(e,"y2",0),i.context.beginPath(),i.context.moveTo(l,h),i.context.lineTo(u,d),s&&i.context.stroke(s);break;case"polygon":m=e.getAttribute("points").match(/-?\d+/g).map(t=>parseInt(t,10)),i.context.poly(m,!0),r&&i.context.fill(r),s&&i.context.stroke(s);break;case"polyline":m=e.getAttribute("points").match(/-?\d+/g).map(t=>parseInt(t,10)),i.context.poly(m,!1),s&&i.context.stroke(s);break;case"g":case"svg":break;default:(0,a.warn)(`[SVG parser] <${e.nodeName}> elements unsupported`)}w&&(r=null);for(let e=0;e<T.length;e++)t(T[e],i,r,s)}(e,i,s,n)}return e}function j(t){return t instanceof o.FillPattern}function Y(t){return t instanceof n.FillGradient}function X(t,e,i){return t.fill=e,t.color=0xffffff,t.texture=e.texture,t.matrix=e.transform,{...i,...t}}function K(t,e,i){return e.buildGradient(),t.fill=e,t.color=0xffffff,t.texture=e.texture,t.matrix=e.transform,t.textureSpace=e.textureSpace,{...i,...t}}function Z(t,e){let r,s;if(null==t)return null;let a={};if(i.Color.isColorLike(t)){let r;return a.color=(r=i.Color.shared.setValue(t??0)).toNumber(),a.alpha=1===r.alpha?e.alpha:r.alpha,a.texture=d.Texture.WHITE,{...e,...a}}if(t instanceof d.Texture)return a.texture=t,{...e,...a};if(j(t))return X(a,t,e);if(Y(t))return K(a,t,e);else if(t.fill&&j(t.fill))return X(t,t.fill,e);else if(t.fill&&Y(t.fill))return K(t,t.fill,e);return r={...e,...t},s=i.Color.shared.setValue(r.color),r.alpha*=s.alpha,r.color=s.toNumber(),r}function Q(t,e){let{width:i,alignment:r,miterLimit:s,cap:a,join:n,pixelLine:o,...l}=e,h=Z(t,l);return h?{width:i,alignment:r,miterLimit:s,cap:a,join:n,pixelLine:o,...h}:null}t.s(["parseSVGStyle",()=>O,"styleAttributes",()=>D],86159),t.s(["checkForNestedPattern",()=>W,"getFillInstructionData",()=>V],67452),t.s(["appendSVGPath",()=>N,"calculatePathArea",()=>$,"extractSubpaths",()=>H],93326),t.s(["SVGParser",()=>q],91166),t.s(["toFillStyle",()=>Z,"toStrokeStyle",()=>Q],86230);let J=new u.Point,tt=new h.Matrix,te=class t extends l.default{constructor(){super(...arguments),this._gpuData=Object.create(null),this.autoGarbageCollect=!0,this._gcLastUsed=-1,this.uid=(0,r.uid)("graphicsContext"),this.dirty=!0,this.batchMode="auto",this.instructions=[],this.destroyed=!1,this._activePath=new U,this._transform=new h.Matrix,this._fillStyle={...t.defaultFillStyle},this._strokeStyle={...t.defaultStrokeStyle},this._stateStack=[],this._tick=0,this._bounds=new c.Bounds,this._boundsDirty=!0}clone(){let e=new t;return e.batchMode=this.batchMode,e.instructions=this.instructions.slice(),e._activePath=this._activePath.clone(),e._transform=this._transform.clone(),e._fillStyle={...this._fillStyle},e._strokeStyle={...this._strokeStyle},e._stateStack=this._stateStack.slice(),e._bounds=this._bounds.clone(),e._boundsDirty=!0,e}get fillStyle(){return this._fillStyle}set fillStyle(e){this._fillStyle=Z(e,t.defaultFillStyle)}get strokeStyle(){return this._strokeStyle}set strokeStyle(e){this._strokeStyle=Q(e,t.defaultStrokeStyle)}setFillStyle(e){return this._fillStyle=Z(e,t.defaultFillStyle),this}setStrokeStyle(e){return this._strokeStyle=Z(e,t.defaultStrokeStyle),this}texture(t,e,r,s,a,n){return this.instructions.push({action:"texture",data:{image:t,dx:r||0,dy:s||0,dw:a||t.frame.width,dh:n||t.frame.height,transform:this._transform.clone(),alpha:this._fillStyle.alpha,style:e?i.Color.shared.setValue(e).toNumber():0xffffff}}),this.onUpdate(),this}beginPath(){return this._activePath=new U,this}fill(e,i){let r,a=this.instructions[this.instructions.length-1];return(r=0===this._tick&&a?.action==="stroke"?a.data.path:this._activePath.clone())&&(null!=e&&(void 0!==i&&"number"==typeof e&&((0,s.deprecation)(s.v8_0_0,"GraphicsContext.fill(color, alpha) is deprecated, use GraphicsContext.fill({ color, alpha }) instead"),e={color:e,alpha:i}),this._fillStyle=Z(e,t.defaultFillStyle)),this.instructions.push({action:"fill",data:{style:this.fillStyle,path:r}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0),this}_initNextPathLocation(){let{x:t,y:e}=this._activePath.getLastPoint(u.Point.shared);this._activePath.clear(),this._activePath.moveTo(t,e)}stroke(e){let i,r=this.instructions[this.instructions.length-1];return(i=0===this._tick&&r?.action==="fill"?r.data.path:this._activePath.clone())&&(null!=e&&(this._strokeStyle=Q(e,t.defaultStrokeStyle)),this.instructions.push({action:"stroke",data:{style:this.strokeStyle,path:i}}),this.onUpdate(),this._initNextPathLocation(),this._tick=0),this}cut(){for(let t=0;t<2;t++){let e=this.instructions[this.instructions.length-1-t],i=this._activePath.clone();if(e&&("stroke"===e.action||"fill"===e.action))if(e.data.hole)e.data.hole.addPath(i);else{e.data.hole=i;break}}return this._initNextPathLocation(),this}arc(t,e,i,r,s,a){this._tick++;let n=this._transform;return this._activePath.arc(n.a*t+n.c*e+n.tx,n.b*t+n.d*e+n.ty,i,r,s,a),this}arcTo(t,e,i,r,s){this._tick++;let a=this._transform;return this._activePath.arcTo(a.a*t+a.c*e+a.tx,a.b*t+a.d*e+a.ty,a.a*i+a.c*r+a.tx,a.b*i+a.d*r+a.ty,s),this}arcToSvg(t,e,i,r,s,a,n){this._tick++;let o=this._transform;return this._activePath.arcToSvg(t,e,i,r,s,o.a*a+o.c*n+o.tx,o.b*a+o.d*n+o.ty),this}bezierCurveTo(t,e,i,r,s,a,n){this._tick++;let o=this._transform;return this._activePath.bezierCurveTo(o.a*t+o.c*e+o.tx,o.b*t+o.d*e+o.ty,o.a*i+o.c*r+o.tx,o.b*i+o.d*r+o.ty,o.a*s+o.c*a+o.tx,o.b*s+o.d*a+o.ty,n),this}closePath(){return this._tick++,this._activePath?.closePath(),this}ellipse(t,e,i,r){return this._tick++,this._activePath.ellipse(t,e,i,r,this._transform.clone()),this}circle(t,e,i){return this._tick++,this._activePath.circle(t,e,i,this._transform.clone()),this}path(t){return this._tick++,this._activePath.addPath(t,this._transform.clone()),this}lineTo(t,e){this._tick++;let i=this._transform;return this._activePath.lineTo(i.a*t+i.c*e+i.tx,i.b*t+i.d*e+i.ty),this}moveTo(t,e){this._tick++;let i=this._transform,r=this._activePath.instructions,s=i.a*t+i.c*e+i.tx,a=i.b*t+i.d*e+i.ty;return 1===r.length&&"moveTo"===r[0].action?(r[0].data[0]=s,r[0].data[1]=a):this._activePath.moveTo(s,a),this}quadraticCurveTo(t,e,i,r,s){this._tick++;let a=this._transform;return this._activePath.quadraticCurveTo(a.a*t+a.c*e+a.tx,a.b*t+a.d*e+a.ty,a.a*i+a.c*r+a.tx,a.b*i+a.d*r+a.ty,s),this}rect(t,e,i,r){return this._tick++,this._activePath.rect(t,e,i,r,this._transform.clone()),this}roundRect(t,e,i,r,s){return this._tick++,this._activePath.roundRect(t,e,i,r,s,this._transform.clone()),this}poly(t,e){return this._tick++,this._activePath.poly(t,e,this._transform.clone()),this}regularPoly(t,e,i,r,s=0,a){return this._tick++,this._activePath.regularPoly(t,e,i,r,s,a),this}roundPoly(t,e,i,r,s,a){return this._tick++,this._activePath.roundPoly(t,e,i,r,s,a),this}roundShape(t,e,i,r){return this._tick++,this._activePath.roundShape(t,e,i,r),this}filletRect(t,e,i,r,s){return this._tick++,this._activePath.filletRect(t,e,i,r,s),this}chamferRect(t,e,i,r,s,a){return this._tick++,this._activePath.chamferRect(t,e,i,r,s,a),this}star(t,e,i,r,s=0,a=0){return this._tick++,this._activePath.star(t,e,i,r,s,a,this._transform.clone()),this}svg(t){return this._tick++,q(t,this),this}restore(){let t=this._stateStack.pop();return t&&(this._transform=t.transform,this._fillStyle=t.fillStyle,this._strokeStyle=t.strokeStyle),this}save(){return this._stateStack.push({transform:this._transform.clone(),fillStyle:{...this._fillStyle},strokeStyle:{...this._strokeStyle}}),this}getTransform(){return this._transform}resetTransform(){return this._transform.identity(),this}rotate(t){return this._transform.rotate(t),this}scale(t,e=t){return this._transform.scale(t,e),this}setTransform(t,e,i,r,s,a){return t instanceof h.Matrix?this._transform.set(t.a,t.b,t.c,t.d,t.tx,t.ty):this._transform.set(t,e,i,r,s,a),this}transform(t,e,i,r,s,a){return t instanceof h.Matrix?this._transform.append(t):(tt.set(t,e,i,r,s,a),this._transform.append(tt)),this}translate(t,e=t){return this._transform.translate(t,e),this}clear(){return this._activePath.clear(),this.instructions.length=0,this.resetTransform(),this.onUpdate(),this}onUpdate(){this._boundsDirty=!0,this.dirty||(this.emit("update",this,16),this.dirty=!0)}get bounds(){if(!this._boundsDirty)return this._bounds;this._boundsDirty=!1;let t=this._bounds;t.clear();for(let e=0;e<this.instructions.length;e++){let i=this.instructions[e],r=i.action;if("fill"===r){let e=i.data;t.addBounds(e.path.bounds)}else if("texture"===r){let e=i.data;t.addFrame(e.dx,e.dy,e.dx+e.dw,e.dy+e.dh,e.transform)}if("stroke"===r){let e=i.data,r=e.style.alignment,s=e.style.width*(1-r),a=e.path.bounds;t.addFrame(a.minX-s,a.minY-s,a.maxX+s,a.maxY+s)}}return t}containsPoint(t){if(!this.bounds.containsPoint(t.x,t.y))return!1;let e=this.instructions,i=!1;for(let r=0;r<e.length;r++){let s=e[r],a=s.data,n=a.path;if(!s.action||!n)continue;let o=a.style,l=n.shapePath.shapePrimitives;for(let e=0;e<l.length;e++){let r=l[e].shape;if(!o||!r)continue;let n=l[e].transform,h=n?n.applyInverse(t,J):t;i="fill"===s.action?r.contains(h.x,h.y):r.strokeContains(h.x,h.y,o.width,o.alignment);let u=a.hole;if(u){let t=u.shapePath?.shapePrimitives;if(t)for(let e=0;e<t.length;e++)t[e].shape.contains(h.x,h.y)&&(i=!1)}if(i)return!0}}return i}unload(){for(let t in this.emit("unload",this),this._gpuData)this._gpuData[t]?.destroy();this._gpuData=Object.create(null)}destroy(t=!1){if(!this.destroyed){if(this.destroyed=!0,this._stateStack.length=0,this._transform=null,this.unload(),this.emit("destroy",this),this.removeAllListeners(),"boolean"==typeof t?t:t?.texture){let e="boolean"==typeof t?t:t?.textureSource;this._fillStyle.texture&&(this._fillStyle.fill&&"uid"in this._fillStyle.fill?this._fillStyle.fill.destroy():this._fillStyle.texture.destroy(e)),this._strokeStyle.texture&&(this._strokeStyle.fill&&"uid"in this._strokeStyle.fill?this._strokeStyle.fill.destroy():this._strokeStyle.texture.destroy(e))}this._fillStyle=null,this._strokeStyle=null,this.instructions=null,this._activePath=null,this._bounds=null,this._stateStack=null,this.customShader=null,this._transform=null}}};te.defaultFillStyle={color:0xffffff,alpha:1,texture:d.Texture.WHITE,matrix:null,fill:null,textureSpace:"local"},te.defaultStrokeStyle={width:1,color:0xffffff,alpha:1,alignment:.5,miterLimit:10,cap:"butt",join:"miter",texture:d.Texture.WHITE,matrix:null,fill:null,textureSpace:"local",pixelLine:!1},t.s(["GraphicsContext",()=>te],20446);let ti=class t extends e.default{constructor(e={}){super(),this.uid=(0,r.uid)("textStyle"),this._tick=0,function(t){if("boolean"==typeof t.dropShadow&&t.dropShadow){let e=ti.defaultDropShadow;t.dropShadow={alpha:t.dropShadowAlpha??e.alpha,angle:t.dropShadowAngle??e.angle,blur:t.dropShadowBlur??e.blur,color:t.dropShadowColor??e.color,distance:t.dropShadowDistance??e.distance}}if(void 0!==t.strokeThickness){(0,s.deprecation)(s.v8_0_0,"strokeThickness is now a part of stroke");let e=t.stroke,r={};if(i.Color.isColorLike(e))r.color=e;else if(e instanceof n.FillGradient||e instanceof o.FillPattern)r.fill=e;else if(Object.hasOwnProperty.call(e,"color")||Object.hasOwnProperty.call(e,"fill"))r=e;else throw Error("Invalid stroke value.");t.stroke={...r,width:t.strokeThickness}}if(Array.isArray(t.fillGradientStops)){if((0,s.deprecation)(s.v8_0_0,"gradient fill is now a fill pattern: `new FillGradient(...)`"),!Array.isArray(t.fill)||0===t.fill.length)throw Error("Invalid fill value. Expected an array of colors for gradient fill.");t.fill.length!==t.fillGradientStops.length&&(0,a.warn)("The number of fill colors must match the number of fill gradient stops.");let e=new n.FillGradient({start:{x:0,y:0},end:{x:0,y:1},textureSpace:"local"}),r=t.fillGradientStops.slice(),o=t.fill.map(t=>i.Color.shared.setValue(t).toNumber());r.forEach((t,i)=>{e.addColorStop(t,o[i])}),t.fill={fill:e}}}(e);const l={...t.defaultTextStyle,...e};for(const t in l)this[t]=l[t];this.update(),this._tick=0}get align(){return this._align}set align(t){this._align!==t&&(this._align=t,this.update())}get breakWords(){return this._breakWords}set breakWords(t){this._breakWords!==t&&(this._breakWords=t,this.update())}get dropShadow(){return this._dropShadow}set dropShadow(e){this._dropShadow!==e&&(null!==e&&"object"==typeof e?this._dropShadow=this._createProxy({...t.defaultDropShadow,...e}):this._dropShadow=e?this._createProxy({...t.defaultDropShadow}):null,this.update())}get fontFamily(){return this._fontFamily}set fontFamily(t){this._fontFamily!==t&&(this._fontFamily=t,this.update())}get fontSize(){return this._fontSize}set fontSize(t){this._fontSize!==t&&("string"==typeof t?this._fontSize=parseInt(t,10):this._fontSize=t,this.update())}get fontStyle(){return this._fontStyle}set fontStyle(t){this._fontStyle!==t&&(this._fontStyle=t.toLowerCase(),this.update())}get fontVariant(){return this._fontVariant}set fontVariant(t){this._fontVariant!==t&&(this._fontVariant=t,this.update())}get fontWeight(){return this._fontWeight}set fontWeight(t){this._fontWeight!==t&&(this._fontWeight=t,this.update())}get leading(){return this._leading}set leading(t){this._leading!==t&&(this._leading=t,this.update())}get letterSpacing(){return this._letterSpacing}set letterSpacing(t){this._letterSpacing!==t&&(this._letterSpacing=t,this.update())}get lineHeight(){return this._lineHeight}set lineHeight(t){this._lineHeight!==t&&(this._lineHeight=t,this.update())}get padding(){return this._padding}set padding(t){this._padding!==t&&(this._padding=t,this.update())}get filters(){return this._filters}set filters(t){this._filters!==t&&(this._filters=Object.freeze(t),this.update())}get trim(){return this._trim}set trim(t){this._trim!==t&&(this._trim=t,this.update())}get textBaseline(){return this._textBaseline}set textBaseline(t){this._textBaseline!==t&&(this._textBaseline=t,this.update())}get whiteSpace(){return this._whiteSpace}set whiteSpace(t){this._whiteSpace!==t&&(this._whiteSpace=t,this.update())}get wordWrap(){return this._wordWrap}set wordWrap(t){this._wordWrap!==t&&(this._wordWrap=t,this.update())}get wordWrapWidth(){return this._wordWrapWidth}set wordWrapWidth(t){this._wordWrapWidth!==t&&(this._wordWrapWidth=t,this.update())}get fill(){return this._originalFill}set fill(t){t!==this._originalFill&&(this._originalFill=t,this._isFillStyle(t)&&(this._originalFill=this._createProxy({...te.defaultFillStyle,...t},()=>{this._fill=Z({...this._originalFill},te.defaultFillStyle)})),this._fill=Z(0===t?"black":t,te.defaultFillStyle),this.update())}get stroke(){return this._originalStroke}set stroke(t){t!==this._originalStroke&&(this._originalStroke=t,this._isFillStyle(t)&&(this._originalStroke=this._createProxy({...te.defaultStrokeStyle,...t},()=>{this._stroke=Q({...this._originalStroke},te.defaultStrokeStyle)})),this._stroke=Q(t,te.defaultStrokeStyle),this.update())}update(){this._tick++,this.emit("update",this)}reset(){let e=t.defaultTextStyle;for(let t in e)this[t]=e[t]}get styleKey(){return`${this.uid}-${this._tick}`}clone(){return new t({align:this.align,breakWords:this.breakWords,dropShadow:this._dropShadow?{...this._dropShadow}:null,fill:this._fill,fontFamily:this.fontFamily,fontSize:this.fontSize,fontStyle:this.fontStyle,fontVariant:this.fontVariant,fontWeight:this.fontWeight,leading:this.leading,letterSpacing:this.letterSpacing,lineHeight:this.lineHeight,padding:this.padding,stroke:this._stroke,textBaseline:this.textBaseline,whiteSpace:this.whiteSpace,wordWrap:this.wordWrap,wordWrapWidth:this.wordWrapWidth,filters:this._filters?[...this._filters]:void 0})}_getFinalPadding(){let t=0;if(this._filters)for(let e=0;e<this._filters.length;e++)t+=this._filters[e].padding;return Math.max(this._padding,t)}destroy(t=!1){if(this.removeAllListeners(),"boolean"==typeof t?t:t?.texture){let e="boolean"==typeof t?t:t?.textureSource;this._fill?.texture&&this._fill.texture.destroy(e),this._originalFill?.texture&&this._originalFill.texture.destroy(e),this._stroke?.texture&&this._stroke.texture.destroy(e),this._originalStroke?.texture&&this._originalStroke.texture.destroy(e)}this._fill=null,this._stroke=null,this.dropShadow=null,this._originalStroke=null,this._originalFill=null}_createProxy(t,e){return new Proxy(t,{set:(t,i,r)=>t[i]===r||(t[i]=r,e?.(i,r),this.update(),!0)})}_isFillStyle(t){return(t??null)!==null&&!(i.Color.isColorLike(t)||t instanceof n.FillGradient||t instanceof o.FillPattern)}};ti.defaultDropShadow={alpha:1,angle:Math.PI/6,blur:0,color:"black",distance:5},ti.defaultTextStyle={align:"left",breakWords:!1,dropShadow:null,fill:"black",fontFamily:"Arial",fontSize:26,fontStyle:"normal",fontVariant:"normal",fontWeight:"normal",leading:0,letterSpacing:0,lineHeight:0,padding:0,stroke:null,textBaseline:"alphabetic",trim:!1,whiteSpace:"pre",wordWrap:!1,wordWrapWidth:100},t.s(["TextStyle",()=>ti],73239)},70,t=>{"use strict";var e=t.i(57471),i=t.i(28959),r=t.i(31320),s=t.i(85830),a=t.i(81541),n=t.i(37836);function o(t,l,h,u=0){if(t.texture===r.Texture.WHITE&&!t.fill)return e.Color.shared.setValue(t.color).setAlpha(t.alpha??1).toHexa();if(t.fill){if(t.fill instanceof n.FillPattern){let e=t.fill,r=l.createPattern(e.texture.source.resource,"repeat"),s=e.transform.copyTo(i.Matrix.shared);return s.scale(e.texture.frame.width,e.texture.frame.height),r.setTransform(s),r}else if(t.fill instanceof a.FillGradient){let i,r=t.fill,s="linear"===r.type,a="local"===r.textureSpace,n=1,o=1;a&&h&&(n=h.width+u,o=h.height+u);let d=!1;if(s){let{start:t,end:e}=r;i=l.createLinearGradient(t.x*n,t.y*o,e.x*n,e.y*o),d=Math.abs(e.x-t.x)<Math.abs((e.y-t.y)*.1)}else{let{center:t,innerRadius:e,outerCenter:s,outerRadius:a}=r;i=l.createRadialGradient(t.x*n,t.y*o,e*n,s.x*n,s.y*o,a*n)}if(d&&a&&h){let t=h.lineHeight/o;for(let s=0;s<h.lines.length;s++){let a=(s*h.lineHeight+u/2)/o;r.colorStops.forEach(r=>{let s=a+r.offset*t;i.addColorStop(Math.floor(1e5*s)/1e5,e.Color.shared.setValue(r.color).toHex())})}}else r.colorStops.forEach(t=>{i.addColorStop(t.offset,e.Color.shared.setValue(t.color).toHex())});return i}}else{let e=l.createPattern(t.texture.source.resource,"repeat"),r=t.matrix.copyTo(i.Matrix.shared);return r.scale(t.texture.frame.width,t.texture.frame.height),e.setTransform(r),e}return(0,s.warn)("FillStyle not recognised",t),"red"}t.s(["getCanvasFillStyle",()=>o])},3248,44384,87772,68999,t=>{"use strict";var e=t.i(93005),i=t.i(92206),r=t.i(49864),s=t.i(85830),a=t.i(78266),n=t.i(73239),o=t.i(57471),l=t.i(63646),h=t.i(81735),u=t.i(16203),d=t.i(31320),c=t.i(4864),p=t.i(264),f=t.i(70),x=t.i(30524);let g=class t extends x.AbstractBitmapFont{constructor(e){super(),this.resolution=1,this.pages=[],this._padding=0,this._measureCache=Object.create(null),this._currentChars=[],this._currentX=0,this._currentY=0,this._currentMaxCharHeight=0,this._currentPageIndex=-1,this._skipKerning=!1;const i={...t.defaultOptions,...e};this._textureSize=i.textureSize,this._mipmap=i.mipmap;const r=i.style.clone();i.overrideFill&&(r._fill.color=0xffffff,r._fill.alpha=1,r._fill.texture=d.Texture.WHITE,r._fill.fill=null),this.applyFillAsTint=i.overrideFill;const s=r.fontSize;r.fontSize=this.baseMeasurementFontSize;const n=(0,p.fontStringFromTextStyle)(r);i.overrideSize?r._stroke&&(r._stroke.width*=this.baseRenderedFontSize/s):r.fontSize=this.baseRenderedFontSize=s,this._style=r,this._skipKerning=i.skipKerning??!1,this.resolution=i.resolution??1,this._padding=i.padding??4,i.textureStyle&&(this._textureStyle=i.textureStyle instanceof c.TextureStyle?i.textureStyle:new c.TextureStyle(i.textureStyle)),this.fontMetrics=a.CanvasTextMetrics.measureFont(n),this.lineHeight=r.lineHeight||this.fontMetrics.fontSize||r.fontSize}ensureCharacters(t){let e,i=a.CanvasTextMetrics.graphemeSegmenter(t).filter(t=>!this._currentChars.includes(t)).filter((t,e,i)=>i.indexOf(t)===e);if(!i.length)return;this._currentChars=[...this._currentChars,...i];let{canvas:r,context:s}=(e=-1===this._currentPageIndex?this._nextPage():this.pages[this._currentPageIndex]).canvasAndContext,n=e.texture.source,o=this._style,h=this._currentX,u=this._currentY,c=this._currentMaxCharHeight,p=this.baseRenderedFontSize/this.baseMeasurementFontSize,f=this._padding*p,x=!1,g=r.width/this.resolution,m=r.height/this.resolution;for(let t=0;t<i.length;t++){let e=i[t],_=a.CanvasTextMetrics.measureText(e,o,r,!1);_.lineHeight=_.height;let y=_.width*p,v=Math.ceil(("italic"===o.fontStyle?2:1)*y),b=_.height*p,T=v+2*f,S=b+2*f;if(x=!1,"\n"!==e&&"\r"!==e&&"	"!==e&&" "!==e&&(x=!0,c=Math.ceil(Math.max(S,c))),h+T>g&&(h=0,(u+=c)+(c=S)>m)){n.update();let t=this._nextPage();r=t.canvasAndContext.canvas,s=t.canvasAndContext.context,n=t.texture.source,h=0,u=0,c=0}let P=y/p-(o.dropShadow?.distance??0)-(o._stroke?.width??0);if(this.chars[e]={id:e.codePointAt(0),xOffset:-this._padding,yOffset:-this._padding,xAdvance:P,kerning:{}},x){this._drawGlyph(s,_,h+f,u+f,p,o);let t=n.width*p,i=n.height*p,r=new l.Rectangle(h/t*n.width,u/i*n.height,T/t*n.width,S/i*n.height);this.chars[e].texture=new d.Texture({source:n,frame:r}),h+=Math.ceil(T)}}n.update(),this._currentX=h,this._currentY=u,this._currentMaxCharHeight=c,this._skipKerning&&this._applyKerning(i,s)}get pageTextures(){return(0,r.deprecation)(r.v8_0_0,"BitmapFont.pageTextures is deprecated, please use BitmapFont.pages instead."),this.pages}_applyKerning(t,e){let i=this._measureCache;for(let r=0;r<t.length;r++){let s=t[r];for(let t=0;t<this._currentChars.length;t++){let r=this._currentChars[t],a=i[s];a||(a=i[s]=e.measureText(s).width);let n=i[r];n||(n=i[r]=e.measureText(r).width);let o=e.measureText(s+r).width,l=o-(a+n);l&&(this.chars[s].kerning[r]=l),(l=(o=e.measureText(s+r).width)-(a+n))&&(this.chars[r].kerning[s]=l)}}}_nextPage(){this._currentPageIndex++;let t=this.resolution,e=h.CanvasPool.getOptimalCanvasAndContext(this._textureSize,this._textureSize,t);this._setupContext(e.context,this._style,t);let i=t*(this.baseRenderedFontSize/this.baseMeasurementFontSize),r=new d.Texture({source:new u.ImageSource({resource:e.canvas,resolution:i,alphaMode:"premultiply-alpha-on-upload",autoGenerateMipmaps:this._mipmap})});this._textureStyle&&(r.source.style=this._textureStyle);let s={canvasAndContext:e,texture:r};return this.pages[this._currentPageIndex]=s,s}_setupContext(t,e,i){e.fontSize=this.baseRenderedFontSize,t.scale(i,i),t.font=(0,p.fontStringFromTextStyle)(e),e.fontSize=this.baseMeasurementFontSize,t.textBaseline=e.textBaseline;let r=e._stroke,s=r?.width??0;if(r&&(t.lineWidth=s,t.lineJoin=r.join,t.miterLimit=r.miterLimit,t.strokeStyle=(0,f.getCanvasFillStyle)(r,t)),e._fill&&(t.fillStyle=(0,f.getCanvasFillStyle)(e._fill,t)),e.dropShadow){let r=e.dropShadow,s=o.Color.shared.setValue(r.color).toArray(),a=r.blur*i,n=r.distance*i;t.shadowColor=`rgba(${255*s[0]},${255*s[1]},${255*s[2]},${r.alpha})`,t.shadowBlur=a,t.shadowOffsetX=Math.cos(r.angle)*n,t.shadowOffsetY=Math.sin(r.angle)*n}else t.shadowColor="black",t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0}_drawGlyph(t,e,i,r,s,a){let n=e.text,o=e.fontProperties,l=a._stroke,h=(l?.width??0)*s,u=i+h/2,d=r-h/2,c=o.descent*s,p=e.lineHeight*s,f=!1;a.stroke&&h&&(f=!0,t.strokeText(n,u,d+p-c));let{shadowBlur:x,shadowOffsetX:g,shadowOffsetY:m}=t;a._fill&&(f&&(t.shadowBlur=0,t.shadowOffsetX=0,t.shadowOffsetY=0),t.fillText(n,u,d+p-c)),f&&(t.shadowBlur=x,t.shadowOffsetX=g,t.shadowOffsetY=m)}destroy(){super.destroy();for(let t=0;t<this.pages.length;t++){let{canvasAndContext:e,texture:i}=this.pages[t];h.CanvasPool.returnCanvasAndContext(e),i.destroy(!0)}this.pages=null}};function m(t,e,i,r){let s={width:0,height:0,offsetY:0,scale:e.fontSize/i.baseMeasurementFontSize,lines:[{width:0,charPositions:[],spaceWidth:0,spacesIndex:[],chars:[]}]};s.offsetY=i.baseLineOffset;let a=s.lines[0],n=null,o=!0,l={spaceWord:!1,width:0,start:0,index:0,positions:[],chars:[]},h=i.baseMeasurementFontSize/e.fontSize,u=e.letterSpacing*h,d=e.wordWrapWidth*h,c=e.lineHeight?e.lineHeight*h:i.lineHeight,p=e.wordWrap&&e.breakWords,f=t=>{let e=a.width;for(let i=0;i<l.index;i++){let r=t.positions[i];a.chars.push(t.chars[i]),a.charPositions.push(r+e)}a.width+=t.width,o=!1,l.width=0,l.index=0,l.chars.length=0},x=()=>{let t=a.chars.length-1;if(r){let e=a.chars[t];for(;" "===e;)a.width-=i.chars[e].xAdvance,e=a.chars[--t]}s.width=Math.max(s.width,a.width),a={width:0,charPositions:[],chars:[],spaceWidth:0,spacesIndex:[]},o=!0,s.lines.push(a),s.height+=c},g=t=>t-u>d;for(let r=0;r<t.length+1;r++){let s,h=r===t.length;h||(s=t[r]);let d=i.chars[s]||i.chars[" "];if(/(?:\s)/.test(s)||"\r"===s||"\n"===s||h){if(!o&&e.wordWrap&&g(a.width+l.width)?x():l.start=a.width,f(l),h||a.charPositions.push(0),"\r"===s||"\n"===s)x();else if(!h){let t=d.xAdvance+(d.kerning[n]||0)+u;a.width+=t,a.spaceWidth=t,a.spacesIndex.push(a.charPositions.length),a.chars.push(s)}}else{let t=d.kerning[n]||0,e=d.xAdvance+t+u;p&&g(a.width+l.width+e)&&(f(l),x()),l.positions[l.index++]=l.width+t,l.chars.push(s),l.width+=e}n=s}return x(),"center"===e.align?function(t){for(let e=0;e<t.lines.length;e++){let i=t.lines[e],r=t.width/2-i.width/2;for(let t=0;t<i.charPositions.length;t++)i.charPositions[t]+=r}}(s):"right"===e.align?function(t){for(let e=0;e<t.lines.length;e++){let i=t.lines[e],r=t.width-i.width;for(let t=0;t<i.charPositions.length;t++)i.charPositions[t]+=r}}(s):"justify"===e.align&&function(t){let e=t.width;for(let i=0;i<t.lines.length;i++){let r=t.lines[i],s=0,a=r.spacesIndex[s++],n=0,o=r.spacesIndex.length,l=(e-r.width)/o;for(let t=0;t<r.charPositions.length;t++)t===a&&(a=r.spacesIndex[s++],n+=l),r.charPositions[t]+=n}}(s),s}function _(t){if(""===t)return[];"string"==typeof t&&(t=[t]);let e=[];for(let i=0,r=t.length;i<r;i++){let r=t[i];if(Array.isArray(r)){if(2!==r.length)throw Error(`[BitmapFont]: Invalid character range length, expecting 2 got ${r.length}.`);if(0===r[0].length||0===r[1].length)throw Error("[BitmapFont]: Invalid character delimiter.");let t=r[0].charCodeAt(0),i=r[1].charCodeAt(0);if(i<t)throw Error("[BitmapFont]: Invalid character range.");for(let r=t;r<=i;r++)e.push(String.fromCharCode(r))}else e.push(...Array.from(r))}if(0===e.length)throw Error("[BitmapFont]: Empty set when resolving characters.");return e}g.defaultOptions={textureSize:512,style:new n.TextStyle,mipmap:!0},t.s(["DynamicBitmapFont",()=>g],44384),t.s(["getBitmapTextLayout",()=>m],87772),t.s(["resolveCharacters",()=>_],68999);let y=0,v=new class{constructor(){this.ALPHA=[["a","z"],["A","Z"]," "],this.NUMERIC=[["0","9"]],this.ALPHANUMERIC=[["a","z"],["A","Z"],["0","9"]," "],this.ASCII=[[" ","~"]],this.defaultOptions={chars:this.ALPHANUMERIC,resolution:1,padding:4,skipKerning:!1,textureStyle:null},this.measureCache=(0,e.lru)(1e3)}getFont(t,e){let r=`${e.fontFamily}-bitmap`,a=!0;if(e._fill.fill&&!e._stroke?(r+=e._fill.fill.styleKey,a=!1):(e._stroke||e.dropShadow)&&(r=`${e.styleKey}-bitmap`,a=!1),!i.Cache.has(r)){let t=Object.create(e);t.lineHeight=0;let n=new g({style:t,overrideFill:a,overrideSize:!0,...this.defaultOptions});++y>50&&(0,s.warn)("BitmapText",`You have dynamically created ${y} bitmap fonts, this can be inefficient. Try pre installing your font styles using \`BitmapFont.install({name:"style1", style})\``),n.once("destroy",()=>{y--,i.Cache.remove(r)}),i.Cache.set(r,n)}let n=i.Cache.get(r);return n.ensureCharacters?.(t),n}getLayout(t,e,i=!0){let r=this.getFont(t,e),s=`${t}-${e.styleKey}-${i}`;if(this.measureCache.has(s))return this.measureCache.get(s);let n=m(a.CanvasTextMetrics.graphemeSegmenter(t),e,r,i);return this.measureCache.set(s,n),n}measureText(t,e,i=!0){return this.getLayout(t,e,i)}install(...t){let e=t[0];"string"==typeof e&&(e={name:e,style:t[1],chars:t[2]?.chars,resolution:t[2]?.resolution,padding:t[2]?.padding,skipKerning:t[2]?.skipKerning},(0,r.deprecation)(r.v8_0_0,"BitmapFontManager.install(name, style, options) is deprecated, use BitmapFontManager.install({name, style, ...options})"));let s=e?.name;if(!s)throw Error("[BitmapFontManager] Property `name` is required.");let a=(e={...this.defaultOptions,...e}).style,o=a instanceof n.TextStyle?a:new n.TextStyle(a),l=e.dynamicFill??this._canUseTintForStyle(o),h=new g({style:o,overrideFill:l,skipKerning:e.skipKerning,padding:e.padding,resolution:e.resolution,overrideSize:!1,textureStyle:e.textureStyle}),u=_(e.chars);return h.ensureCharacters(u.join("")),i.Cache.set(`${s}-bitmap`,h),h.once("destroy",()=>i.Cache.remove(`${s}-bitmap`)),h}uninstall(t){let e=`${t}-bitmap`,r=i.Cache.get(e);r&&r.destroy()}_canUseTintForStyle(t){return!t._stroke&&(!t.dropShadow||0===t.dropShadow.color)&&!t._fill.fill&&0xffffff===t._fill.color}};t.s(["BitmapFontManager",()=>v],3248)},20189,53284,37466,46312,t=>{"use strict";var e=t.i(81107),i=t.i(27076),r=t.i(54126),s="in vec2 aPosition;\nout vec2 vTextureCoord;\n\nuniform vec4 uInputSize;\nuniform vec4 uOutputFrame;\nuniform vec4 uOutputTexture;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aPosition * uOutputFrame.zw + uOutputFrame.xy;\n    \n    position.x = position.x * (2.0 / uOutputTexture.x) - 1.0;\n    position.y = position.y * (2.0*uOutputTexture.z / uOutputTexture.y) - uOutputTexture.z;\n\n    return vec4(position, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aPosition * (uOutputFrame.zw * uInputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n";t.s(["default",()=>s],53284);var a="in vec2 vTextureCoord;\nout vec4 finalColor;\nuniform sampler2D uTexture;\nvoid main() {\n    finalColor = texture(uTexture, vTextureCoord);\n}\n";t.s(["default",()=>a],37466);var n="struct GlobalFilterUniforms {\n  uInputSize: vec4<f32>,\n  uInputPixel: vec4<f32>,\n  uInputClamp: vec4<f32>,\n  uOutputFrame: vec4<f32>,\n  uGlobalFrame: vec4<f32>,\n  uOutputTexture: vec4<f32>,\n};\n\n@group(0) @binding(0) var <uniform> gfu: GlobalFilterUniforms;\n@group(0) @binding(1) var uTexture: texture_2d<f32>;\n@group(0) @binding(2) var uSampler: sampler;\n\nstruct VSOutput {\n  @builtin(position) position: vec4<f32>,\n  @location(0) uv: vec2<f32>\n};\n\nfn filterVertexPosition(aPosition: vec2<f32>) -> vec4<f32>\n{\n    var position = aPosition * gfu.uOutputFrame.zw + gfu.uOutputFrame.xy;\n\n    position.x = position.x * (2.0 / gfu.uOutputTexture.x) - 1.0;\n    position.y = position.y * (2.0 * gfu.uOutputTexture.z / gfu.uOutputTexture.y) - gfu.uOutputTexture.z;\n\n    return vec4(position, 0.0, 1.0);\n}\n\nfn filterTextureCoord(aPosition: vec2<f32>) -> vec2<f32>\n{\n    return aPosition * (gfu.uOutputFrame.zw * gfu.uInputSize.zw);\n}\n\n@vertex\nfn mainVertex(\n  @location(0) aPosition: vec2<f32>,\n) -> VSOutput {\n  return VSOutput(\n   filterVertexPosition(aPosition),\n   filterTextureCoord(aPosition)\n  );\n}\n\n@fragment\nfn mainFragment(\n  @location(0) uv: vec2<f32>,\n) -> @location(0) vec4<f32> {\n    return textureSample(uTexture, uSampler, uv);\n}\n";t.s(["default",()=>n],46312);class o extends r.Filter{constructor(){super({gpuProgram:i.GpuProgram.from({vertex:{source:n,entryPoint:"mainVertex"},fragment:{source:n,entryPoint:"mainFragment"},name:"passthrough-filter"}),glProgram:e.GlProgram.from({vertex:s,fragment:a,name:"passthrough-filter"})})}}t.s(["PassthroughFilter",()=>o],20189)},79744,t=>{"use strict";var e=t.i(47760);class i{constructor(t){this._renderer=t}push(t,e,i){this._renderer.renderPipes.batch.break(i),i.add({renderPipeId:"filter",canBundle:!1,action:"pushFilter",container:e,filterEffect:t})}pop(t,e,i){this._renderer.renderPipes.batch.break(i),i.add({renderPipeId:"filter",action:"popFilter",canBundle:!1})}execute(t){"pushFilter"===t.action?this._renderer.filter.push(t):"popFilter"===t.action&&this._renderer.filter.pop()}destroy(){this._renderer=null}}i.extension={type:[e.ExtensionType.WebGLPipes,e.ExtensionType.WebGPUPipes,e.ExtensionType.CanvasPipes],name:"filter"},t.s(["FilterPipe",()=>i])},34314,4518,t=>{"use strict";var e=t.i(47760),i=t.i(20189),r=t.i(28959),s=t.i(94359),a=t.i(60406),n=t.i(32543),o=t.i(31320),l=t.i(41163),h=t.i(18279),u=t.i(69553);let d=new r.Matrix;function c(t,e){e.clear();let i=e.matrix;for(let i=0;i<t.length;i++){let r=t[i];if(r.globalDisplayStatus<7)continue;let s=r.renderGroup??r.parentRenderGroup;s?.isCachedAsTexture?e.matrix=d.copyFrom(s.textureOffsetInverseTransform).append(r.worldTransform):s?._parentCacheAsTextureRenderGroup?e.matrix=d.copyFrom(s._parentCacheAsTextureRenderGroup.inverseWorldTransform).append(r.groupTransform):e.matrix=r.worldTransform,e.addBounds(r.bounds)}return e.matrix=i,e}t.s(["getGlobalRenderableBounds",()=>c],4518);var p=t.i(85830);let f=new a.Geometry({attributes:{aPosition:{buffer:new Float32Array([0,0,1,0,1,1,0,1]),format:"float32x2",stride:8,offset:0}},indexBuffer:new Uint32Array([0,1,2,0,2,3])});class x{constructor(){this.skip=!1,this.inputTexture=null,this.backTexture=null,this.filters=null,this.bounds=new u.Bounds,this.container=null,this.blendRequired=!1,this.outputRenderSurface=null,this.globalFrame={x:0,y:0,width:0,height:0},this.firstEnabledIndex=-1,this.lastEnabledIndex=-1}}class g{constructor(t){this._filterStackIndex=0,this._filterStack=[],this._filterGlobalUniforms=new n.UniformGroup({uInputSize:{value:new Float32Array(4),type:"vec4<f32>"},uInputPixel:{value:new Float32Array(4),type:"vec4<f32>"},uInputClamp:{value:new Float32Array(4),type:"vec4<f32>"},uOutputFrame:{value:new Float32Array(4),type:"vec4<f32>"},uGlobalFrame:{value:new Float32Array(4),type:"vec4<f32>"},uOutputTexture:{value:new Float32Array(4),type:"vec4<f32>"}}),this._globalFilterBindGroup=new s.BindGroup({}),this.renderer=t}get activeBackTexture(){return this._activeFilterData?.backTexture}push(t){let e=this.renderer,i=t.filterEffect.filters,r=this._pushFilterData();r.skip=!1,r.filters=i,r.container=t.container,r.outputRenderSurface=e.renderTarget.renderSurface;let s=e.renderTarget.renderTarget.colorTexture.source,a=s.resolution,n=s.antialias;if(i.every(t=>!t.enabled)){r.skip=!0;return}let o=r.bounds;if(this._calculateFilterArea(t,o),this._calculateFilterBounds(r,e.renderTarget.rootViewPort,n,a,1),r.skip)return;let l=this._getPreviousFilterData(),h=this._findFilterResolution(a),u=0,d=0;l&&(u=l.bounds.minX,d=l.bounds.minY),this._calculateGlobalFrame(r,u,d,h,s.width,s.height),this._setupFilterTextures(r,o,e,l)}generateFilteredTexture({texture:t,filters:e}){let i=this._pushFilterData();this._activeFilterData=i,i.skip=!1,i.filters=e;let r=t.source,s=r.resolution,a=r.antialias;if(e.every(t=>!t.enabled))return i.skip=!0,t;let n=i.bounds;if(n.addRect(t.frame),this._calculateFilterBounds(i,n.rectangle,a,s,0),i.skip)return t;this._calculateGlobalFrame(i,0,0,s,r.width,r.height),i.outputRenderSurface=l.TexturePool.getOptimalTexture(n.width,n.height,i.resolution,i.antialias),i.backTexture=o.Texture.EMPTY,i.inputTexture=t,this.renderer.renderTarget.finishRenderPass(),this._applyFiltersToTexture(i,!0);let h=i.outputRenderSurface;return h.source.alphaMode="premultiplied-alpha",h}pop(){let t=this.renderer,e=this._popFilterData();e.skip||(t.globalUniforms.pop(),t.renderTarget.finishRenderPass(),this._activeFilterData=e,this._applyFiltersToTexture(e,!1),e.blendRequired&&l.TexturePool.returnTexture(e.backTexture),l.TexturePool.returnTexture(e.inputTexture))}getBackTexture(t,e,i){let r=t.colorTexture.source._resolution,s=l.TexturePool.getOptimalTexture(e.width,e.height,r,!1),a=e.minX,n=e.minY;i&&(a-=i.minX,n-=i.minY),a=Math.floor(a*r),n=Math.floor(n*r);let o=Math.ceil(e.width*r),h=Math.ceil(e.height*r);return this.renderer.renderTarget.copyToTexture(t,s,{x:a,y:n},{width:o,height:h},{x:0,y:0}),s}applyFilter(t,e,i,r){let s=this.renderer,a=this._activeFilterData,n=a.outputRenderSurface===i,o=s.renderTarget.rootRenderTarget.colorTexture.source._resolution,l=this._findFilterResolution(o),h=0,u=0;if(n){let t=this._findPreviousFilterOffset();h=t.x,u=t.y}this._updateFilterUniforms(e,i,a,h,u,l,n,r);let d=t.enabled?t:this._getPassthroughFilter();this._setupBindGroupsAndRender(d,e,s)}calculateSpriteMatrix(t,e){let i=this._activeFilterData,s=t.set(i.inputTexture._source.width,0,0,i.inputTexture._source.height,i.bounds.minX,i.bounds.minY),a=e.worldTransform.copyTo(r.Matrix.shared),n=e.renderGroup||e.parentRenderGroup;return n&&n.cacheToLocalTransform&&a.prepend(n.cacheToLocalTransform),a.invert(),s.prepend(a),s.scale(1/e.texture.orig.width,1/e.texture.orig.height),s.translate(e.anchor.x,e.anchor.y),s}destroy(){this._passthroughFilter?.destroy(!0),this._passthroughFilter=null}_getPassthroughFilter(){return this._passthroughFilter??(this._passthroughFilter=new i.PassthroughFilter),this._passthroughFilter}_setupBindGroupsAndRender(t,e,i){if(i.renderPipes.uniformBatch){let t=i.renderPipes.uniformBatch.getUboResource(this._filterGlobalUniforms);this._globalFilterBindGroup.setResource(t,0)}else this._globalFilterBindGroup.setResource(this._filterGlobalUniforms,0);this._globalFilterBindGroup.setResource(e.source,1),this._globalFilterBindGroup.setResource(e.source.style,2),t.groups[0]=this._globalFilterBindGroup,i.encoder.draw({geometry:f,shader:t,state:t._state,topology:"triangle-list"}),i.type===h.RendererType.WEBGL&&i.renderTarget.finishRenderPass()}_setupFilterTextures(t,e,i,r){if(t.backTexture=o.Texture.EMPTY,t.inputTexture=l.TexturePool.getOptimalTexture(e.width,e.height,t.resolution,t.antialias),t.blendRequired){i.renderTarget.finishRenderPass();let s=i.renderTarget.getRenderTarget(t.outputRenderSurface);t.backTexture=this.getBackTexture(s,e,r?.bounds)}i.renderTarget.bind(t.inputTexture,!0),i.globalUniforms.push({offset:e})}_calculateGlobalFrame(t,e,i,r,s,a){let n=t.globalFrame;n.x=e*r,n.y=i*r,n.width=s*r,n.height=a*r}_updateFilterUniforms(t,e,i,r,s,a,n,l){let h=this._filterGlobalUniforms.uniforms,u=h.uOutputFrame,d=h.uInputSize,c=h.uInputPixel,p=h.uInputClamp,f=h.uGlobalFrame,x=h.uOutputTexture;n?(u[0]=i.bounds.minX-r,u[1]=i.bounds.minY-s):(u[0]=0,u[1]=0),u[2]=t.frame.width,u[3]=t.frame.height,d[0]=t.source.width,d[1]=t.source.height,d[2]=1/d[0],d[3]=1/d[1],c[0]=t.source.pixelWidth,c[1]=t.source.pixelHeight,c[2]=1/c[0],c[3]=1/c[1],p[0]=.5*c[2],p[1]=.5*c[3],p[2]=t.frame.width*d[2]-.5*c[2],p[3]=t.frame.height*d[3]-.5*c[3];let g=this.renderer.renderTarget.rootRenderTarget.colorTexture;f[0]=r*a,f[1]=s*a,f[2]=g.source.width*a,f[3]=g.source.height*a,e instanceof o.Texture&&(e.source.resource=null);let m=this.renderer.renderTarget.getRenderTarget(e);this.renderer.renderTarget.bind(e,!!l),e instanceof o.Texture?(x[0]=e.frame.width,x[1]=e.frame.height):(x[0]=m.width,x[1]=m.height),x[2]=m.isRoot?-1:1,this._filterGlobalUniforms.update()}_findFilterResolution(t){let e=this._filterStackIndex-1;for(;e>0&&this._filterStack[e].skip;)--e;return e>0&&this._filterStack[e].inputTexture?this._filterStack[e].inputTexture.source._resolution:t}_findPreviousFilterOffset(){let t=0,e=0,i=this._filterStackIndex;for(;i>0;){i--;let r=this._filterStack[i];if(!r.skip){t=r.bounds.minX,e=r.bounds.minY;break}}return{x:t,y:e}}_calculateFilterArea(t,e){if(t.renderables?c(t.renderables,e):t.filterEffect.filterArea?(e.clear(),e.addRect(t.filterEffect.filterArea),e.applyMatrix(t.container.worldTransform)):t.container.getFastGlobalBounds(!0,e),t.container){let i=(t.container.renderGroup||t.container.parentRenderGroup).cacheToLocalTransform;i&&e.applyMatrix(i)}}_applyFiltersToTexture(t,e){let i=t.inputTexture,r=t.bounds,s=t.filters,a=t.firstEnabledIndex,n=t.lastEnabledIndex;if(this._globalFilterBindGroup.setResource(i.source.style,2),this._globalFilterBindGroup.setResource(t.backTexture.source,3),a===n)s[a].apply(this,i,t.outputRenderSurface,e);else{let i=t.inputTexture,o=l.TexturePool.getOptimalTexture(r.width,r.height,i.source._resolution,!1),h=o;for(let t=a;t<n;t++){let e=s[t];if(!e.enabled)continue;e.apply(this,i,h,!0);let r=i;i=h,h=r}s[n].apply(this,i,t.outputRenderSurface,e),l.TexturePool.returnTexture(o)}}_calculateFilterBounds(t,e,i,r,s){let a=this.renderer,n=t.bounds,o=t.filters,l=1/0,h=0,u=!0,d=!1,c=!1,f=!0,x=-1,g=-1;for(let t=0;t<o.length;t++){let e=o[t];if(e.enabled){if(-1===x&&(x=t),g=t,l=Math.min(l,"inherit"===e.resolution?r:e.resolution),h+=e.padding,"off"===e.antialias?u=!1:"inherit"===e.antialias&&u&&(u=i),e.clipToViewport||(f=!1),!(e.compatibleRenderers&a.type)){c=!1;break}if(e.blendRequired&&!(a.backBuffer?.useBackBuffer??!0)){(0,p.warn)("Blend filter requires backBuffer on WebGL renderer to be enabled. Set `useBackBuffer: true` in the renderer options."),c=!1;break}c=!0,d||(d=e.blendRequired)}}if(!c||(f&&n.fitBounds(0,e.width/r,0,e.height/r),n.scale(l).ceil().scale(1/l).pad((0|h)*s),!n.isPositive)){t.skip=!0;return}t.antialias=u,t.resolution=l,t.blendRequired=d,t.firstEnabledIndex=x,t.lastEnabledIndex=g}_popFilterData(){return this._filterStackIndex--,this._filterStack[this._filterStackIndex]}_getPreviousFilterData(){let t,e=this._filterStackIndex-1;for(;e>0&&(e--,(t=this._filterStack[e]).skip););return t}_pushFilterData(){let t=this._filterStack[this._filterStackIndex];return t||(t=this._filterStack[this._filterStackIndex]=new x),this._filterStackIndex++,t}}g.extension={type:[e.ExtensionType.WebGLSystem,e.ExtensionType.WebGPUSystem],name:"filter"},t.s(["FilterSystem",()=>g],34314)},94425,t=>{"use strict";var e=t.i(49864),i=t.i(97377),r=t.i(20446);class s extends i.ViewContainer{constructor(t){t instanceof r.GraphicsContext&&(t={context:t});const{context:e,roundPixels:i,...s}=t||{};super({label:"Graphics",...s}),this.renderPipeId="graphics",e?this.context=e:(this.context=this._ownedContext=new r.GraphicsContext,this.context.autoGarbageCollect=this.autoGarbageCollect),this.didViewUpdate=!0,this.allowChildren=!1,this.roundPixels=i??!1}set context(t){t!==this._context&&(this._context&&(this._context.off("update",this.onViewUpdate,this),this._context.off("unload",this.unload,this)),this._context=t,this._context.on("update",this.onViewUpdate,this),this._context.on("unload",this.unload,this),this.onViewUpdate())}get context(){return this._context}get bounds(){return this._context.bounds}updateBounds(){}containsPoint(t){return this._context.containsPoint(t)}destroy(t){this._ownedContext&&!t?this._ownedContext.destroy(t):(!0===t||t?.context===!0)&&this._context.destroy(t),this._ownedContext=null,this._context=null,super.destroy(t)}_onTouch(t){this._gcLastUsed=t,this._context._gcLastUsed=t}_callContextMethod(t,e){return this.context[t](...e),this}setFillStyle(...t){return this._callContextMethod("setFillStyle",t)}setStrokeStyle(...t){return this._callContextMethod("setStrokeStyle",t)}fill(...t){return this._callContextMethod("fill",t)}stroke(...t){return this._callContextMethod("stroke",t)}texture(...t){return this._callContextMethod("texture",t)}beginPath(){return this._callContextMethod("beginPath",[])}cut(){return this._callContextMethod("cut",[])}arc(...t){return this._callContextMethod("arc",t)}arcTo(...t){return this._callContextMethod("arcTo",t)}arcToSvg(...t){return this._callContextMethod("arcToSvg",t)}bezierCurveTo(...t){return this._callContextMethod("bezierCurveTo",t)}closePath(){return this._callContextMethod("closePath",[])}ellipse(...t){return this._callContextMethod("ellipse",t)}circle(...t){return this._callContextMethod("circle",t)}path(...t){return this._callContextMethod("path",t)}lineTo(...t){return this._callContextMethod("lineTo",t)}moveTo(...t){return this._callContextMethod("moveTo",t)}quadraticCurveTo(...t){return this._callContextMethod("quadraticCurveTo",t)}rect(...t){return this._callContextMethod("rect",t)}roundRect(...t){return this._callContextMethod("roundRect",t)}poly(...t){return this._callContextMethod("poly",t)}regularPoly(...t){return this._callContextMethod("regularPoly",t)}roundPoly(...t){return this._callContextMethod("roundPoly",t)}roundShape(...t){return this._callContextMethod("roundShape",t)}filletRect(...t){return this._callContextMethod("filletRect",t)}chamferRect(...t){return this._callContextMethod("chamferRect",t)}star(...t){return this._callContextMethod("star",t)}svg(...t){return this._callContextMethod("svg",t)}restore(...t){return this._callContextMethod("restore",t)}save(){return this._callContextMethod("save",[])}getTransform(){return this.context.getTransform()}resetTransform(){return this._callContextMethod("resetTransform",[])}rotateTransform(...t){return this._callContextMethod("rotate",t)}scaleTransform(...t){return this._callContextMethod("scale",t)}setTransform(...t){return this._callContextMethod("setTransform",t)}transform(...t){return this._callContextMethod("transform",t)}translateTransform(...t){return this._callContextMethod("translate",t)}clear(){return this._callContextMethod("clear",[])}get fillStyle(){return this._context.fillStyle}set fillStyle(t){this._context.fillStyle=t}get strokeStyle(){return this._context.strokeStyle}set strokeStyle(t){this._context.strokeStyle=t}clone(t=!1){return t?new s(this._context.clone()):(this._ownedContext=null,new s(this._context))}lineStyle(t,i,r){(0,e.deprecation)(e.v8_0_0,"Graphics#lineStyle is no longer needed. Use Graphics#setStrokeStyle to set the stroke style.");let s={};return t&&(s.width=t),i&&(s.color=i),r&&(s.alpha=r),this.context.strokeStyle=s,this}beginFill(t,i){(0,e.deprecation)(e.v8_0_0,"Graphics#beginFill is no longer needed. Use Graphics#fill to fill the shape with the desired style.");let r={};return void 0!==t&&(r.color=t),void 0!==i&&(r.alpha=i),this.context.fillStyle=r,this}endFill(){(0,e.deprecation)(e.v8_0_0,"Graphics#endFill is no longer needed. Use Graphics#fill to fill the shape with the desired style."),this.context.fill();let t=this.context.strokeStyle;return(t.width!==r.GraphicsContext.defaultStrokeStyle.width||t.color!==r.GraphicsContext.defaultStrokeStyle.color||t.alpha!==r.GraphicsContext.defaultStrokeStyle.alpha)&&this.context.stroke(),this}drawCircle(...t){return(0,e.deprecation)(e.v8_0_0,"Graphics#drawCircle has been renamed to Graphics#circle"),this._callContextMethod("circle",t)}drawEllipse(...t){return(0,e.deprecation)(e.v8_0_0,"Graphics#drawEllipse has been renamed to Graphics#ellipse"),this._callContextMethod("ellipse",t)}drawPolygon(...t){return(0,e.deprecation)(e.v8_0_0,"Graphics#drawPolygon has been renamed to Graphics#poly"),this._callContextMethod("poly",t)}drawRect(...t){return(0,e.deprecation)(e.v8_0_0,"Graphics#drawRect has been renamed to Graphics#rect"),this._callContextMethod("rect",t)}drawRoundedRect(...t){return(0,e.deprecation)(e.v8_0_0,"Graphics#drawRoundedRect has been renamed to Graphics#roundRect"),this._callContextMethod("roundRect",t)}drawStar(...t){return(0,e.deprecation)(e.v8_0_0,"Graphics#drawStar has been renamed to Graphics#star"),this._callContextMethod("star",t)}}t.s(["Graphics",()=>s])},17982,t=>{"use strict";var e=t.i(85465),i=t.i(64957),r=t.i(60406),s=t.i(49864);let a=class t extends r.Geometry{constructor(...r){let a=r[0]??{};a instanceof Float32Array&&((0,s.deprecation)(s.v8_0_0,"use new MeshGeometry({ positions, uvs, indices }) instead"),a={positions:a,uvs:r[1],indices:r[2]});const n=(a={...t.defaultOptions,...a}).positions||new Float32Array([0,0,1,0,1,1,0,1]);let o=a.uvs;o||(o=new Float32Array(a.positions?n.length:[0,0,1,0,1,1,0,1]));const l=a.indices||new Uint32Array([0,1,2,0,2,3]),h=a.shrinkBuffersToFit,u=new e.Buffer({data:n,label:"attribute-mesh-positions",shrinkToFit:h,usage:i.BufferUsage.VERTEX|i.BufferUsage.COPY_DST});super({attributes:{aPosition:{buffer:u,format:"float32x2",stride:8,offset:0},aUV:{buffer:new e.Buffer({data:o,label:"attribute-mesh-uvs",shrinkToFit:h,usage:i.BufferUsage.VERTEX|i.BufferUsage.COPY_DST}),format:"float32x2",stride:8,offset:0}},indexBuffer:new e.Buffer({data:l,label:"index-mesh-buffer",shrinkToFit:h,usage:i.BufferUsage.INDEX|i.BufferUsage.COPY_DST}),topology:a.topology}),this.batchMode="auto"}get positions(){return this.attributes.aPosition.buffer.data}set positions(t){this.attributes.aPosition.buffer.data=t}get uvs(){return this.attributes.aUV.buffer.data}set uvs(t){this.attributes.aUV.buffer.data=t}get indices(){return this.indexBuffer.data}set indices(t){this.indexBuffer.data=t}};a.defaultOptions={topology:"triangle-list",shrinkBuffersToFit:!1},t.s(["MeshGeometry",()=>a])},34787,t=>{"use strict";var e=t.i(27402),i=t.i(61411),r=t.i(63646);let s=null,a=null;function n(t,e,i){for(let r=0,s=4*i*e;r<e;++r,s+=4)if(0!==t[s+3])return!1;return!0}function o(t,e,i,r,s){let a=4*e;for(let e=r,n=r*a+4*i;e<=s;++e,n+=a)if(0!==t[n+3])return!1;return!0}function l(...t){let h=t[0];h.canvas||(h={canvas:t[0],resolution:t[1]});let{canvas:u}=h,d=Math.min(h.resolution??1,1),c=h.width??u.width,p=h.height??u.height,f=h.output;if(s||((a=(s=e.DOMAdapter.get().createCanvas(256,128)).getContext("2d",{willReadFrequently:!0})).globalCompositeOperation="copy",a.globalAlpha=1),(s.width<c||s.height<p)&&(s.width=(0,i.nextPow2)(c),s.height=(0,i.nextPow2)(p)),!a)throw TypeError("Failed to get canvas 2D context");a.drawImage(u,0,0,c,p,0,0,c*d,p*d);let x=a.getImageData(0,0,c,p).data,g=0,m=0,_=c-1,y=p-1;for(;m<p&&n(x,c,m);)++m;if(m===p)return r.Rectangle.EMPTY;for(;n(x,c,y);)--y;for(;o(x,c,g,m,y);)++g;for(;o(x,c,_,m,y);)--_;return++_,++y,a.globalCompositeOperation="source-over",a.strokeRect(g,m,_-g,y-m),a.globalCompositeOperation="copy",f??(f=new r.Rectangle),f.set(g/d,m/d,(_-g)/d,(y-m)/d),f}t.s(["getCanvasBoundingBox",()=>l])},24183,t=>{"use strict";var e=t.i(57471),i=t.i(63646),r=t.i(81735),s=t.i(34787),a=t.i(78266),n=t.i(264),o=t.i(70);let l=new i.Rectangle,h=new class{getCanvasAndContext(t){let{text:e,style:i,resolution:n=1}=t,o=i._getFinalPadding(),h=a.CanvasTextMetrics.measureText(e||" ",i),u=Math.ceil(Math.ceil(Math.max(1,h.width)+2*o)*n),d=Math.ceil(Math.ceil(Math.max(1,h.height)+2*o)*n),c=r.CanvasPool.getOptimalCanvasAndContext(u,d);this._renderTextToCanvas(e,i,o,n,c);let p=i.trim?(0,s.getCanvasBoundingBox)({canvas:c.canvas,width:u,height:d,resolution:1,output:l}):l.set(0,0,u,d);return{canvasAndContext:c,frame:p}}returnCanvasAndContext(t){r.CanvasPool.returnCanvasAndContext(t)}_renderTextToCanvas(t,i,r,s,l){let h,u,{canvas:d,context:c}=l,p=(0,n.fontStringFromTextStyle)(i),f=a.CanvasTextMetrics.measureText(t||" ",i),x=f.lines,g=f.lineHeight,m=f.lineWidths,_=f.maxLineWidth,y=f.fontProperties,v=d.height;if(c.resetTransform(),c.scale(s,s),c.textBaseline=i.textBaseline,i._stroke?.width){let t=i._stroke;c.lineWidth=t.width,c.miterLimit=t.miterLimit,c.lineJoin=t.join,c.lineCap=t.cap}c.font=p;let b=i.dropShadow?2:1;for(let t=0;t<b;++t){let a=i.dropShadow&&0===t,n=a?Math.ceil(Math.max(1,v)+2*r):0,d=n*s;if(a){c.fillStyle="black",c.strokeStyle="black";let t=i.dropShadow,r=t.color,a=t.alpha;c.shadowColor=e.Color.shared.setValue(r).setAlpha(a).toRgbaString();let n=t.blur*s,o=t.distance*s;c.shadowBlur=n,c.shadowOffsetX=Math.cos(t.angle)*o,c.shadowOffsetY=Math.sin(t.angle)*o+d}else{if(c.fillStyle=i._fill?(0,o.getCanvasFillStyle)(i._fill,c,f,2*r):null,i._stroke?.width){let t=.5*i._stroke.width+2*r;c.strokeStyle=(0,o.getCanvasFillStyle)(i._stroke,c,f,t)}c.shadowColor="black"}let p=(g-y.fontSize)/2;g-y.fontSize<0&&(p=0);let b=i._stroke?.width??0;for(let t=0;t<x.length;t++)h=b/2,u=b/2+t*g+y.ascent+p,"right"===i.align?h+=_-m[t]:"center"===i.align&&(h+=(_-m[t])/2),i._stroke?.width&&this._drawLetterSpacing(x[t],i,l,h+r,u+r-n,!0),void 0!==i._fill&&this._drawLetterSpacing(x[t],i,l,h+r,u+r-n)}}_drawLetterSpacing(t,e,i,r,s,n=!1){let{context:o}=i,l=e.letterSpacing,h=!1;if(a.CanvasTextMetrics.experimentalLetterSpacingSupported&&(a.CanvasTextMetrics.experimentalLetterSpacing?(o.letterSpacing=`${l}px`,o.textLetterSpacing=`${l}px`,h=!0):(o.letterSpacing="0px",o.textLetterSpacing="0px")),0===l||h)return void(n?o.strokeText(t,r,s):o.fillText(t,r,s));let u=r,d=a.CanvasTextMetrics.graphemeSegmenter(t),c=o.measureText(t).width,p=0;for(let t=0;t<d.length;++t){let e=d[t];n?o.strokeText(e,u,s):o.fillText(e,u,s);let i="";for(let e=t+1;e<d.length;++e)i+=d[e];u+=c-(p=o.measureText(i).width)+l,c=p}}};t.s(["CanvasTextGenerator",()=>h])},36566,t=>{"use strict";var e=t.i(27402);let i="http://www.w3.org/2000/svg",r="http://www.w3.org/1999/xhtml";class s{constructor(){this.svgRoot=document.createElementNS(i,"svg"),this.foreignObject=document.createElementNS(i,"foreignObject"),this.domElement=document.createElementNS(r,"div"),this.styleElement=document.createElementNS(r,"style");const{foreignObject:t,svgRoot:s,styleElement:a,domElement:n}=this;t.setAttribute("width","10000"),t.setAttribute("height","10000"),t.style.overflow="hidden",s.appendChild(t),t.appendChild(a),t.appendChild(n),this.image=e.DOMAdapter.get().createImage()}destroy(){this.svgRoot.remove(),this.foreignObject.remove(),this.styleElement.remove(),this.domElement.remove(),this.image.src="",this.image.remove(),this.svgRoot=null,this.foreignObject=null,this.styleElement=null,this.domElement=null,this.image=null,this.canvasAndContext=null}}t.s(["HTMLTextRenderData",()=>s])},71467,t=>{"use strict";let e;var i=t.i(36566);function r(t,r,s,a){a||(a=e||(e=new i.HTMLTextRenderData));let{domElement:n,styleElement:o,svgRoot:l}=a;n.innerHTML=`<style>${r.cssStyle};</style><div style='padding:0'>${t}</div>`,n.setAttribute("style","transform-origin: top left; display: inline-block"),s&&(o.textContent=s),document.body.appendChild(l);let h=n.getBoundingClientRect();l.remove();let u=2*r.padding;return{width:h.width-u,height:h.height-u}}t.s(["measureHtmlText",()=>r])},28550,62976,58450,t=>{"use strict";t.s(["default",()=>"varying vec2 vUV;\nvarying vec4 vColor;\n\nuniform sampler2D uTexture;\n\nvoid main(void){\n    vec4 color = texture2D(uTexture, vUV) * vColor;\n    gl_FragColor = color;\n}"],28550),t.s(["default",()=>"attribute vec2 aVertex;\nattribute vec2 aUV;\nattribute vec4 aColor;\n\nattribute vec2 aPosition;\nattribute float aRotation;\n\nuniform mat3 uTranslationMatrix;\nuniform float uRound;\nuniform vec2 uResolution;\nuniform vec4 uColor;\n\nvarying vec2 vUV;\nvarying vec4 vColor;\n\nvec2 roundPixels(vec2 position, vec2 targetSize)\n{       \n    return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;\n}\n\nvoid main(void){\n    float cosRotation = cos(aRotation);\n    float sinRotation = sin(aRotation);\n    float x = aVertex.x * cosRotation - aVertex.y * sinRotation;\n    float y = aVertex.x * sinRotation + aVertex.y * cosRotation;\n\n    vec2 v = vec2(x, y);\n    v = v + aPosition;\n\n    gl_Position = vec4((uTranslationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);\n\n    if(uRound == 1.0)\n    {\n        gl_Position.xy = roundPixels(gl_Position.xy, uResolution);\n    }\n\n    vUV = aUV;\n    vColor = vec4(aColor.rgb * aColor.a, aColor.a) * uColor;\n}\n"],62976),t.s(["default",()=>"\nstruct ParticleUniforms {\n  uTranslationMatrix:mat3x3<f32>,\n  uColor:vec4<f32>,\n  uRound:f32,\n  uResolution:vec2<f32>,\n};\n\nfn roundPixels(position: vec2<f32>, targetSize: vec2<f32>) -> vec2<f32>\n{\n  return (floor(((position * 0.5 + 0.5) * targetSize) + 0.5) / targetSize) * 2.0 - 1.0;\n}\n\n@group(0) @binding(0) var<uniform> uniforms: ParticleUniforms;\n\n@group(1) @binding(0) var uTexture: texture_2d<f32>;\n@group(1) @binding(1) var uSampler : sampler;\n\nstruct VSOutput {\n    @builtin(position) position: vec4<f32>,\n    @location(0) uv : vec2<f32>,\n    @location(1) color : vec4<f32>,\n  };\n@vertex\nfn mainVertex(\n  @location(0) aVertex: vec2<f32>,\n  @location(1) aPosition: vec2<f32>,\n  @location(2) aUV: vec2<f32>,\n  @location(3) aColor: vec4<f32>,\n  @location(4) aRotation: f32,\n) -> VSOutput {\n  \n   let v = vec2(\n       aVertex.x * cos(aRotation) - aVertex.y * sin(aRotation),\n       aVertex.x * sin(aRotation) + aVertex.y * cos(aRotation)\n   ) + aPosition;\n\n   var position = vec4((uniforms.uTranslationMatrix * vec3(v, 1.0)).xy, 0.0, 1.0);\n\n   if(uniforms.uRound == 1.0) {\n       position = vec4(roundPixels(position.xy, uniforms.uResolution), position.zw);\n   }\n\n    let vColor = vec4(aColor.rgb * aColor.a, aColor.a) * uniforms.uColor;\n\n  return VSOutput(\n   position,\n   aUV,\n   vColor,\n  );\n}\n\n@fragment\nfn mainFragment(\n  @location(0) uv: vec2<f32>,\n  @location(1) color: vec4<f32>,\n  @builtin(position) position: vec4<f32>,\n) -> @location(0) vec4<f32> {\n\n    var sample = textureSample(uTexture, uSampler, uv) * color;\n   \n    return sample;\n}"],58450)},80493,t=>{"use strict";var e=t.i(47760),i=t.i(22558),r=t.i(33219),s=t.i(74179),a=t.i(89506),n=t.i(1187);class o{constructor(){this.batches=[],this.batched=!1}destroy(){this.batches.forEach(t=>{s.BigPool.return(t)}),this.batches.length=0}}class l{constructor(t,e){this.state=i.State.for2d(),this.renderer=t,this._adaptor=e,this.renderer.runners.contextChange.add(this),this._managedGraphics=new r.GCManagedHash({renderer:t,type:"renderable",priority:-1,name:"graphics"})}contextChange(){this._adaptor.contextChange(this.renderer)}validateRenderable(t){let e=t.context,i=!!t._gpuData,r=this.renderer.graphicsContext.updateGpuContext(e);return!!r.isBatchable||i!==r.isBatchable}addRenderable(t,e){let i=this.renderer.graphicsContext.updateGpuContext(t.context);t.didViewUpdate&&this._rebuild(t),i.isBatchable?this._addToBatcher(t,e):(this.renderer.renderPipes.batch.break(e),e.add(t))}updateRenderable(t){let e=this._getGpuDataForRenderable(t).batches;for(let t=0;t<e.length;t++){let i=e[t];i._batcher.updateElement(i)}}execute(t){if(!t.isRenderable)return;let e=this.renderer,i=t.context;if(!e.graphicsContext.getGpuContext(i).batches.length)return;let r=i.customShader||this._adaptor.shader;this.state.blendMode=t.groupBlendMode;let s=r.resources.localUniforms.uniforms;s.uTransformMatrix=t.groupTransform,s.uRound=e._roundPixels|t._roundPixels,(0,a.color32BitToUniform)(t.groupColorAlpha,s.uColor,0),this._adaptor.execute(this,t)}_rebuild(t){let e=this._getGpuDataForRenderable(t),i=this.renderer.graphicsContext.updateGpuContext(t.context);e.destroy(),i.isBatchable&&this._updateBatchesForRenderable(t,e)}_addToBatcher(t,e){let i=this.renderer.renderPipes.batch,r=this._getGpuDataForRenderable(t).batches;for(let t=0;t<r.length;t++){let s=r[t];i.addToBatch(s,e)}}_getGpuDataForRenderable(t){return t._gpuData[this.renderer.uid]||this._initGpuDataForRenderable(t)}_initGpuDataForRenderable(t){let e=new o;return t._gpuData[this.renderer.uid]=e,this._managedGraphics.add(t),e}_updateBatchesForRenderable(t,e){let i=t.context,r=this.renderer.graphicsContext.getGpuContext(i),a=this.renderer._roundPixels|t._roundPixels;e.batches=r.batches.map(e=>{let i=s.BigPool.get(n.BatchableGraphics);return e.copyTo(i),i.renderable=t,i.roundPixels=a,i})}destroy(){this._managedGraphics.destroy(),this.renderer=null,this._adaptor.destroy(),this._adaptor=null,this.state=null}}l.extension={type:[e.ExtensionType.WebGLPipes,e.ExtensionType.WebGPUPipes,e.ExtensionType.CanvasPipes],name:"graphics"},t.s(["GraphicsGpuData",()=>o,"GraphicsPipe",()=>l])},3274,t=>{"use strict";var e=t.i(49864),i=t.i(17982);let r=class t extends i.MeshGeometry{constructor(...t){super({});let i=t[0]??{};"number"==typeof i&&((0,e.deprecation)(e.v8_0_0,"PlaneGeometry constructor changed please use { width, height, verticesX, verticesY } instead"),i={width:i,height:t[1],verticesX:t[2],verticesY:t[3]}),this.build(i)}build(e){e={...t.defaultOptions,...e},this.verticesX=this.verticesX??e.verticesX,this.verticesY=this.verticesY??e.verticesY,this.width=this.width??e.width,this.height=this.height??e.height;let i=this.verticesX*this.verticesY,r=[],s=[],a=[],n=this.verticesX-1,o=this.verticesY-1,l=this.width/n,h=this.height/o;for(let t=0;t<i;t++){let e=t%this.verticesX,i=t/this.verticesX|0;r.push(e*l,i*h),s.push(e/n,i/o)}let u=n*o;for(let t=0;t<u;t++){let e=t%n,i=t/n|0,r=i*this.verticesX+e,s=i*this.verticesX+e+1,o=(i+1)*this.verticesX+e,l=(i+1)*this.verticesX+e+1;a.push(r,s,o,s,l,o)}this.buffers[0].data=new Float32Array(r),this.buffers[1].data=new Float32Array(s),this.indexBuffer.data=new Uint32Array(a),this.buffers[0].update(),this.buffers[1].update(),this.indexBuffer.update()}};r.defaultOptions={width:100,height:100,verticesX:10,verticesY:10},t.s(["PlaneGeometry",()=>r])},22511,71781,66746,t=>{"use strict";var e=t.i(47760),i=t.i(28959),r=t.i(94359),s=t.i(32543),a=t.i(60728),n=t.i(89506);class o{constructor(){this.batcherName="default",this.packAsQuad=!1,this.indexOffset=0,this.attributeOffset=0,this.roundPixels=0,this._batcher=null,this._batch=null,this._textureMatrixUpdateId=-1,this._uvUpdateId=-1}get blendMode(){return this.renderable.groupBlendMode}get topology(){return this._topology||this.geometry.topology}set topology(t){this._topology=t}reset(){this.renderable=null,this.texture=null,this._batcher=null,this._batch=null,this.geometry=null,this._uvUpdateId=-1,this._textureMatrixUpdateId=-1}setTexture(t){this.texture!==t&&(this.texture=t,this._textureMatrixUpdateId=-1)}get uvs(){let t=this.geometry.getBuffer("aUV"),e=t.data,i=e,r=this.texture.textureMatrix;return r.isSimple||(i=this._transformedUvs,(this._textureMatrixUpdateId!==r._updateID||this._uvUpdateId!==t._updateID)&&((!i||i.length<e.length)&&(i=this._transformedUvs=new Float32Array(e.length)),this._textureMatrixUpdateId=r._updateID,this._uvUpdateId=t._updateID,r.multiplyUvs(e,i))),i}get positions(){return this.geometry.positions}get indices(){return this.geometry.indices}get color(){return this.renderable.groupColorAlpha}get groupTransform(){return this.renderable.groupTransform}get attributeSize(){return this.geometry.positions.length/2}get indexSize(){return this.geometry.indices.length}}t.s(["BatchableMesh",()=>o],71781);class l{destroy(){}}class h{constructor(t,e){this.localUniforms=new s.UniformGroup({uTransformMatrix:{value:new i.Matrix,type:"mat3x3<f32>"},uColor:{value:new Float32Array([1,1,1,1]),type:"vec4<f32>"},uRound:{value:0,type:"f32"}}),this.localUniformsBindGroup=new r.BindGroup({0:this.localUniforms}),this.renderer=t,this._adaptor=e,this._adaptor.init()}validateRenderable(t){let e=this._getMeshData(t),i=e.batched,r=t.batched;if(e.batched=r,i!==r)return!0;if(r){let i=t._geometry;if(i.indices.length!==e.indexSize||i.positions.length!==e.vertexSize)return e.indexSize=i.indices.length,e.vertexSize=i.positions.length,!0;let r=this._getBatchableMesh(t);return r.texture.uid!==t._texture.uid&&(r._textureMatrixUpdateId=-1),!r._batcher.checkAndUpdateTexture(r,t._texture)}return!1}addRenderable(t,e){let i=this.renderer.renderPipes.batch,r=this._getMeshData(t);if(t.didViewUpdate&&(r.indexSize=t._geometry.indices?.length,r.vertexSize=t._geometry.positions?.length),r.batched){let r=this._getBatchableMesh(t);r.setTexture(t._texture),r.geometry=t._geometry,i.addToBatch(r,e)}else i.break(e),e.add(t)}updateRenderable(t){if(t.batched){let e=this._getBatchableMesh(t);e.setTexture(t._texture),e.geometry=t._geometry,e._batcher.updateElement(e)}}execute(t){if(!t.isRenderable)return;t.state.blendMode=(0,a.getAdjustedBlendModeBlend)(t.groupBlendMode,t.texture._source);let e=this.localUniforms;e.uniforms.uTransformMatrix=t.groupTransform,e.uniforms.uRound=this.renderer._roundPixels|t._roundPixels,e.update(),(0,n.color32BitToUniform)(t.groupColorAlpha,e.uniforms.uColor,0),this._adaptor.execute(this,t)}_getMeshData(t){var e,i;return(e=t._gpuData)[i=this.renderer.uid]||(e[i]=new l),t._gpuData[this.renderer.uid].meshData||this._initMeshData(t)}_initMeshData(t){return t._gpuData[this.renderer.uid].meshData={batched:t.batched,indexSize:0,vertexSize:0},t._gpuData[this.renderer.uid].meshData}_getBatchableMesh(t){var e,i;return(e=t._gpuData)[i=this.renderer.uid]||(e[i]=new l),t._gpuData[this.renderer.uid].batchableMesh||this._initBatchableMesh(t)}_initBatchableMesh(t){let e=new o;return e.renderable=t,e.setTexture(t._texture),e.transform=t.groupTransform,e.roundPixels=this.renderer._roundPixels|t._roundPixels,t._gpuData[this.renderer.uid].batchableMesh=e,e}destroy(){this.localUniforms=null,this.localUniformsBindGroup=null,this._adaptor.destroy(),this._adaptor=null,this.renderer=null}}h.extension={type:[e.ExtensionType.WebGLPipes,e.ExtensionType.WebGPUPipes,e.ExtensionType.CanvasPipes],name:"mesh"},t.s(["MeshGpuData",()=>l,"MeshPipe",()=>h],22511);class u{execute(t,e){let i=t.state,r=t.renderer,s=e.shader||t.defaultShader;s.resources.uTexture=e.texture._source,s.resources.uniforms=t.localUniforms;let a=r.gl,n=t.getBuffers(e);r.shader.bind(s),r.state.set(i),r.geometry.bind(n.geometry,s.glProgram);let o=2===n.geometry.indexBuffer.data.BYTES_PER_ELEMENT?a.UNSIGNED_SHORT:a.UNSIGNED_INT;a.drawElements(a.TRIANGLES,6*e.particleChildren.length,o,0)}}t.s(["GlParticleContainerAdaptor",()=>u],66746)},25123,t=>{"use strict";class e{execute(t,e){let i=t.renderer,r=e.shader||t.defaultShader;r.groups[0]=i.renderPipes.uniformBatch.getUniformBindGroup(t.localUniforms,!0),r.groups[1]=i.texture.getTextureBindGroup(e.texture);let s=t.state,a=t.getBuffers(e);i.encoder.draw({geometry:a.geometry,shader:e.shader||t.defaultShader,state:s,size:6*e.particleChildren.length})}}t.s(["GpuParticleContainerAdaptor",()=>e])},17291,66798,37105,t=>{"use strict";var e=t.i(85465),i=t.i(64957),r=t.i(60406),s=t.i(46820),a=t.i(37024);function n(t,e=null){let i=6*t;if(i>65535?e||(e=new Uint32Array(i)):e||(e=new Uint16Array(i)),e.length!==i)throw Error(`Out buffer length is incorrect, got ${e.length} and expected ${i}`);for(let t=0,r=0;t<i;t+=6,r+=4)e[t+0]=r+0,e[t+1]=r+1,e[t+2]=r+2,e[t+3]=r+0,e[t+4]=r+2,e[t+5]=r+3;return e}function o(t){return{dynamicUpdate:l(t,!0),staticUpdate:l(t,!1)}}function l(t,e){let i=[];i.push(`

        var index = 0;

        for (let i = 0; i < ps.length; ++i)
        {
            const p = ps[i];

            `);let r=0;for(let a in t){let n=t[a];e===n.dynamic&&(i.push(`offset = index + ${r}`),i.push(n.code),r+=(0,s.getAttributeInfoFromFormat)(n.format).stride/4)}return i.push(`
            index += stride * 4;
        }
    `),i.unshift(`
        var stride = ${r};
    `),Function("ps","f32v","u32v",i.join("\n"))}t.s(["createIndicesForQuads",()=>n],66798),t.s(["generateParticleUpdateFunction",()=>o],37105);class h{constructor(t){this._size=0,this._generateParticleUpdateCache={};const o=this._size=t.size??1e3,l=t.properties;let h=0,u=0;for(const t in l){const e=l[t],i=(0,s.getAttributeInfoFromFormat)(e.format);e.dynamic?u+=i.stride:h+=i.stride}this._dynamicStride=u/4,this._staticStride=h/4,this.staticAttributeBuffer=new a.ViewableBuffer(4*o*h),this.dynamicAttributeBuffer=new a.ViewableBuffer(4*o*u),this.indexBuffer=n(o);const d=new r.Geometry;let c=0,p=0;for(const t in this._staticBuffer=new e.Buffer({data:new Float32Array(1),label:"static-particle-buffer",shrinkToFit:!1,usage:i.BufferUsage.VERTEX|i.BufferUsage.COPY_DST}),this._dynamicBuffer=new e.Buffer({data:new Float32Array(1),label:"dynamic-particle-buffer",shrinkToFit:!1,usage:i.BufferUsage.VERTEX|i.BufferUsage.COPY_DST}),l){const e=l[t],i=(0,s.getAttributeInfoFromFormat)(e.format);e.dynamic?(d.addAttribute(e.attributeName,{buffer:this._dynamicBuffer,stride:4*this._dynamicStride,offset:4*c,format:e.format}),c+=i.size):(d.addAttribute(e.attributeName,{buffer:this._staticBuffer,stride:4*this._staticStride,offset:4*p,format:e.format}),p+=i.size)}d.addIndex(this.indexBuffer);const f=this.getParticleUpdate(l);this._dynamicUpload=f.dynamicUpdate,this._staticUpload=f.staticUpdate,this.geometry=d}getParticleUpdate(t){let e=function(t){let e=[];for(let i in t){let r=t[i];e.push(i,r.code,r.dynamic?"d":"s")}return e.join("_")}(t);return this._generateParticleUpdateCache[e]||(this._generateParticleUpdateCache[e]=this.generateParticleUpdate(t)),this._generateParticleUpdateCache[e]}generateParticleUpdate(t){return o(t)}update(t,e){t.length>this._size&&(e=!0,this._size=Math.max(t.length,1.5*this._size|0),this.staticAttributeBuffer=new a.ViewableBuffer(this._size*this._staticStride*16),this.dynamicAttributeBuffer=new a.ViewableBuffer(this._size*this._dynamicStride*16),this.indexBuffer=n(this._size),this.geometry.indexBuffer.setDataWithSize(this.indexBuffer,this.indexBuffer.byteLength,!0));let i=this.dynamicAttributeBuffer;if(this._dynamicUpload(t,i.float32View,i.uint32View),this._dynamicBuffer.setDataWithSize(this.dynamicAttributeBuffer.float32View,t.length*this._dynamicStride*4,!0),e){let e=this.staticAttributeBuffer;this._staticUpload(t,e.float32View,e.uint32View),this._staticBuffer.setDataWithSize(e.float32View,t.length*this._staticStride*4,!0)}}destroy(){this._staticBuffer.destroy(),this._dynamicBuffer.destroy(),this.geometry.destroy()}}t.s(["ParticleBuffer",()=>h],17291)},6441,50238,85308,t=>{"use strict";var e=t.i(47760),i=t.i(66746),r=t.i(28959),s=t.i(32543),a=t.i(60728),n=t.i(22558),o=t.i(33219),l=t.i(89506),h=t.i(17291),u=t.i(57471),d=t.i(81107),c=t.i(27076),p=t.i(65654),f=t.i(31320),x=t.i(4864),g=t.i(28550),m=t.i(62976),_=t.i(58450);class y extends p.Shader{constructor(){super({glProgram:d.GlProgram.from({vertex:m.default,fragment:g.default}),gpuProgram:c.GpuProgram.from({fragment:{source:_.default,entryPoint:"mainFragment"},vertex:{source:_.default,entryPoint:"mainVertex"}}),resources:{uTexture:f.Texture.WHITE.source,uSampler:new x.TextureStyle({}),uniforms:{uTranslationMatrix:{value:new r.Matrix,type:"mat3x3<f32>"},uColor:{value:new u.Color(0xffffff),type:"vec4<f32>"},uRound:{value:1,type:"f32"},uResolution:{value:[0,0],type:"vec2<f32>"}}}})}}t.s(["ParticleShader",()=>y],50238);class v{constructor(t,e){this.state=n.State.for2d(),this.localUniforms=new s.UniformGroup({uTranslationMatrix:{value:new r.Matrix,type:"mat3x3<f32>"},uColor:{value:new Float32Array(4),type:"vec4<f32>"},uRound:{value:1,type:"f32"},uResolution:{value:[0,0],type:"vec2<f32>"}}),this.renderer=t,this.adaptor=e,this.defaultShader=new y,this.state=n.State.for2d(),this._managedContainers=new o.GCManagedHash({renderer:t,type:"renderable",name:"particleContainer"})}validateRenderable(t){return!1}addRenderable(t,e){this.renderer.renderPipes.batch.break(e),e.add(t)}getBuffers(t){return t._gpuData[this.renderer.uid]||this._initBuffer(t)}_initBuffer(t){return t._gpuData[this.renderer.uid]=new h.ParticleBuffer({size:t.particleChildren.length,properties:t._properties}),this._managedContainers.add(t),t._gpuData[this.renderer.uid]}updateRenderable(t){}execute(t){let e=t.particleChildren;if(0===e.length)return;let i=this.renderer,r=this.getBuffers(t);t.texture||(t.texture=e[0].texture);let s=this.state;r.update(e,t._childrenDirty),t._childrenDirty=!1,s.blendMode=(0,a.getAdjustedBlendModeBlend)(t.blendMode,t.texture._source);let n=this.localUniforms.uniforms,o=n.uTranslationMatrix;t.worldTransform.copyTo(o),o.prepend(i.globalUniforms.globalUniformData.projectionMatrix),n.uResolution=i.globalUniforms.globalUniformData.resolution,n.uRound=i._roundPixels|t._roundPixels,(0,l.color32BitToUniform)(t.groupColorAlpha,n.uColor,0),this.adaptor.execute(this,t)}destroy(){this._managedContainers.destroy(),this.renderer=null,this.defaultShader&&(this.defaultShader.destroy(),this.defaultShader=null)}}t.s(["ParticleContainerPipe",()=>v],85308);class b extends v{constructor(t){super(t,new i.GlParticleContainerAdaptor)}}b.extension={type:[e.ExtensionType.WebGLPipes],name:"particle"},t.s(["GlParticleContainerPipe",()=>b],6441)},7142,t=>{"use strict";var e=t.i(47760),i=t.i(25123),r=t.i(85308);class s extends r.ParticleContainerPipe{constructor(t){super(t,new i.GpuParticleContainerAdaptor)}}s.extension={type:[e.ExtensionType.WebGPUPipes],name:"particle"},t.s(["GpuParticleContainerPipe",()=>s])},20985,55246,t=>{"use strict";var e=t.i(47760),i=t.i(33219),r=t.i(71781),s=t.i(3274);let a=class t extends s.PlaneGeometry{constructor(e={}){e={...t.defaultOptions,...e},super({width:e.width,height:e.height,verticesX:4,verticesY:4}),this.update(e)}update(t){this.width=t.width??this.width,this.height=t.height??this.height,this._originalWidth=t.originalWidth??this._originalWidth,this._originalHeight=t.originalHeight??this._originalHeight,this._leftWidth=t.leftWidth??this._leftWidth,this._rightWidth=t.rightWidth??this._rightWidth,this._topHeight=t.topHeight??this._topHeight,this._bottomHeight=t.bottomHeight??this._bottomHeight,this._anchorX=t.anchor?.x,this._anchorY=t.anchor?.y,this.updateUvs(),this.updatePositions()}updatePositions(){let t=this.positions,{width:e,height:i,_leftWidth:r,_rightWidth:s,_topHeight:a,_bottomHeight:n,_anchorX:o,_anchorY:l}=this,h=r+s,u=a+n,d=Math.min(e>h?1:e/h,i>u?1:i/u),c=o*e,p=l*i;t[0]=t[8]=t[16]=t[24]=-c,t[2]=t[10]=t[18]=t[26]=r*d-c,t[4]=t[12]=t[20]=t[28]=e-s*d-c,t[6]=t[14]=t[22]=t[30]=e-c,t[1]=t[3]=t[5]=t[7]=-p,t[9]=t[11]=t[13]=t[15]=a*d-p,t[17]=t[19]=t[21]=t[23]=i-n*d-p,t[25]=t[27]=t[29]=t[31]=i-p,this.getBuffer("aPosition").update()}updateUvs(){let t=this.uvs;t[0]=t[8]=t[16]=t[24]=0,t[1]=t[3]=t[5]=t[7]=0,t[6]=t[14]=t[22]=t[30]=1,t[25]=t[27]=t[29]=t[31]=1;let e=1/this._originalWidth,i=1/this._originalHeight;t[2]=t[10]=t[18]=t[26]=e*this._leftWidth,t[9]=t[11]=t[13]=t[15]=i*this._topHeight,t[4]=t[12]=t[20]=t[28]=1-e*this._rightWidth,t[17]=t[19]=t[21]=t[23]=1-i*this._bottomHeight,this.getBuffer("aUV").update()}};a.defaultOptions={width:100,height:100,leftWidth:10,topHeight:10,rightWidth:10,bottomHeight:10,originalWidth:100,originalHeight:100},t.s(["NineSliceGeometry",()=>a],55246);class n extends r.BatchableMesh{constructor(){super(),this.geometry=new a}destroy(){this.geometry.destroy()}}class o{constructor(t){this._renderer=t,this._managedSprites=new i.GCManagedHash({renderer:t,type:"renderable",name:"nineSliceSprite"})}addRenderable(t,e){let i=this._getGpuSprite(t);t.didViewUpdate&&this._updateBatchableSprite(t,i),this._renderer.renderPipes.batch.addToBatch(i,e)}updateRenderable(t){let e=this._getGpuSprite(t);t.didViewUpdate&&this._updateBatchableSprite(t,e),e._batcher.updateElement(e)}validateRenderable(t){let e=this._getGpuSprite(t);return!e._batcher.checkAndUpdateTexture(e,t._texture)}_updateBatchableSprite(t,e){e.geometry.update(t),e.setTexture(t._texture)}_getGpuSprite(t){return t._gpuData[this._renderer.uid]||this._initGPUSprite(t)}_initGPUSprite(t){let e=t._gpuData[this._renderer.uid]=new n;return e.renderable=t,e.transform=t.groupTransform,e.texture=t._texture,e.roundPixels=this._renderer._roundPixels|t._roundPixels,this._managedSprites.add(t),t.didViewUpdate||this._updateBatchableSprite(t,e),e}destroy(){this._managedSprites.destroy(),this._renderer=null}}o.extension={type:[e.ExtensionType.WebGLPipes,e.ExtensionType.WebGPUPipes,e.ExtensionType.CanvasPipes],name:"nineSliceSprite"},t.s(["NineSliceSpriteGpuData",()=>n,"NineSliceSpritePipe",()=>o],20985)},1962,47178,31517,85588,42864,94559,68585,t=>{"use strict";let e,i;var r=t.i(47760),s=t.i(60728),a=t.i(22558),n=t.i(18279),o=t.i(33219),l=t.i(89506),h=t.i(71781),u=t.i(17982),d=t.i(28959),c=t.i(81491),p=t.i(35066),f=t.i(55443),x=t.i(65654),g=t.i(32543),m=t.i(31320);let _={name:"tiling-bit",vertex:{header:`
            struct TilingUniforms {
                uMapCoord:mat3x3<f32>,
                uClampFrame:vec4<f32>,
                uClampOffset:vec2<f32>,
                uTextureTransform:mat3x3<f32>,
                uSizeAnchor:vec4<f32>
            };

            @group(2) @binding(0) var<uniform> tilingUniforms: TilingUniforms;
            @group(2) @binding(1) var uTexture: texture_2d<f32>;
            @group(2) @binding(2) var uSampler: sampler;
        `,main:`
            uv = (tilingUniforms.uTextureTransform * vec3(uv, 1.0)).xy;

            position = (position - tilingUniforms.uSizeAnchor.zw) * tilingUniforms.uSizeAnchor.xy;
        `},fragment:{header:`
            struct TilingUniforms {
                uMapCoord:mat3x3<f32>,
                uClampFrame:vec4<f32>,
                uClampOffset:vec2<f32>,
                uTextureTransform:mat3x3<f32>,
                uSizeAnchor:vec4<f32>
            };

            @group(2) @binding(0) var<uniform> tilingUniforms: TilingUniforms;
            @group(2) @binding(1) var uTexture: texture_2d<f32>;
            @group(2) @binding(2) var uSampler: sampler;
        `,main:`

            var coord = vUV + ceil(tilingUniforms.uClampOffset - vUV);
            coord = (tilingUniforms.uMapCoord * vec3(coord, 1.0)).xy;
            var unclamped = coord;
            coord = clamp(coord, tilingUniforms.uClampFrame.xy, tilingUniforms.uClampFrame.zw);

            var bias = 0.;

            if(unclamped.x == coord.x && unclamped.y == coord.y)
            {
                bias = -32.;
            }

            outColor = textureSampleBias(uTexture, uSampler, coord, bias);
        `}},y={name:"tiling-bit",vertex:{header:`
            uniform mat3 uTextureTransform;
            uniform vec4 uSizeAnchor;

        `,main:`
            uv = (uTextureTransform * vec3(aUV, 1.0)).xy;

            position = (position - uSizeAnchor.zw) * uSizeAnchor.xy;
        `},fragment:{header:`
            uniform sampler2D uTexture;
            uniform mat3 uMapCoord;
            uniform vec4 uClampFrame;
            uniform vec2 uClampOffset;
        `,main:`

        vec2 coord = vUV + ceil(uClampOffset - vUV);
        coord = (uMapCoord * vec3(coord, 1.0)).xy;
        vec2 unclamped = coord;
        coord = clamp(coord, uClampFrame.xy, uClampFrame.zw);

        outColor = texture(uTexture, coord, unclamped == coord ? 0.0 : -32.0);// lod-bias very negative to force lod 0

        `}};t.s(["tilingBit",()=>_,"tilingBitGl",()=>y],47178);class v extends x.Shader{constructor(){e??(e=(0,c.compileHighShaderGpuProgram)({name:"tiling-sprite-shader",bits:[p.localUniformBit,_,f.roundPixelsBit]})),i??(i=(0,c.compileHighShaderGlProgram)({name:"tiling-sprite-shader",bits:[p.localUniformBitGl,y,f.roundPixelsBitGl]})),super({glProgram:i,gpuProgram:e,resources:{localUniforms:new g.UniformGroup({uTransformMatrix:{value:new d.Matrix,type:"mat3x3<f32>"},uColor:{value:new Float32Array([1,1,1,1]),type:"vec4<f32>"},uRound:{value:0,type:"f32"}}),tilingUniforms:new g.UniformGroup({uMapCoord:{value:new d.Matrix,type:"mat3x3<f32>"},uClampFrame:{value:new Float32Array([0,0,1,1]),type:"vec4<f32>"},uClampOffset:{value:new Float32Array([0,0]),type:"vec2<f32>"},uTextureTransform:{value:new d.Matrix,type:"mat3x3<f32>"},uSizeAnchor:{value:new Float32Array([100,100,.5,.5]),type:"vec4<f32>"}}),uTexture:m.Texture.EMPTY.source,uSampler:m.Texture.EMPTY.source.style}})}updateUniforms(t,e,i,r,s,a){let n=this.resources.tilingUniforms,o=a.width,l=a.height,h=a.textureMatrix,u=n.uniforms.uTextureTransform;u.set(i.a*o/t,i.b*o/e,i.c*l/t,i.d*l/e,i.tx/t,i.ty/e),u.invert(),n.uniforms.uMapCoord=h.mapCoord,n.uniforms.uClampFrame=h.uClampFrame,n.uniforms.uClampOffset=h.uClampOffset,n.uniforms.uTextureTransform=u,n.uniforms.uSizeAnchor[0]=t,n.uniforms.uSizeAnchor[1]=e,n.uniforms.uSizeAnchor[2]=r,n.uniforms.uSizeAnchor[3]=s,a&&(this.resources.uTexture=a.source,this.resources.uSampler=a.source.style)}}t.s(["TilingSpriteShader",()=>v],31517);var b=u;class T extends b.MeshGeometry{constructor(){super({positions:new Float32Array([0,0,1,0,1,1,0,1]),uvs:new Float32Array([0,0,1,0,1,1,0,1]),indices:new Uint32Array([0,1,2,0,2,3])})}}function S(t,e){let i=t.anchor.x,r=t.anchor.y;e[0]=-i*t.width,e[1]=-r*t.height,e[2]=(1-i)*t.width,e[3]=-r*t.height,e[4]=(1-i)*t.width,e[5]=(1-r)*t.height,e[6]=-i*t.width,e[7]=(1-r)*t.height}function P(t,e,i,r){let s=0,a=t.length/(e||2),n=r.a,o=r.b,l=r.c,h=r.d,u=r.tx,d=r.ty;for(i*=e;s<a;){let r=t[i],a=t[i+1];t[i]=n*r+l*a+u,t[i+1]=o*r+h*a+d,i+=e,s++}}function w(t,e){let i=t.texture,r=i.frame.width,s=i.frame.height,a=0,n=0;t.applyAnchorToTexture&&(a=t.anchor.x,n=t.anchor.y),e[0]=e[6]=-a,e[2]=e[4]=1-a,e[1]=e[3]=-n,e[5]=e[7]=1-n;let o=d.Matrix.shared;o.copyFrom(t._tileTransform.matrix),o.tx/=t.width,o.ty/=t.height,o.invert(),o.scale(t.width/r,t.height/s),P(e,2,0,o)}t.s(["QuadGeometry",()=>T],85588),t.s(["setPositions",()=>S],42864),t.s(["applyMatrix",()=>P],94559),t.s(["setUvs",()=>w],68585);let C=new T;class M{constructor(){this.canBatch=!0,this.geometry=new u.MeshGeometry({indices:C.indices.slice(),positions:C.positions.slice(),uvs:C.uvs.slice()})}destroy(){this.geometry.destroy(),this.shader?.destroy()}}class A{constructor(t){this._state=a.State.default2d,this._renderer=t,this._managedTilingSprites=new o.GCManagedHash({renderer:t,type:"renderable",name:"tilingSprite"})}validateRenderable(t){let e=this._getTilingSpriteData(t),i=e.canBatch;this._updateCanBatch(t);let r=e.canBatch;if(r&&r===i){let{batchableMesh:i}=e;return!i._batcher.checkAndUpdateTexture(i,t.texture)}return i!==r}addRenderable(t,e){let i=this._renderer.renderPipes.batch;this._updateCanBatch(t);let r=this._getTilingSpriteData(t),{geometry:s,canBatch:a}=r;if(a){r.batchableMesh||(r.batchableMesh=new h.BatchableMesh);let a=r.batchableMesh;t.didViewUpdate&&(this._updateBatchableMesh(t),a.geometry=s,a.renderable=t,a.transform=t.groupTransform,a.setTexture(t._texture)),a.roundPixels=this._renderer._roundPixels|t._roundPixels,i.addToBatch(a,e)}else i.break(e),r.shader||(r.shader=new v),this.updateRenderable(t),e.add(t)}execute(t){let{shader:e}=this._getTilingSpriteData(t);e.groups[0]=this._renderer.globalUniforms.bindGroup;let i=e.resources.localUniforms.uniforms;i.uTransformMatrix=t.groupTransform,i.uRound=this._renderer._roundPixels|t._roundPixels,(0,l.color32BitToUniform)(t.groupColorAlpha,i.uColor,0),this._state.blendMode=(0,s.getAdjustedBlendModeBlend)(t.groupBlendMode,t.texture._source),this._renderer.encoder.draw({geometry:C,shader:e,state:this._state})}updateRenderable(t){let e=this._getTilingSpriteData(t),{canBatch:i}=e;if(i){let{batchableMesh:i}=e;t.didViewUpdate&&this._updateBatchableMesh(t),i._batcher.updateElement(i)}else if(t.didViewUpdate){let{shader:i}=e;i.updateUniforms(t.width,t.height,t._tileTransform.matrix,t.anchor.x,t.anchor.y,t.texture)}}_getTilingSpriteData(t){return t._gpuData[this._renderer.uid]||this._initTilingSpriteData(t)}_initTilingSpriteData(t){let e=new M;return e.renderable=t,t._gpuData[this._renderer.uid]=e,this._managedTilingSprites.add(t),e}_updateBatchableMesh(t){let{geometry:e}=this._getTilingSpriteData(t),i=t.texture.source.style;"repeat"!==i.addressMode&&(i.addressMode="repeat",i.update()),w(t,e.uvs),S(t,e.positions)}destroy(){this._managedTilingSprites.destroy(),this._renderer=null}_updateCanBatch(t){let e=this._getTilingSpriteData(t),i=t.texture,r=!0;return this._renderer.type===n.RendererType.WEBGL&&(r=this._renderer.context.supports.nonPowOf2wrapping),e.canBatch=i.textureMatrix.isSimple&&(r||i.source.isPowerOfTwo),e.canBatch}}A.extension={type:[r.ExtensionType.WebGLPipes,r.ExtensionType.WebGPUPipes,r.ExtensionType.CanvasPipes],name:"tilingSprite"},t.s(["TilingSpriteGpuData",()=>M,"TilingSpritePipe",()=>A],1962)},16850,44231,66346,t=>{"use strict";let e,i;var r=t.i(28959),s=t.i(81491),a=t.i(68372),n=t.i(94111),o=t.i(55443),l=t.i(77953),h=t.i(65654),u=t.i(32543);let d={name:"local-uniform-msdf-bit",vertex:{header:`
            struct LocalUniforms {
                uColor:vec4<f32>,
                uTransformMatrix:mat3x3<f32>,
                uDistance: f32,
                uRound:f32,
            }

            @group(2) @binding(0) var<uniform> localUniforms : LocalUniforms;
        `,main:`
            vColor *= localUniforms.uColor;
            modelMatrix *= localUniforms.uTransformMatrix;
        `,end:`
            if(localUniforms.uRound == 1)
            {
                vPosition = vec4(roundPixels(vPosition.xy, globalUniforms.uResolution), vPosition.zw);
            }
        `},fragment:{header:`
            struct LocalUniforms {
                uColor:vec4<f32>,
                uTransformMatrix:mat3x3<f32>,
                uDistance: f32
            }

            @group(2) @binding(0) var<uniform> localUniforms : LocalUniforms;
         `,main:`
            outColor = vec4<f32>(calculateMSDFAlpha(outColor, localUniforms.uColor, localUniforms.uDistance));
        `}},c={name:"local-uniform-msdf-bit",vertex:{header:`
            uniform mat3 uTransformMatrix;
            uniform vec4 uColor;
            uniform float uRound;
        `,main:`
            vColor *= uColor;
            modelMatrix *= uTransformMatrix;
        `,end:`
            if(uRound == 1.)
            {
                gl_Position.xy = roundPixels(gl_Position.xy, uResolution);
            }
        `},fragment:{header:`
            uniform float uDistance;
         `,main:`
            outColor = vec4(calculateMSDFAlpha(outColor, vColor, uDistance));
        `}};t.s(["localUniformMSDFBit",()=>d,"localUniformMSDFBitGl",()=>c],44231);let p={name:"msdf-bit",fragment:{header:`
            fn calculateMSDFAlpha(msdfColor:vec4<f32>, shapeColor:vec4<f32>, distance:f32) -> f32 {

                // MSDF
                var median = msdfColor.r + msdfColor.g + msdfColor.b -
                    min(msdfColor.r, min(msdfColor.g, msdfColor.b)) -
                    max(msdfColor.r, max(msdfColor.g, msdfColor.b));

                // SDF
                median = min(median, msdfColor.a);

                var screenPxDistance = distance * (median - 0.5);
                var alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);
                if (median < 0.01) {
                    alpha = 0.0;
                } else if (median > 0.99) {
                    alpha = 1.0;
                }

                // Gamma correction for coverage-like alpha
                var luma: f32 = dot(shapeColor.rgb, vec3<f32>(0.299, 0.587, 0.114));
                var gamma: f32 = mix(1.0, 1.0 / 2.2, luma);
                var coverage: f32 = pow(shapeColor.a * alpha, gamma);

                return coverage;

            }
        `}},f={name:"msdf-bit",fragment:{header:`
            float calculateMSDFAlpha(vec4 msdfColor, vec4 shapeColor, float distance) {

                // MSDF
                float median = msdfColor.r + msdfColor.g + msdfColor.b -
                                min(msdfColor.r, min(msdfColor.g, msdfColor.b)) -
                                max(msdfColor.r, max(msdfColor.g, msdfColor.b));

                // SDF
                median = min(median, msdfColor.a);

                float screenPxDistance = distance * (median - 0.5);
                float alpha = clamp(screenPxDistance + 0.5, 0.0, 1.0);

                if (median < 0.01) {
                    alpha = 0.0;
                } else if (median > 0.99) {
                    alpha = 1.0;
                }

                // Gamma correction for coverage-like alpha
                float luma = dot(shapeColor.rgb, vec3(0.299, 0.587, 0.114));
                float gamma = mix(1.0, 1.0 / 2.2, luma);
                float coverage = pow(shapeColor.a * alpha, gamma);

                return coverage;
            }
        `}};t.s(["mSDFBit",()=>p,"mSDFBitGl",()=>f],66346);class x extends h.Shader{constructor(t){const h=new u.UniformGroup({uColor:{value:new Float32Array([1,1,1,1]),type:"vec4<f32>"},uTransformMatrix:{value:new r.Matrix,type:"mat3x3<f32>"},uDistance:{value:4,type:"f32"},uRound:{value:0,type:"f32"}});e??(e=(0,s.compileHighShaderGpuProgram)({name:"sdf-shader",bits:[a.colorBit,(0,n.generateTextureBatchBit)(t),d,p,o.roundPixelsBit]})),i??(i=(0,s.compileHighShaderGlProgram)({name:"sdf-shader",bits:[a.colorBitGl,(0,n.generateTextureBatchBitGl)(t),c,f,o.roundPixelsBitGl]})),super({glProgram:i,gpuProgram:e,resources:{localUniforms:h,batchSamplers:(0,l.getBatchSamplersUniformGroup)(t)}})}}t.s(["SdfShader",()=>x],16850)},30192,51516,t=>{"use strict";var e=t.i(92206),i=t.i(47760),r=t.i(33219),s=t.i(94425),a=t.i(78266),n=t.i(16850),o=t.i(3248),l=t.i(87772);class h extends s.Graphics{destroy(){this.context.customShader&&this.context.customShader.destroy(),super.destroy()}}class u{constructor(t){this._renderer=t,this._managedBitmapTexts=new r.GCManagedHash({renderer:t,type:"renderable",priority:-2,name:"bitmapText"})}validateRenderable(t){let e=this._getGpuBitmapText(t);return this._renderer.renderPipes.graphics.validateRenderable(e)}addRenderable(t,e){let i=this._getGpuBitmapText(t);d(t,i),t._didTextUpdate&&(t._didTextUpdate=!1,this._updateContext(t,i)),this._renderer.renderPipes.graphics.addRenderable(i,e),i.context.customShader&&this._updateDistanceField(t)}updateRenderable(t){let e=this._getGpuBitmapText(t);d(t,e),this._renderer.renderPipes.graphics.updateRenderable(e),e.context.customShader&&this._updateDistanceField(t)}_updateContext(t,e){let{context:i}=e,r=o.BitmapFontManager.getFont(t.text,t._style);i.clear(),"none"===r.distanceField.type||i.customShader||(i.customShader=new n.SdfShader(this._renderer.limits.maxBatchableTextures));let s=a.CanvasTextMetrics.graphemeSegmenter(t.text),h=t._style,u=r.baseLineOffset,d=(0,l.getBitmapTextLayout)(s,h,r,!0),c=h.padding,p=d.scale,f=d.width,x=d.height+d.offsetY;h._stroke&&(f+=h._stroke.width/p,x+=h._stroke.width/p),i.translate(-t._anchor._x*f-c,-t._anchor._y*x-c).scale(p,p);let g=r.applyFillAsTint?h._fill.color:0xffffff,m=r.fontMetrics.fontSize,_=r.lineHeight;h.lineHeight&&(m=h.fontSize/p,_=h.lineHeight/p);let y=(_-m)/2;y-r.baseLineOffset<0&&(y=0);for(let t=0;t<d.lines.length;t++){let e=d.lines[t];for(let t=0;t<e.charPositions.length;t++){let s=e.chars[t],a=r.chars[s];if(a?.texture){let r=a.texture;i.texture(r,g||"black",Math.round(e.charPositions[t]+a.xOffset),Math.round(u+a.yOffset+y),r.orig.width,r.orig.height)}}u+=_}}_getGpuBitmapText(t){return t._gpuData[this._renderer.uid]||this.initGpuText(t)}initGpuText(t){let e=new h;return t._gpuData[this._renderer.uid]=e,this._updateContext(t,e),this._managedBitmapTexts.add(t),e}_updateDistanceField(t){let i=this._getGpuBitmapText(t).context,r=t._style.fontFamily,s=e.Cache.get(`${r}-bitmap`),{a,b:n,c:o,d:l}=t.groupTransform,h=(Math.abs(Math.sqrt(a*a+n*n))+Math.abs(Math.sqrt(o*o+l*l)))/2,u=s.baseRenderedFontSize/t._style.fontSize,d=h*s.distanceField.range*(1/u);i.customShader.resources.localUniforms.uniforms.uDistance=d}destroy(){this._managedBitmapTexts.destroy(),this._renderer=null,this._managedBitmapTexts=null}}function d(t,e){e.groupTransform=t.groupTransform,e.groupColorAlpha=t.groupColorAlpha,e.groupColor=t.groupColor,e.groupBlendMode=t.groupBlendMode,e.globalDisplayStatus=t.globalDisplayStatus,e.groupTransform=t.groupTransform,e.localDisplayStatus=t.localDisplayStatus,e.groupAlpha=t.groupAlpha,e._roundPixels=t._roundPixels}u.extension={type:[i.ExtensionType.WebGLPipes,i.ExtensionType.WebGPUPipes,i.ExtensionType.CanvasPipes],name:"bitmapText"},t.s(["BitmapTextGraphics",()=>h,"BitmapTextPipe",()=>u],30192);var c=t.i(40766);class p extends c.BatchableSprite{constructor(){super(...arguments),this.generatingTexture=!1,this.currentKey="--"}destroy(){this.texturePromise=null,this.generatingTexture=!1,this.currentKey="--",super.destroy()}}t.s(["BatchableHTMLText",()=>p],51516)},98113,t=>{"use strict";var e=t.i(81481);function i(t,i){let{texture:r,bounds:s}=t,a=i._style._getFinalPadding();(0,e.updateQuadBounds)(s,i._anchor,r);let n=i._anchor._x*a*2,o=i._anchor._y*a*2;s.minX-=a-n,s.minY-=a-o,s.maxX-=a-n,s.maxY-=a-o}t.s(["updateTextBounds",()=>i])},65747,20335,t=>{"use strict";var e=t.i(47760),i=t.i(31320),r=t.i(33219),s=t.i(98113),a=t.i(51516);class n{constructor(t){this._renderer=t,t.runners.resolutionChange.add(this),this._managedTexts=new r.GCManagedHash({renderer:t,type:"renderable",onUnload:this.onTextUnload.bind(this),name:"htmlText"})}resolutionChange(){for(let t in this._managedTexts.items){let e=this._managedTexts.items[t];e?._autoResolution&&e.onViewUpdate()}}validateRenderable(t){let e=this._getGpuText(t),i=t.styleKey;return e.currentKey!==i}addRenderable(t,e){let i=this._getGpuText(t);if(t._didTextUpdate){let e=t._autoResolution?this._renderer.resolution:t.resolution;(i.currentKey!==t.styleKey||t.resolution!==e)&&this._updateGpuText(t).catch(t=>{console.error(t)}),t._didTextUpdate=!1,(0,s.updateTextBounds)(i,t)}this._renderer.renderPipes.batch.addToBatch(i,e)}updateRenderable(t){let e=this._getGpuText(t);e._batcher.updateElement(e)}async _updateGpuText(t){t._didTextUpdate=!1;let e=this._getGpuText(t);if(e.generatingTexture)return;let i=e.texturePromise;e.texturePromise=null,e.generatingTexture=!0,t._resolution=t._autoResolution?this._renderer.resolution:t.resolution;let r=this._renderer.htmlText.getTexturePromise(t);i&&(r=r.finally(()=>{this._renderer.htmlText.decreaseReferenceCount(e.currentKey),this._renderer.htmlText.returnTexturePromise(i)})),e.texturePromise=r,e.currentKey=t.styleKey,e.texture=await r;let a=t.renderGroup||t.parentRenderGroup;a&&(a.structureDidChange=!0),e.generatingTexture=!1,(0,s.updateTextBounds)(e,t)}_getGpuText(t){return t._gpuData[this._renderer.uid]||this.initGpuText(t)}initGpuText(t){let e=new a.BatchableHTMLText;return e.renderable=t,e.transform=t.groupTransform,e.texture=i.Texture.EMPTY,e.bounds={minX:0,maxX:1,minY:0,maxY:0},e.roundPixels=this._renderer._roundPixels|t._roundPixels,t._resolution=t._autoResolution?this._renderer.resolution:t.resolution,t._gpuData[this._renderer.uid]=e,this._managedTexts.add(t),e}onTextUnload(t){let e=t._gpuData[this._renderer.uid];if(!e)return;let{htmlText:i}=this._renderer;null===i.getReferenceCount(e.currentKey)?i.returnTexturePromise(e.texturePromise):i.decreaseReferenceCount(e.currentKey)}destroy(){this._managedTexts.destroy(),this._renderer=null}}n.extension={type:[e.ExtensionType.WebGLPipes,e.ExtensionType.WebGPUPipes,e.ExtensionType.CanvasPipes],name:"htmlText"},t.s(["HTMLTextPipe",()=>n],65747);var o=t.i(27402);function l(){let{userAgent:t}=o.DOMAdapter.get().getNavigator();return/^((?!chrome|android).)*safari/i.test(t)}t.s(["isSafari",()=>l],20335)},70298,t=>{"use strict";var e=t.i(41163);let i=new(t.i(69553)).Bounds;function r(t,r,s,a){i.minX=0,i.minY=0,i.maxX=t.width/a|0,i.maxY=t.height/a|0;let n=e.TexturePool.getOptimalTexture(i.width,i.height,a,!1);return n.source.uploadMethodId="image",n.source.resource=t,n.source.alphaMode="premultiply-alpha-on-upload",n.frame.width=r/a,n.frame.height=s/a,n.source.emit("update",n.source),n.updateUvs(),n}t.s(["getPo2TextureFromSource",()=>r])},94667,78132,25904,91996,59154,16519,31219,t=>{"use strict";function e(t,e){let i=e.fontFamily,r=[],s={},a=t.match(/font-family:([^;"\s]+)/g);function n(t){s[t]||(r.push(t),s[t]=!0)}if(Array.isArray(i))for(let t=0;t<i.length;t++)n(i[t]);else n(i);for(let t in a&&a.forEach(t=>{n(t.split(":")[1].trim())}),e.tagStyles)n(e.tagStyles[t].fontFamily);return r}t.s(["extractFontFamilies",()=>e],94667);var i=t.i(92206),r=t.i(27402);async function s(t){let e=await r.DOMAdapter.get().fetch(t),i=await e.blob(),s=new FileReader;return await new Promise((t,e)=>{s.onloadend=()=>t(s.result),s.onerror=e,s.readAsDataURL(i)})}async function a(t,e){let i=await s(e);return`@font-face {
        font-family: "${t.fontFamily}";
        font-weight: ${t.fontWeight};
        font-style: ${t.fontStyle};
        src: url('${i}');
    }`}t.s(["loadFontAsBase64",()=>s],78132),t.s(["loadFontCSS",()=>a],25904);let n=new Map;async function o(t){let e=t.filter(t=>i.Cache.has(`${t}-and-url`)).map(t=>{if(!n.has(t)){let{entries:e}=i.Cache.get(`${t}-and-url`),r=[];e.forEach(e=>{let i=e.url,s=e.faces.map(t=>({weight:t.weight,style:t.style}));r.push(...s.map(e=>a({fontWeight:e.weight,fontStyle:e.style,fontFamily:t},i)))}),n.set(t,Promise.all(r).then(t=>t.join("\n")))}return n.get(t)});return(await Promise.all(e)).join("\n")}function l(t,e,i,r,s){let{domElement:a,styleElement:n,svgRoot:o}=s;a.innerHTML=`<style>${e.cssStyle}</style><div style='padding:0;'>${t}</div>`,a.setAttribute("style",`transform: scale(${i});transform-origin: top left; display: inline-block`),n.textContent=r;let{width:l,height:h}=s.image;return o.setAttribute("width",l.toString()),o.setAttribute("height",h.toString()),new XMLSerializer().serializeToString(o)}t.s(["FontStylePromiseCache",()=>n,"getFontCss",()=>o],91996),t.s(["getSVGUrl",()=>l],59154);var h=t.i(81735);function u(t,e){let i=h.CanvasPool.getOptimalCanvasAndContext(t.width,t.height,e),{context:r}=i;return r.clearRect(0,0,t.width,t.height),r.drawImage(t,0,0),i}function d(t,e,i){return new Promise(async r=>{i&&await new Promise(t=>setTimeout(t,100)),t.onload=()=>{r()},t.src=`data:image/svg+xml;charset=utf8,${encodeURIComponent(e)}`,t.crossOrigin="anonymous"})}t.s(["getTemporaryCanvasFromImage",()=>u],16519),t.s(["loadSVGImage",()=>d],31219)},84222,t=>{"use strict";var e=t.i(47760),i=t.i(81735),r=t.i(41163),s=t.i(18279),a=t.i(20335),n=t.i(85830),o=t.i(74179),l=t.i(70298),h=t.i(36566),u=t.i(94667),d=t.i(91996),c=t.i(59154),p=t.i(16519),f=t.i(31219),x=t.i(71467);class g{constructor(t){this._activeTextures={},this._renderer=t,this._createCanvas=t.type===s.RendererType.WEBGPU}getTexture(t){return this.getTexturePromise(t)}getManagedTexture(t){let e=t.styleKey;if(this._activeTextures[e])return this._increaseReferenceCount(e),this._activeTextures[e].promise;let i=this._buildTexturePromise(t).then(t=>(this._activeTextures[e].texture=t,t));return this._activeTextures[e]={texture:null,promise:i,usageCount:1},i}getReferenceCount(t){return this._activeTextures[t]?.usageCount??null}_increaseReferenceCount(t){this._activeTextures[t].usageCount++}decreaseReferenceCount(t){let e=this._activeTextures[t];e&&(e.usageCount--,0===e.usageCount&&(e.texture?this._cleanUp(e.texture):e.promise.then(t=>{e.texture=t,this._cleanUp(e.texture)}).catch(()=>{(0,n.warn)("HTMLTextSystem: Failed to clean texture")}),this._activeTextures[t]=null))}getTexturePromise(t){return this._buildTexturePromise(t)}async _buildTexturePromise(t){let e,{text:r,style:s,resolution:n,textureStyle:g}=t,m=o.BigPool.get(h.HTMLTextRenderData),_=(0,u.extractFontFamilies)(r,s),y=await (0,d.getFontCss)(_),v=(0,x.measureHtmlText)(r,s,y,m),b=Math.ceil(Math.ceil(Math.max(1,v.width)+2*s.padding)*n),T=Math.ceil(Math.ceil(Math.max(1,v.height)+2*s.padding)*n),S=m.image;S.width=(0|b)+2,S.height=(0|T)+2;let P=(0,c.getSVGUrl)(r,s,n,y,m);await (0,f.loadSVGImage)(S,P,(0,a.isSafari)()&&_.length>0),this._createCanvas&&(e=(0,p.getTemporaryCanvasFromImage)(S,n));let w=(0,l.getPo2TextureFromSource)(e?e.canvas:S,S.width-2,S.height-2,n);return g&&(w.source.style=g),this._createCanvas&&(this._renderer.texture.initSource(w.source),i.CanvasPool.returnCanvasAndContext(e)),o.BigPool.return(m),w}returnTexturePromise(t){t.then(t=>{this._cleanUp(t)}).catch(()=>{(0,n.warn)("HTMLTextSystem: Failed to clean texture")})}_cleanUp(t){r.TexturePool.returnTexture(t,!0),t.source.resource=null,t.source.uploadMethodId="unknown"}destroy(){for(let t in this._renderer=null,this._activeTextures)this._activeTextures[t]&&this.returnTexturePromise(this._activeTextures[t].promise);this._activeTextures=null}}g.extension={type:[e.ExtensionType.WebGLSystem,e.ExtensionType.WebGPUSystem,e.ExtensionType.CanvasSystem],name:"htmlText"},t.s(["HTMLTextSystem",()=>g])},17386,48170,t=>{"use strict";var e=t.i(47760),i=t.i(33219),r=t.i(98113),s=t.i(40766);class a extends s.BatchableSprite{}t.s(["BatchableText",()=>a],48170);class n{constructor(t){this._renderer=t,t.runners.resolutionChange.add(this),this._managedTexts=new i.GCManagedHash({renderer:t,type:"renderable",onUnload:this.onTextUnload.bind(this),name:"canvasText"})}resolutionChange(){for(let t in this._managedTexts.items){let e=this._managedTexts.items[t];e?._autoResolution&&e.onViewUpdate()}}validateRenderable(t){let e=this._getGpuText(t),i=t.styleKey;return e.currentKey!==i||t._didTextUpdate}addRenderable(t,e){let i=this._getGpuText(t);if(t._didTextUpdate){let e=t._autoResolution?this._renderer.resolution:t.resolution;(i.currentKey!==t.styleKey||t.resolution!==e)&&this._updateGpuText(t),t._didTextUpdate=!1,(0,r.updateTextBounds)(i,t)}this._renderer.renderPipes.batch.addToBatch(i,e)}updateRenderable(t){let e=this._getGpuText(t);e._batcher.updateElement(e)}_updateGpuText(t){let e=this._getGpuText(t);e.texture&&this._renderer.canvasText.decreaseReferenceCount(e.currentKey),t._resolution=t._autoResolution?this._renderer.resolution:t.resolution,e.texture=this._renderer.canvasText.getManagedTexture(t),e.currentKey=t.styleKey}_getGpuText(t){return t._gpuData[this._renderer.uid]||this.initGpuText(t)}initGpuText(t){let e=new a;return e.currentKey="--",e.renderable=t,e.transform=t.groupTransform,e.bounds={minX:0,maxX:1,minY:0,maxY:0},e.roundPixels=this._renderer._roundPixels|t._roundPixels,t._gpuData[this._renderer.uid]=e,this._managedTexts.add(t),e}onTextUnload(t){let e=t._gpuData[this._renderer.uid];if(!e)return;let{canvasText:i}=this._renderer;i.getReferenceCount(e.currentKey)>0?i.decreaseReferenceCount(e.currentKey):e.texture&&i.returnTexture(e.texture)}destroy(){this._managedTexts.destroy(),this._renderer=null}}n.extension={type:[e.ExtensionType.WebGLPipes,e.ExtensionType.WebGPUPipes,e.ExtensionType.CanvasPipes],name:"text"},t.s(["CanvasTextPipe",()=>n],17386)},73040,t=>{"use strict";var e=t.i(47760),i=t.i(41163),r=t.i(4864),s=t.i(49864),a=t.i(73239),n=t.i(70298),o=t.i(24183);class l{constructor(t){this._activeTextures={},this._renderer=t}getTexture(t,e,i,l){"string"==typeof t&&((0,s.deprecation)("8.0.0","CanvasTextSystem.getTexture: Use object TextOptions instead of separate arguments"),t={text:t,style:i,resolution:e}),t.style instanceof a.TextStyle||(t.style=new a.TextStyle(t.style)),t.textureStyle instanceof r.TextureStyle||(t.textureStyle=new r.TextureStyle(t.textureStyle)),"string"!=typeof t.text&&(t.text=t.text.toString());let{text:h,style:u,textureStyle:d}=t,c=t.resolution??this._renderer.resolution,{frame:p,canvasAndContext:f}=o.CanvasTextGenerator.getCanvasAndContext({text:h,style:u,resolution:c}),x=(0,n.getPo2TextureFromSource)(f.canvas,p.width,p.height,c);if(d&&(x.source.style=d),u.trim&&(p.pad(u.padding),x.frame.copyFrom(p),x.frame.scale(1/c),x.updateUvs()),u.filters){let t=this._applyFilters(x,u.filters);return this.returnTexture(x),o.CanvasTextGenerator.returnCanvasAndContext(f),t}return this._renderer.texture.initSource(x._source),o.CanvasTextGenerator.returnCanvasAndContext(f),x}returnTexture(t){let e=t.source;e.resource=null,e.uploadMethodId="unknown",e.alphaMode="no-premultiply-alpha",i.TexturePool.returnTexture(t,!0)}renderTextToCanvas(){(0,s.deprecation)("8.10.0","CanvasTextSystem.renderTextToCanvas: no longer supported, use CanvasTextSystem.getTexture instead")}getManagedTexture(t){t._resolution=t._autoResolution?this._renderer.resolution:t.resolution;let e=t.styleKey;if(this._activeTextures[e])return this._increaseReferenceCount(e),this._activeTextures[e].texture;let i=this.getTexture({text:t.text,style:t.style,resolution:t._resolution,textureStyle:t.textureStyle});return this._activeTextures[e]={texture:i,usageCount:1},i}decreaseReferenceCount(t){let e=this._activeTextures[t];e.usageCount--,0===e.usageCount&&(this.returnTexture(e.texture),this._activeTextures[t]=null)}getReferenceCount(t){return this._activeTextures[t]?.usageCount??0}_increaseReferenceCount(t){this._activeTextures[t].usageCount++}_applyFilters(t,e){let i=this._renderer.renderTarget.renderTarget,r=this._renderer.filter.generateFilteredTexture({texture:t,filters:e});return this._renderer.renderTarget.bind(i,!1),r}destroy(){for(let t in this._renderer=null,this._activeTextures)this._activeTextures[t]&&this.returnTexture(this._activeTextures[t].texture);this._activeTextures=null}}l.extension={type:[e.ExtensionType.WebGLSystem,e.ExtensionType.WebGPUSystem,e.ExtensionType.CanvasSystem],name:"canvasText"},t.s(["CanvasTextSystem",()=>l])}]);